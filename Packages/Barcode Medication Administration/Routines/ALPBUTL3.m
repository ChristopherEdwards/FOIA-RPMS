ALPBUTL3 ;OIFO-DALLAS MW,SED,KC-BCBU BACKUP REPORT FUNCTIONS AND UTILITIES  ;01/01/03
 ;;2.0;BAR CODE MED ADMIN;**17**;May 2002
START(DAY) ;Get current date
 D NOW^%DTC
 S Y=X
 S STARD=%I(2)
 D DD^%DT
 S MON=$E(Y,1,3)
 S LD=$S(MON="JAN":31,MON="FEB":29,MON="MAR":31,MON="APR":30,MON="MAY":31,MON="JUN":30,MON="JUL":31,MON="AUG":31,MON="SEP":30,MON="OCT":31,MON="NOV":30,MON="DEC":31)
 S LDD=LD+1
 S SP=69,CNT=0
 S SS=STARD+DAY
 I SS>LDD S SS=LDD
 I SS<LDD S LDD=SS
 F J=STARD:0 DO  Q:J=LDD
 .S SP=SP+6,CNT=CNT+1
 .W ?SP,J
 .S J=J+1
 .I J=SS Q
 I CNT'=DAY F J=1:1 DO  Q:CNT=DAY
 .S SP=SP+6,CNT=CNT+1
 .W ?SP,J
 Q
MON(DAY) ;Get the month
 D NOW^%DTC
 S Y=X
 S STARD=%I(2)
 D DD^%DT
 S MON=$E(Y,1,3)
 S LD=$S(MON="JAN":31,MON="FEB":29,MON="MAR":31,MON="APR":30,MON="MAY":31,MON="JUN":30,MON="JUL":31,MON="AUG":31,MON="SEP":30,MON="OCT":31,MON="NOV":30,MON="DEC":31)
 Q
ARRAY(DAY)   ;BUILD ARRAY FOR TO FIND NEXT MONTH
 S MONT("JAN")="FEB"
 S MONT("FEB")="MAR"
 S MONT("MAR")="APR"
 S MONT("APR")="MAY"
 S MONT("MAY")="JUN"
 S MONT("JUN")="JUL"
 S MONT("JUL")="AUG"
 S MONT("AUG")="SEP"
 S MONT("SEP")="OCT"
 S MONT("OCT")="NO"
 S MONT("NOV")="DEC"
 S MONT("DEC")="JAN"
 D NOW^%DTC
 S Y=X
 S STARD=%I(2)
 D DD^%DT
 S MON=$E(Y,1,3)
 S LD=$S(MON="JAN":31,MON="FEB":29,MON="MAR":31,MON="APR":30,MON="MAY":31,MON="JUN":30,MON="JUL":31,MON="AUG":31,MON="SEP":30,MON="OCT":31,MON="NOV":30,MON="DEC":31)
 S LDD=LD+1
 S SP=69,CNT=0
 S SS=STARD+DAY
 I SS>LDD S SS=LDD
 I SS<LDD S LDD=SS
 F J=STARD:0 DO  Q:J=LDD
 .S SP=SP+6,CNT=CNT+1
 .S J=J+1
 .I J=SS Q
 I CNT'=DAY W ?SP+6,$P(MONT(MON),"^",1)
 Q
