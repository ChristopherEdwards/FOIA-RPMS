ACRFESIG ;IHS/OIRM/DSD/THL,AEF - ELECTRONIC SIGNATURE CHECK; [ 11/01/2001   9:44 AM ]
 ;;2.1;ADMIN RESOURCE MGT SYSTEM;;NOV 05, 2001
 ;;ROUTINE CALLED TO ENTER AND CHECK ELECTRONIC SIGNATURES
HASH N ACRI
 K ACR3
 F ACRI=1:1:3 D H Q:$D(ACR3)
 D:'$D(ACR3) S
 K ACR3
 Q
H K ACRQUIT
 D A
 I ACRPER'>0 D  Q
 .W !,"You don't have an "
 .W $S(ACRPER=-1:"ELECTRONIC SIGNATURE",1:"entry in the PERSON file")
 .W ". See your site manager"
 .S ACRQUIT=""
 S DIR(0)="FO^6:20"
 S DIR("A")="Enter your electronic signature"
 S DIR("?")="Enter your official ELECTRONIC SIGNATURE, from 6-20 characters."
 W !
 X ^%ZOSF("EOFF")
 D DIR^ACRFDIC
 X ^%ZOSF("EON")
 G S:$E(X)[U
 D HASH^XUSHSHP
 I X]"",X=$P(^VA(200,ACRPER,20),U,4) D  Q
 .W " VALID SIGNATURE ACCEPTED."
 .S (ACR3,ACRESIG)=""
 E  D
 .W !!,*7,*7,"NOT YOUR VALID ELECTRONIC SIGNATURE."
 .W !,"YOU MAY NOT APPROVE DOCUMENTS WITHOUT YOUR VALID ELECTRONIC SIGNATURE."
 Q
A S ACRPER=$S($D(^VA(200,DUZ,20)):DUZ,1:-1)
 I ACRPER>0,$P(^VA(200,DUZ,20),U,4)]"" S ACRPER=ACRPER
 Q
S S ACRI=3
 S (ACRAPDAS,ACRQUIT)=""
 Q
