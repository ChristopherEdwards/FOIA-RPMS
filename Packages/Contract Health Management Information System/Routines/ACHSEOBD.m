ACHSEOBD ; IHS/ITSC/PMF - SET NODES IN NON-PROCESSED EOBR FILE ;    [ 10/16/2001   8:16 AM ]
 ;;3.1;CONTRACT HEALTH MGMT SYSTEM;;JUN 11, 2001
 ;
 I '$D(^ACHSEOBE(0)) S ^ACHSEOBE(0)="CHS NON-PROCESSED EOBRS^9002065^0^0"
 S ACHSNON=$P($G(^ACHSEOBE(0)),U,3)+1
 S $P(^ACHSEOBE(0),U,3)=ACHSNON
 S ACHSNON1=$P($G(^ACHSEOBE(0)),U,4)+1
 S $P(^ACHSEOBE(0),U,4)=ACHSNON1
 ;
 S ^ACHSEOBE(ACHSNON,0)=ACHSEOBR("A",12)_"^"_ACHSEOBR("A",1)_"^"_ACHSEOBR("A",2)_"^"_ACHSEOBR("A",5)_"^"_ACHSEOBR("A",8)
 ;
 S ^ACHSEOBE(ACHSNON,0)=$G(^ACHSEOBE(ACHSNON,0))_"^"_ACHSEOBR("A",9)_"^"_ACHSEOBR("A",10)_"^"_ACHSEOBR("A",11)_"^"_ACHSEOBR("A",13)_"^"_ACHSEOBR("A",14)_"^"_ACHSEOBR("A",15)
 ;
 S ^ACHSEOBE(ACHSNON,1)=ACHSEOBR("B",8)_"^"_ACHSEOBR("B",9)_"^"_ACHSEOBR("B",10)_"^"_ACHSEOBR("B",11)_"^"_ACHSEOBR("B",12)
 ;
 S ^ACHSEOBE(ACHSNON,1)=$G(^ACHSEOBE(ACHSNON,1))_"^"_ACHSEOBR("C",8)_"^"_ACHSEOBR("C",9)_"^"_ACHSEOBR("C",10)_"^"_ACHSEOBR("C",11)_"^"_ACHSEOBR("C",12)
 ;
 S ^ACHSEOBE(ACHSNON,1)=$G(^ACHSEOBE(ACHSNON,1))_"^"_$G(ACHSEOBR("C",14))_"^"_$G(ACHSEOBR("C",15))_"^"_ACHSEOBR("C",16)_"^"_ACHSEOBR("C",13)
 ;
 S ^ACHSEOBE(ACHSNON,2)=ACHSEOBR("D",8)_"^"_ACHSEOBR("D",9)_"^"_ACHSEOBR("D",10)_"^"_ACHSEOBR("D",11)
 ;
 S ^ACHSEOBE(ACHSNON,2)=$G(^ACHSEOBE(ACHSNON,2))_"^"_ACHSEOBR("E",8)_"^"_ACHSEOBR("E",9)_"^"_ACHSEOBR("E",10)
 ;
 S ^ACHSEOBE(ACHSNON,2)=$G(^ACHSEOBE(ACHSNON,2))_"^"_ACHSEOBR("E",11)_"^"_ACHSEOBR("E",12)_"^"_ACHSEOBR("E",13)_"^"_ACHSEOBR("E",14)_"^"_ACHSEOBR("E",15)_"^"_ACHSEOBR("E",16)
 ;
 I $D(ACHSEOBR("G")) S ^ACHSEOBE(ACHSNON,4)=ACHSEOBR("G",8)_"^"_ACHSEOBR("G",9)_"^"_ACHSEOBR("G",10)
 ;
 I '$D(^ACHSEOBE(ACHSNON,3,0)) S ^ACHSEOBE(ACHSNON,3,0)="CPT PROCEDURES^9002065.037^0^0"
 N ACHS,ACHSBR,ACHSCLM
 S ACHSPO=ACHSEOBR("A",12),(ACHS,ACHSBR,ACHSCLM)=0
 S ACHSCPT=$P($G(^ACHSEOBE(ACHSNON,3,0)),U,3)
F ;
 S ACHSBR=$O(^ACHSEOBR("P",ACHSPO,ACHSBR))
 G F3:ACHSBR=""
F1 ;
 S ACHSEOBR=^ACHSEOBR(ACHSZFPT,ACHSBR)
 I $E(ACHSEOBR,19)'="F" S ACHSBR=ACHSBR+1 G F1
 G F:ACHSCLM'=0&$E(ACHSEOBR,9,18)'=ACHSCLM
 D F2
 S ACHSBR=ACHSBR+1,ACHSCLM=$E(ACHSEOBR,9,18)
 G F1
 ;
F2 ;
 S ACHS=ACHS+1,^TMP("ACHSEOB",$J,"F",ACHS)=ACHSEOBR
 Q
 ;
F3 ;
 S ACHSCPT=ACHSCPT+1
 S ACHS=$O(^TMP("ACHSEOB",$J,"F",ACHS)) G END:'ACHS S ACHSX=^(ACHS)
 ;BEGIN Y2K BLOCK
 ;S F=$E(ACHSX,35,39)_"^"_2_$E(ACHSX,23,28)_"^"_2_$E(ACHSX,29,34)
 ;S F=F_"^"_$E(ACHSX,40,42)_"^"_$E(ACHSX,43,51)_"^"_$E(ACHSX,52,60)_"^"_$E(ACHSX,61,64)_"^"_$E(ACHSX,65,66)_"^"_$E(ACHSX,67,71)
 K ACHSTEMP D REC2^ACHSEOBB(ACHSX,.ACHSTEMP)
 S F=ACHSTEMP("F",10)_"^"_ACHSTEMP("F",8)_"^"_ACHSTEMP("F",9)
 S F=F_"^"_ACHSTEMP("F",11)_"^"_ACHSTEMP("F",12)_"^"_ACHSTEMP("F",13)
 S F=F_"^"_ACHSTEMP("F",14)_"^"_ACHSTEMP("F",15)_"^"_ACHSTEMP("F",16)
 ;END Y2K BLOCK
 S $P(^ACHSEOBE(ACHSNON,3,0),U,3)=ACHSCPT,$P(^(0),U,4)=ACHSCPT
 S ^ACHSEOBE(ACHSNON,3,ACHSCPT,0)=F
 G F3
 ;
END ;
 S DIK="^ACHSEOBE(",DA=ACHSNON
 D IX1^DIK
 K ACHSNON,ACHSCPT,F,ACHSX
 Q
 ;
DFN ;
 ;I don't think that this module is ever used
 ;   4/11/01     pmf
 ;
 S DFN=$O(^AUPNPAT("D",X,DFN))
 I DFN="" S DFN=ACHSEOBR("B",8) Q
 I $D(^AUPNPAT("D",X,DFN,DUZ(2))) Q
 G DFN
 ;
