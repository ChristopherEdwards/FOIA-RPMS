ACGPSTMP ;;IHS/OIRM/DSD/THL,AEF - INPUT TRANSFOR FOR SIG FIELD;;;[ 03/27/2000   2:22 PM ]
 ;;2.0t1;CONTRACT INFORMATION SYSTEM;;FEB 16,2000
EN D EN1
EXIT K APSPZW,APSPSIG,Z1,Z0
 Q
EN1 S APSPZW=$S($D(%APSITE):$P(%APSITE,U,4),$D(^AUSYS(1,"PS",1,0)):$P(^(0),U,4),1:31),APSPZW=APSPZW-5 D:APSPZW
 .S APSPSIG=""
 .F Z0=1:1 Q:$P(X," ",Z0,99)=""  S Z1=$P(X," ",Z0) K:$L(Z1)>APSPZW X W:$L(Z1)>APSPZW !,?5,"MAX OF ",APSPZW," CHARACTERS ALLOWED BETWEEN SPACES." Q:$L(Z1)>APSPZW  D:Z1]""  S APSPSIG=APSPSIG_$E(" ",Z0>1)_Z1
 ..S Y=$O(^DIC(51,"B",Z1,0)) Q:'Y  S Z1=$P(^DIC(51,Y,0),U,2) Q:'$D(^(9))  S Y=$P(X," ",Z0-1),Y=$E(Y,$L(Y)) S:Y>1 Z1=^(9)
 Q
