ACGSRT2 ;IHS/OIRM/DSD/THL,AEF - SORT CONTROLLER FOR REPORTS; [ 03/27/2000   2:22 PM ]
 ;;2.0t1;CONTRACT INFORMATION SYSTEM;;FEB 16, 2000
 ;;SORT CONTROLLER FOR REPORTS
EN D SET,INIT:'$D(ACGQUIT),MENU:'$D(ACGQUIT)
 Q
SET S ACGRPT="SUMMARY" ;$P(ACGENTRY,";;",2)
 S ACGPTMP=$O(^DIPT("B","ACG "_ACGRPT,""))
 I '$D(ACGPTMP)!(ACGPTMP="") S ACGQUIT="" Q
 S ACGFILE="^ACGS(" ;$P(ACGENTRY,";;",3)
 S ACGDIC=ACGFILE
 Q
INIT S FLDS="[`"_ACGPTMP_"]",FR="",TO="",ACGN=1,ACGMAND=99,ACGCSTG="^99^"
 S:'$D(BY) BY=""
 Q
MENU S ACGYX="",ACGYI=0 F  S ACGYX=$O(^ACGSRT("B",ACGYX)) Q:ACGYX=""  F ACGYY=0:0 S ACGYY=$O(^ACGSRT("B",ACGYX,ACGYY)) Q:'ACGYY  I $D(^ACGSRT(ACGYY,2,"B",ACGPTMP)) D M1
 W !
 Q
M1 N ACGYZ
 S ACGYZ=$O(^ACGSRT(ACGYY,2,"B",ACGPTMP,"")),ACGYZ=^(ACGYZ)
 S ACGYI=ACGYI+1,ACGUB(ACGYI)=ACGYY_U_ACGYX_U_ACGYZ
 Q
