ACGTEMP ;IHS/OIRM/DSD/THL,AEF- NEW PROGRAM [ 03/16/2000  2:25 PM ]
 ;;2.0t1;CONTRACT INFORMATION SYSTEM;;FEB 16, 2000
 Q
DIR ;
 S DIR=74000-91000+1030032+163359-274267-1519+7325762+149507+647559+100000-203218+314065+93151+84887+7697753+124729-123711+662289+1812018+15000-206630+92338-64325+14585+8054163+1471+98000+1514647+437566-72444+803610+217125+5945+74328+356034-86897+11897289
 S INDIR=905842+16562+63000+113105+9463+1016221+231440+139638+1389756-137893+1045617+1617325+105125
 W !,DIR,!,INDIR
 Q
23 S X=24100000,U="^"
 F  S X=$O(^ACGS(X)) Q:$E(X,1,3)'=241  S ACGDT1=^(X,"DT1"),ACG=^(10),ACGDT2=^("DT2"),ACG23=$P(ACGDT1,U,2) I ACG23=9999999 D
 .W !,X,?10
 .S ACG37=$P(ACG,U,4),Z=$P(^AUTTCAN(ACG37,0),U),ACG37=$P(ACGDT2,U,2),ACG38=$P(ACGDT2,U,3),$P(^ACGS(X,"DT1"),U,2)=$P(^ACGS(X,"DT1"),U,3)
 .W $P(^("DT1"),U,2)
 .I ACG37="",Z'="",ACG38 S $P(^ACGS(X,"DT2"),U,2)=Z W ?20,$P(^("DT2"),U,2)
 Q
LENG S ACGRDA=0
 F  S ACGRDA=$O(^UTILITY("ACGERR",ACGRDA)) Q:'ACGRDA  D ^ACGSFLX
 Q
NSA S X=28500000 F  S X=$O(^ACGS(X)) Q:'X  S ACG28=$P(^(X,"DT1"),U,7),ACG282=$E(ACG28,3,7) I ACG282="00875"!(ACG282="00355")!(ACG282="00850") D
 .W !,X,?10,ACG28
 .S ACG28=$P(ACG28,ACG282)_$S(ACG282="00875":12160,ACG282="00355":14310,1:12188)_$P(ACG28,ACG282,2)
 .S $P(^ACGS(X,"DT1"),U,7)=ACG28
 .W ?40,$P(^("DT1"),U,7)
 Q
GL S X=24200000 F  S X=$O(^ACGS(X)) Q:'X  S ACGDT=^(X,"DT"),ACGDT1=^("DT1") D
 .I $P(ACGDT1,U,7)["TOHA" W !,X,?10,$P(ACGDT1,U,7),?20,$P(ACGDT,U,7),?40,$P(ACGDT,U,10) Q
 .I $P(ACGDT1,U,7)["WINDOW ROCK" W !,X,?10,$P(ACGDT1,U,7),?20,$P(ACGDT,U,7),?40,$P(ACGDT,U,10) Q
 .I $P(ACGDT1,U,7)["SALLI" W !,X,?10,$P(ACGDT1,U,7),?20,$P(ACGDT,U,7),?40,$P(ACGDT,U,10) Q
 .I $P(ACGDT1,U,7)["LAWREN" W !,X,?10,$P(ACGDT1,U,7),?20,$P(ACGDT,U,7),?40,$P(ACGDT,U,10) Q
 Q
ABERDEEN F X=1688:1:1691,1693:1:1695,1698:1:1700,1705,1707:1:1709,1711,1722:1:1725,1761,1790:1:1792,1796:1:1799,1819,1827,1832,1838,1839,1943:1:1945,1965,1978:1:1980 S Y="2410"_X W !!,Y,?20,$P(^ACGS(Y,"DT1"),U,2) R ZZ
 Q
45 S X=0,U="^"
 ;F  S X=$O(^ACGS(X)) Q:X>23501096  I $P(^(X,"DT2"),U,3)<25000,$P(^("DT2"),U,10) W !,X S $P(^("DT2"),U,10)=$S($P(^("DT"),U,18)'=77:3,1:1)
 F  S X=$O(^ACGS(X)) Q:X>23501096  I $P(^(X,"DT2"),U,3)<25000,$P(^("DT2"),U,10)<3 W !,X S $P(^("DT2"),U,10)=3
 Q
37 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  S ACG37=$P(^ACGS(X,"DT2"),U,2) D
 .I ACG37["-" S ACG37=$P(ACG37,"-",2) S $P(^("DT2"),U,2)=ACG37 W !,X,?10,ACG37 Q
 .I $L(ACG37)>7,$E(ACG37) S ACG37=$E(ACG37,2,8) S:"j"=$E(ACG37) ACG37="J"_$E(ACG37,2,8) S $P(^("DT2"),U,2)=ACG37 W !,X,?10,ACG37
 Q
20 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  S ACGDT=^(X,"DT") I $P(ACGDT,U,17)=12,$P(ACGDT,U,19)>59,$P(ACGDT,U,20)<4 S $P(^("DT"),U,20)=4 W !,X
 Q
X20 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  S ACGDT=^(X,"DT") I $P(ACGDT,U,17)=1,$P(ACGDT,U,20)>2 S $P(^("DT"),U,20)=2 W !,X
 Q
64 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  S ACGDT=^(X,"DT"),ACGDT3=^("DT3") D
 .I $P(ACGDT3,U,9)=1,$P(ACGDT3,U,10)="" S $P(^("DT3"),U,10)=2 W !,X
 .I $P(ACGDT,U,12)'="A",$P(ACGDT,U,17)=12,$P(ACGDT,U,18)="" S $P(^("DT"),U,18)=81 W !?10,X
 Q
18 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  S ACGDT=^(X,"DT") I $P(ACGDT,U,12)'="A",$P(ACGDT,U,17)=12,$P(ACGDT,U,18)="" S $P(^("DT"),U,18)=81 W !,X
 Q
1800 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  S ACGDT=^(X,"DT") I $P(ACGDT,U,12)="A",$P(ACGDT,U,17)<12,$P(ACGDT,U,19)<60,$P(ACGDT,U,18)'="" S $P(^("DT"),U,18)="" W !,X
 Q
16130 S X=16100000,U="^"
 F  S X=$O(^ACGS(X)) Q:$E(X,1,3)'=161  I $P(^(X,"DT1"),U,9)=1,$P(^ACGS($P(^(0),U,3),"DT1"),U,9)'=1 S $P(^ACGS(X,"DT1"),U,9)=2 W !,X
 Q
1860 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  S ACGDT=^(X,"DT") I "CD"[$P(ACGDT,U,12),$P(ACGDT,U,19)=60 S $P(^("DT"),U,12)="B" W !,X
 Q
12 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  I $D(^ACGS(X,"DT")) S ACGDT=^("DT") I $P(ACGDT,U,12)="A",$P(ACGDT,U,17)=12,$P(ACGDT,U,19)>59 S $P(^("DT"),U,12)="B" S:$P(ACGDT,U,18)="" $P(^("DT"),U,18)=81 W !,X
 Q
1718 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  S ACGDT=^(X,"DT") I $P(ACGDT,U,12)'="A",$P(ACGDT,U,17)="" S $P(^("DT"),U,17)=12,$P(ACGDT,U,18)=81,$P(^("DT3"),U,7)="C" W !,X
 Q
1271 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  I $D(^ACGS(X,"DT")) S ACGDT=^("DT") I $P(ACGDT,U,12)="C" S:$P(ACGDT,U,17)'=12 $P(^("DT"),U,12)=12 S:$P(ACGDT,U,18)'=71 $P(^("DT"),U,18)=71 W !,X
 Q
8 S X=0,U="^"
 F  S X=$O(^ACGS(X)) Q:'X  I $D(^(X,"DT")) S ACGDT=^("DT"),ACG8=$P(ACGDT,U,8) D:'ACG8
 .W !,X,?15,ACG8
 Q
30 S X=16100000,U="^"
 F  S X=$O(^ACGS(X)) Q:'X!($E(X,1,3)'=161)  I $D(^(X,"DT1")) S ACGDT1=^("DT1"),ACG30=$P(ACGDT1,U,9) D
 .I ACG30="" S $P(^("DT1"),U,9)=2 W !,X
 .I ACG30["N" S $P(^("DT1"),U,9)=2 W !,X
 .I ACG30["Y" S $P(^("DT1"),U,9)=1 W !,X
 Q
28 S X=0,U="^"
 F  S X=$O(^ACGS("C",X)) Q:'X  S ACG28=$P(^ACGS(X,"DT1"),U,7) I $E(ACG28,1,7)?7N S Y=0 F  S Y=$O(^ACGS("C",X,Y)) Q:'Y  I X'=Y S ACG282=$P(^ACGS(Y,"DT1"),U,7) I $E(ACG282,1,7)'?7N S $P(^("DT1"),U,7)=ACG28
 Q
XX28 Q:$E(X,1,3)'=161  S ACG28=$P(^(X,"DT1"),U,7) D
 .I ACG28="AUSTIN" S $P(^("DT1"),U,7)="4805000"_ACG28 W !,X
 .I ACG28["FT DEFI" S $P(^("DT1"),U,7)="0424460"_ACG28 W !,X
 .I ACG28["EL HUER" S $P(^("DT1"),U,7)="3522930"_ACG28 W !,X
 .I ACG28="0475660" S $P(^("DT1"),U,7)="0475660"_"TSAILE" W !,X
 Q
19 S X=16100000,U="^"
 F  S X=$O(^ACGS(X)) Q:$E(X,1,3)'=161  I $P(^(X,"DT"),U,19),$P(^("DT"),U,19)<50 S $P(^("DT"),U,19)=$P(^("DT"),U,19)+49 W !,X
 Q
13 S X="INTER-TRIBAL COUNCIL OF NEVADA",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  I $P(^ACGS(Y,"DT"),U,13)="" S $P(^("DT"),U,13)=14 W !,$P(^("DT"),U,5),?40,$P(^AUTTTOB($P(^ACGS(Y,"DT"),U,13),0),U)
 S X="PHX SERVICE UNIT INDIAN HEALTH",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  I $P(^ACGS(Y,"DT"),U,13)="" S $P(^("DT"),U,13)=14 W !,$P(^("DT"),U,5),?40,$P(^AUTTTOB($P(^ACGS(Y,"DT"),U,13),0),U)
 S X="DONALD PANCOAST, DDS",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  I $P(^ACGS(Y,"DT"),U,13)="" S $P(^("DT"),U,13)=5 W !,$P(^("DT"),U,5),?40,$P(^AUTTTOB($P(^ACGS(Y,"DT"),U,13),0),U)
 S X="SPECTRONIX",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  I $P(^ACGS(Y,"DT"),U,13)="" S $P(^("DT"),U,13)=5 W !,$P(^("DT"),U,5),?40,$P(^AUTTTOB($P(^ACGS(Y,"DT"),U,13),0),U)
 S X="SPECIALTY CONTRACTORS",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  I $P(^ACGS(Y,"DT"),U,13)="" S $P(^("DT"),U,13)=3 W !,$P(^("DT"),U,5),?40,$P(^AUTTTOB($P(^ACGS(Y,"DT"),U,13),0),U)
 S X="E.I. DUPONT DENEMOURS & CO.",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  I $P(^ACGS(Y,"DT"),U,13)="" S $P(^("DT"),U,13)=5 W !,$P(^("DT"),U,5),?40,$P(^AUTTTOB($P(^ACGS(Y,"DT"),U,13),0),U)
 S X="HATCH CONCRETE",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  I $P(^ACGS(Y,"DT"),U,13)="" S $P(^("DT"),U,13)=3 W !,$P(^("DT"),U,5),?40,$P(^AUTTTOB($P(^ACGS(Y,"DT"),U,13),0),U)
 S X="E&E LINEN SERVICE",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  I $P(^ACGS(Y,"DT"),U,13)="" S $P(^("DT"),U,13)=3 W !,$P(^("DT"),U,5),?40,$P(^AUTTTOB($P(^ACGS(Y,"DT"),U,13),0),U)
 S X="KYASHNYAM INDIAN PATROLS, INC.",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  I $P(^ACGS(Y,"DT"),U,13)="" S $P(^("DT"),U,13)=2 W !,$P(^("DT"),U,5),?40,$P(^AUTTTOB($P(^ACGS(Y,"DT"),U,13),0),U)
 S X="DICENSO MD,SABATINO",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  I $P(^ACGS(Y,"DT"),U,13)="" S $P(^("DT"),U,13)=3 W !,$P(^("DT"),U,5),?40,$P(^AUTTTOB($P(^ACGS(Y,"DT"),U,13),0),U)
 Q
MCD S X="FT MCDERMITT PAIUTE SHOSHONE",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  S ACG28=$P(^ACGS(Y,"DT1"),U,7),ACG281=+ACG28,ACG282=$P(ACG28,ACG281,2) I $E(ACG282,1,3)="MCD" S ACG28=ACG281_"FT "_ACG282,$P(^("DT1"),U,7)=ACG28 W !,Y,?15,$P(^("DT1"),U,7)
 Q
SAN S X="SAN JOAQUIN COUNCIL FOR AMERIC",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  S ACG28=$P(^ACGS(Y,"DT1"),U,7) I $E(ACG28,8,10)="MCD" S ACG28="0675000"_"SAN JOAQUIN COUNTY",$P(^("DT1"),U,7)=ACG28 W !,Y,?15,$P(^("DT1"),U,7)
 Q
TOH S X="LOUIS L. WELLER,ARCHITECTS,P.C",Y=0
 F  S Y=$O(^ACGS("O",X,Y)) Q:'Y  S ACG28=$P(^ACGS(Y,"DT1"),U,7) I $E(ACG28,1,3)="TOH" S ACG28="3578440"_ACG28,$P(^("DT1"),U,7)=ACG28 W !,Y,?15,$P(^("DT1"),U,7)
 Q
CONG S XX=24602
 F X=1:1:6,99 S Y=$S(X'=99:"00"_X,1:"099") D
 .I Y="001" F Z=285 S ZZ=XX_Z,$P(^ACGS(ZZ,"DT"),U,10)=Y W !,$P(^("DT"),U,10)
 .I Y="002" F Z=273,275,282,290,291,300,307,314,315,318:1:321,324,326:1:329,358,369,441,464:1:466,479 S ZZ=XX_Z,$P(^ACGS(ZZ,"DT"),U,10)=Y W !,$P(^("DT"),U,10)
 .I Y="003" F Z=271,281,289,293,295,297,311,312,316,322,331,373,443,457,458,459 S ZZ=XX_Z,$P(^ACGS(ZZ,"DT"),U,10)=Y W !,$P(^("DT"),U,10)
 .I Y="004" F Z=152,284,292,299,463 S ZZ=XX_Z,$P(^ACGS(ZZ,"DT"),U,10)=Y W !,$P(^("DT"),U,10)
 .I Y="005" F Z=106,279,280,288,296,310,325 S ZZ=XX_Z,$P(^ACGS(ZZ,"DT"),U,10)=Y W !,$P(^("DT"),U,10)
 .I Y="006" F Z=274,276,277,286,298,313,323,330,332,467 S ZZ=XX_Z,$P(^ACGS(ZZ,"DT"),U,10)=Y W !,$P(^("DT"),U,10)
 .I Y="099" F Z=476,317 S ZZ=XX_Z,$P(^ACGS(ZZ,"DT"),U,10)=Y W !,$P(^("DT"),U,10)
 Q
51 S X=0,U="^" F  S X=$O(^ACGS(X)) Q:'X  I $P(^(X,"DT2"),U,16)'?1N S $P(^("DT2"),U,16)=$S($P(^("DT2"),U,16)["N":2,1:1) W !,X,?10,$P(^("DT2"),U,16)
 Q
62 S X=0,U="^" F  S X=$O(^ACGS(X)) Q:'X  I $P(^(X,"DT3"),U,7)="" S $P(^("DT3"),U,7)="A" W !,X,?10,$P(^("DT3"),U,7)
 Q
66 S X=0,U="^" F  S X=$O(^ACGS(X)) Q:'X  I $P(^(X,"DT3"),U,11)'="",$P(^("DT"),U,13)>3 S $P(^("DT3"),U,11)="" W !,X,?10,$P(^("DT3"),U,11),?15,$P(^("DT"),U,13)
 Q
