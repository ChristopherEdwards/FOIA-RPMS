BHSPL1 ;IHS/MSC/MGH  - Health Summary for Items associated with Problem list ;01-May-2014 11:13;DU
 ;;1.0;HEALTH SUMMARY COMPONENTS;**8,9**;Mar 17,2006;Build 16
 ;===================================================================
VIDT ;DISPLAY VISIT INSTRUCTIONS SORTED BY DATE IN HEALTH SUMMARY
 N TARGET,X,LINE,NUM
 ;For Visit instructions and treatments, the default is the latest visit
 I $G(GMTSNDM)="" S NUM=99
 E  S NUM=GMTSNDM
 S TARGET=""
 S TARGET=$$TMPGBL
 D CKP^GMTSUP Q:$D(GMTSQIT)
 S X=$$VIDT^BTIUPRVI(DFN,TARGET,NUM)
 S LINE=0
 F  S LINE=$O(@TARGET@(LINE)) Q:LINE=""  D
 .D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG W !,"Visit Instructions",!
 .W @TARGET@(LINE,0),!
 K TARGET
 Q
VIPR ;DISPLAY VISIT INSTRUCTIONS SORTED BY PROBLEM IN HEALTH SUMMARY
 N TARGET,X,LINE,NUM
 ;For Visit instructions and treatments, the default is the latest visit
 I $G(GMTSNDM)="" S NUM=99
 E  S NUM=GMTSNDM
 S TARGET=""
 S TARGET=$$TMPGBL
 D CKP^GMTSUP Q:$D(GMTSQIT)
 S X=$$VIPR^BTIUPRVI(DFN,TARGET,NUM)
 S LINE=0
 F  S LINE=$O(@TARGET@(LINE)) Q:LINE=""  D
 .D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG W !,"Visit Instructions",!
 .W @TARGET@(LINE,0),!
 K TARGET
 Q
VTRDT ;DISPLAY VISIT INSTRUCTIONS SORTED BY DATE IN HEALTH SUMMARY
 N TARGET,X,LINE,NUM
 ;For Visit instructions and treatments, the default is the latest visit
 I $G(GMTSNDM)="" S NUM=99
 E  S NUM=GMTSNDM
 S TARGET=""
 S TARGET=$$TMPGBL
 D CKP^GMTSUP Q:$D(GMTSQIT)
 S X=$$VTRDT^BTIUPRVI(DFN,TARGET,NUM)
 S LINE=0
 F  S LINE=$O(@TARGET@(LINE)) Q:LINE=""  D
 .D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG W !,"Visit Treatments",!
 .W @TARGET@(LINE,0),!
 K TARGET
 Q
VTRPR ;DISPLAY VISIT INSTRUCTIONS SORTED BY PROBLEM IN HEALTH SUMMARY
 N TARGET,X,LINE,NUM
 ;For Visit instructions and treatments, the default is the latest visit
 I $G(GMTSNDM)="" S NUM=99
 E  S NUM=GMTSNDM
 S TARGET=""
 S TARGET=$$TMPGBL
 D CKP^GMTSUP Q:$D(GMTSQIT)
 S X=$$VTRPR^BTIUPRVI(DFN,TARGET,NUM)
 S LINE=0
 F  S LINE=$O(@TARGET@(LINE)) Q:LINE=""  D
 .D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG W !,"Visit Treatments",!
 .W @TARGET@(LINE,0),!
 K TARGET
 Q
REFDT ;DISPLAY VISIT REFERRALS SORTED BY DATE IN HEALTH SUMMARY
 N TARGET,X,LINE,NUM
 ;For Visit referrals, the default is the latest visit
 I $G(GMTSNDM)="" S NUM=99
 E  S NUM=GMTSNDM
 S TARGET=""
 S TARGET=$$TMPGBL
 D CKP^GMTSUP Q:$D(GMTSQIT)
 S X=$$REFDT^BTIUPRVI(DFN,TARGET,NUM)
 S LINE=0
 F  S LINE=$O(@TARGET@(LINE)) Q:LINE=""  D
 .D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG W !,"Visit Referrals",!
 .W @TARGET@(LINE,0),!
 K TARGET
 Q
REFPR ;DISPLAY VISIT REFERRALS SORTED BY PROBLEM IN HEALTH SUMMARY
 N TARGET,X,LINE,NUM
 ;For Visit referrals, the default is the latest visit
 I $G(GMTSNDM)="" S NUM=99
 E  S NUM=GMTSNDM
 S TARGET=""
 S TARGET=$$TMPGBL
 D CKP^GMTSUP Q:$D(GMTSQIT)
 S X=$$REFPR^BTIUPRVI(DFN,TARGET,NUM)
 S LINE=0
 F  S LINE=$O(@TARGET@(LINE)) Q:LINE=""  D
 .D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG W !,"Visit Referrals",!
 .W @TARGET@(LINE,0),!
 K TARGET
 Q
TMPGBL() ;EP
 K ^TMP("BHSPL",$J) Q $NA(^($J))
