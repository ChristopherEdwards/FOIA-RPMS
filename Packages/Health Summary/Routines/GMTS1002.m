GMTS1002 ;IHS/MSC/MGH - GMTS Package Update Utility ;18-Feb-2010 18:06;DU
 ;;2.7;Health Summary;**1002**;Oct 20,10995;Build 4
 ;;IHS/MSC/MGH Patch to upgrad the patch file with accurate information
 ;=================================================================
PRE ;
 N DLM,DDLM,QUIT,I,TEXT,DATA,PKGNM,VERSION,PATCH,PKGIEN,TAG,VSB,XREFREV
 S (XPDDIQ("XPZ1"),XPDDIQ("XPZ2"))=0  ; Suppress the Disable options and Move routine prompts
 S DDLM=";;",DLM="|",QUIT=0
 S TAG="GMTS"
 S QUIT=0
 F I=1:1  D  Q:QUIT
 .S TEXT=$T(@TAG+I) I TEXT="Q" S QUIT=1 Q
 .S DATA=$P(TEXT,DDLM,2) I DATA="" S QUIT=1 Q
 .S PKGNM=$P(DATA,DLM),VERSION=$P(DATA,DLM,2),PATCH=$P(DATA,DLM,3)
 .I '$D(^DIC(9.4,"B",PKGNM)) Q
 .S PKGIEN=$O(^DIC(9.4,"B",PKGNM,0)) Q:PKGIEN=""
 .I '$D(^DIC(9.4,PKGIEN,22,"B",VERSION)) D
 ..K FDA
 ..S FDA(9.49,"+1,"_PKGIEN_",",.01)=VERSION
 ..D UPDATE^DIE(,"FDA")
 ..S FDA(9.49,"+1,"_PKGIEN_",",1)=$G(DT)
 ..S FDA(9.49,"+1,"_PKGIEN_",",2)=$G(DT)
 ..S FDA(9.49,"+1,"_PKGIEN_",",3)=$G(DUZ)
 ..D FILE^DIE(,"FDA")
 .Q:PATCH=""
 .S VSB=$O(^DIC(9.4,PKGIEN,22,"B",VERSION,0))
 .Q:'VSB
 .K FDA
 .; Do not update if the patch is already in the patch history
 .I $D(^DIC(9.4,PKGIEN,22,VSB,"PAH","B",PATCH)) Q
 .S FDA(9.4901,"+1,"_VSB_","_PKGIEN_",",.01)=$G(PATCH)
 .D UPDATE^DIE(,"FDA")
 Q
 ;;;;FORMAT - Package name|Version|Patch|Sequence
GMTS ;
 ;;HEALTH SUMMARY|2.7|1|
 ;;HEALTH SUMMARY|2.7|2|
 ;;HEALTH SUMMARY|2.7|3|
 ;;HEALTH SUMMARY|2.7|4|
 ;;HEALTH SUMMARY|2.7|5|
 ;;HEALTH SUMMARY|2.7|6|
 ;;HEALTH SUMMARY|2.7|7|
 ;;HEALTH SUMMARY|2.7|8|
 ;;HEALTH SUMMARY|2.7|9|
 ;;HEALTH SUMMARY|2.7|10|
 ;;HEALTH SUMMARY|2.7|11|
 ;;HEALTH SUMMARY|2.7|12|
 ;;HEALTH SUMMARY|2.7|13|
 ;;HEALTH SUMMARY|2.7|14
 ;;HEALTH SUMMARY|2.7|15|
 ;;HEALTH SUMMARY|2.7|16|
 ;;HEALTH SUMMARY|2.7|17|
 ;;HEALTH SUMMARY|2.7|18|
 ;;HEALTH SUMMARY|2.7|19|
 ;;HEALTH SUMMARY|2.7|20|
 ;;HEALTH SUMMARY|2.7|21|
 ;;HEALTH SUMMARY|2.7|22|
 ;;HEALTH SUMMARY|2.7|23|
 ;;HEALTH SUMMARY|2.7|24|
 ;;HEALTH SUMMARY|2.7|25|
 ;;HEALTH SUMMARY|2.7|26|
 ;;HEALTH SUMMARY|2.7|27|
 ;;HEALTH SUMMARY|2.7|28|
 ;;HEALTH SUMMARY|2.7|29|
 ;;HEALTH SUMMARY|2.7|30|
 ;;HEALTH SUMMARY|2.7|31|
 ;;HEALTH SUMMARY|2.7|32|
 ;;HEALTH SUMMARY|2.7|33|
 ;;HEALTH SUMMARY|2.7|34|
 ;;HEALTH SUMMARY|2.7|35|
 ;;HEALTH SUMMARY|2.7|37|
 ;;HEALTH SUMMARY|2.7|38|
 ;;HEALTH SUMMARY|2.7|40|
 ;;HEALTH SUMMARY|2.7|42|
 ;;HEALTH SUMMARY|2.7|44|
 ;;HEALTH SUMMARY|2.7|45|
 ;;HEALTH SUMMARY|2.7|46|
 ;;HEALTH SUMMARY|2.7|47|
 ;;HEALTH SUMMARY|2.7|49|
 ;;HEALTH SUMMARY|2.7|50|
 ;;HEALTH SUMMARY|2.7|51|
 ;;HEALTH SUMMARY|2.7|53|
 ;;HEALTH SUMMARY|2.7|54|
 ;;HEALTH SUMMARY|2.7|55|
 ;;HEALTH SUMMARY|2.7|56|
 ;;HEALTH SUMMARY|2.7|57|
 ;;HEALTH SUMMARY|2.7|58|
 ;;HEALTH SUMMARY|2.7|59|
 ;;HEALTH SUMMARY|2.7|61|
 Q
