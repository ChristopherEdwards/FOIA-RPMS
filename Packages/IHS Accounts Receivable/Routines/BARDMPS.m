BARDMPS ;IHS/OIT/SDR - DEBT MANAGEMENT EDIT PARAMETERS
 ;;1.8;IHS ACCOUNTS RECEIVABLE;**22**;OCT 26, 2005;Build 38
 ;New routine 5-12-2011 for Debt Letter Management
 ;
 W !!
 D ^XBFMK
 S DA=DUZ(2)
 S DIE="^BAR(90052.06,DUZ(2),"
 S DIE("NO^")="OUTOK"
 S DR="1701" D ^DIE
 Q:$D(Y)
 S DR="1808Enter the Maximum number of letters to batch print" D ^DIE
 Q:$D(Y)
 S DR="1702DEBT LETTER WRITE OFF AMOUNT" D ^DIE
 Q:$D(Y)
 S DR="1703PRINT FACILITY NPI OR PROVIDER NPI ON LETTER" D ^DIE
 Q:$D(Y)
 S DR="1704PRINT DATE OF BIRTH ON LETTER" D ^DIE
 Q:$D(Y)
 S DR="1809//;1810//" D ^DIE  ;bar*1.*22 SDR
 Q:$D(Y)  ;bar*1.*22 SDR
 ;
L1 ;
 D ^XBFMK
 S DIC="^BAR(90052.03,"
 S DIC("S")="I $P(^(0),U)[""DEBT MANAGEMENT"""
 S DIC("A")="DEBT LETTER 1: "
 S:$P($G(^BAR(90052.06,DUZ(2),DUZ(2),17)),U,5) DIC("B")=$$GET1^DIQ(90052.03,$P(^BAR(90052.06,DUZ(2),DUZ(2),17),U,5),".01","E")
 S DIC(0)="AEQM"
 D ^DIC
 I $D(DUOUT)!(Y<0) G L1
 S BARL=+Y
 D ^XBFMK
 S DIE="^BAR(90052.06,"_DUZ(2)_","
 S DA=DUZ(2)
 S DR="1705////"_BARL_";1706"
 D ^DIE
 Q:$D(Y)
 ;
L2 ;
 D ^XBFMK
 S DIC="^BAR(90052.03,"
 S DIC("S")="I $P(^(0),U)[""DEBT MANAGEMENT"""
 S DIC("A")="DEBT LETTER 2: "
 S:$P($G(^BAR(90052.06,DUZ(2),DUZ(2),17)),U,7) DIC("B")=$$GET1^DIQ(90052.03,$P(^BAR(90052.06,DUZ(2),DUZ(2),17),U,7),".01","E")
 S DIC(0)="AEQM"
 D ^DIC
 I $D(DUOUT)!(Y<0) G L2
 S BARL=+Y
 D ^XBFMK
 S DIE="^BAR(90052.06,"_DUZ(2)_","
 S DA=DUZ(2)
 S DR="1707////"_BARL_";1708"
 D ^DIE
 Q:$D(Y)
L3 ;
 D ^XBFMK
 S DIC="^BAR(90052.03,"
 S DIC("S")="I $P(^(0),U)[""DEBT MANAGEMENT"""
 S DIC("A")="DEBT LETTER 3: "
 S:$P($G(^BAR(90052.06,DUZ(2),DUZ(2),17)),U,9) DIC("B")=$$GET1^DIQ(90052.03,$P(^BAR(90052.06,DUZ(2),DUZ(2),17),U,9),".01","E")
 S DIC(0)="AEQM"
 D ^DIC
 I $D(DUOUT)!(Y<0) G L3
 S BARL=+Y
 D ^XBFMK
 S DIE="^BAR(90052.06,"_DUZ(2)_","
 S DA=DUZ(2)
 S DR="1709////"_BARL_";1710"
 D ^DIE
 Q:$D(Y)
L4 ;
 D ^XBFMK
 S DIC="^BAR(90052.03,"
 S DIC("S")="I $P(^(0),U)[""DEBT MANAGEMENT"""
 S DIC("A")="DEBT LETTER 4: "
 S:$P($G(^BAR(90052.06,DUZ(2),DUZ(2),17)),U,11) DIC("B")=$$GET1^DIQ(90052.03,$P(^BAR(90052.06,DUZ(2),DUZ(2),17),U,11),".01","E")
 S DIC(0)="AEQM"
 D ^DIC
 I $D(DUOUT)!(Y<0) G L4
 S BARL=+Y
 D ^XBFMK
 S DIE="^BAR(90052.06,"_DUZ(2)_","
 S DA=DUZ(2)
 S DR="1711////"_BARL_";1712"
 D ^DIE
 Q
