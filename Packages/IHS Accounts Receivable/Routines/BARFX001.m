BARFX001 ; IHS/SD/LSL - DATA DICTIONARY FIX
 ;;1.8;IHS ACCOUNTS RECEIVABLE;**23**;OCT 26, 2005
 ;P.OTTIS FEB 2013 NEW ROUTINE
 ;(1) ERA DIC FIX: ADD VARIABLE VCLMDATE (DTM DOS 472)
 ;(2) RE-INDEXING XTMP('BARPAS')
 ;(3) ADDING NEW ALLOWANCE CAT (MODIFYING EXISTING NODE)
 ;(4) CHANGE A/R DEBT LETTER FILE ACCESS CODES
 ;(5) FIX DL#4
 Q
AUTO ;CALLED FROM BAR*1.8*23 AUTO-INSTALLED: BAREV823 
 NEW MODE
 S MODE="SILENT"
 D FIX1(MODE)
 D FIX2(MODE)
 D FIX3(MODE)
 D FIX4(MODE)
 D FIX5(MODE)
 QUIT
FIX S MODE="VERBOSE"
 D FIX1(MODE)
 D FIX2(MODE)
 D FIX3(MODE)
 D FIX4(MODE)
 Q
FIX1(MODE) ;
 NEW FND,X
 W !,"FIXING DATA DICTIONARY ^BAREDI(... "
 S FND=0,X=0 F  S X=$O(^BAREDI("1T",X)) Q:X=""  S Y=$G(^BAREDI("1T",X,0)) I Y["5010" D FOUND(X)
 I MODE="VERBOSE" D
 . I FND=2 W !,"DATA DICTIONARY ALREADY FIXED."
 . I 'FND W "DATA DICTIONARY FOR ERA TRANSPORT FILE 5010 NOT FOUND."	
 	I MODE="VERBOSE" W !," DONE."
 Q
FOUND(X) ;
 I $D(^BAREDI("1T",X,70,18,0)) I $D(^BAREDI("1T",X,70,"B","VCLMDATE",18)) S FND=2 Q
 NEW BARNAME,BARDATA
 S FND=1
 S BARNAME=$NA(^BAREDI("1T",X,70,18,0))
 S BARDATA="VCLMDATE^CLMDATE|BAR50PA1"
 S @BARNAME=BARDATA ;11/21/2013
 I MODE="VERBOSE" W !,^BAREDI("1T",X,70,18,0)
 S BARNAME=$NA(^BAREDI("1T",X,70,"B","VCLMDATE",18))
 S BARDATA=""
 S @BARNAME=BARDATA
 I MODE="VERBOSE" W !,^BAREDI("1T",X,70,"B","VCLMDATE",18)
 Q
 ; ^BAREDI("I",1575,"F","EFT196758300410",101,1)
FIX2(MODE) ;
 I MODE="VERBOSE" W !,"RE-INDEXING XTMP('BARPAS')"
 D FIXPAS^BARMPAS5 ;;;D TEST^BARMPAS5
 I MODE="VERBOSE" W !," DONE."
 Q
FIX3(MODE) ;
 ;OLD: ^DD(90051.02,7,0)="Allowance Category^S^MCR:Medicare;MCD:Medicaid;PVT:Private Insurance;OTH:Other;^0;7^Q"
 NEW BARNAME,BARDATA
 I MODE="VERBOSE" W !,"ADDING NEW ALLOWANCE CAT" ;MODIFYING EXISTING NODE
 S BARNAME="^DD(90051.02,7,0)"
 S BARDATA="Allowance Category^S^MCR:Medicare;MCD:Medicaid;PVT:Private Insurance;V:Veterans Medical Benefit;OTH:Other;^0;7^Q"
 S @BARNAME=BARDATA
 I MODE="VERBOSE" W " .... ",BARNAME,"  DONE."
 QUIT
FIX4(MODE) ;CHANGE A/R DEBT LETTER FILE ACCESS CODES
 NEW BARNAME,BARDATA,BARTYP
 S BARSEC("DD")="@"
 S BARSEC("RD")="V"
 S BARSEC("WR")="V"
 S BARSEC("DEL")="@"
 S BARSEC("LAYGO")="V"
 S BARSEC("AUDIT")="@"
 D FILESEC^DDMOD(90053.05,.BARSEC)
 D FILESEC^DDMOD(90053.08,.BARSEC)
 I MODE="VERBOSE" W !,"A/R DEBT LETTER FILES ACCESS CODES CHANGED."
 Q
FIX5(MODE) ;FIX A/R DEBT LETTER #4  Replacing '(Collection clerk)' with BARSTF."
 I MODE="VERBOSE" D FIXDL^BARDL4FX(1) Q
 D FIXDL^BARDL4FX(2)
 Q
 ;---EOR------------
