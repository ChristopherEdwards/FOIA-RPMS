BARRADJ0 ; IHS/SD/POT - TRANSACTION/ADJUSTMENT REPORT - OVERFLOW CODE; 08/20/2008
 ;;1.8;IHS ACCOUNTS RECEIVABLE;**24**;OCT 26, 2005;Build 69
 ;NEW ROUTINE: OVERFLOW CODE FROM BARRADJ
 ;IHS/SD/POT 01/15/14 HEAT124730 ADDING DOS TO TEXT DELIM REPORT 
 ;           
 Q
CLEANUP ;  Cleanup TSR vars
 K ^TMP($J,"BAR-"_BAR("SUBR"))
 K ^TMP($J,"BAR-TSR")
 K ^TMP($J,"BAR-TSRS")
 K ^TMP($J,"BAR-TSRS-INS")
 K ADJTBTOT,ADJTTTOT,ARBTOT,ARTTOT
 K BAR,BARBILL,BARBILLO,BARDASH,BARDLMTD,BARDUZ2,BAREQUAL,BARHLD,BARI,BARP
 K BARPREV,BARTEXT,BARTR,BARY,BILL
 K CNT,DEBUG,DIROUT,DTOUT,DUOUT,FILL,GRANBILL,GRANTRAN,INSURER
 K OFFSET,SORTBTOT,SORTTTOT,SUBS,SUBTOT,SUMMARY,TOTBILLS,TRANBTOT,TRANTTOT,TT
 K VLOCBTOT,VLOCTTOT,ZTDESC,ZTRTN,ZTSAVE
 Q
FOOTER ;
 Q:$G(BAR("F1"))
 I $D(BAR("UN-ALLOCATED")) D
 .S X=""
 .K BAR("DUZ")
 .S X=$O(BAR("UN-ALLOCATED",X))
 .S BAR("DUZ")=$P(BAR("UN-ALLOCATED",X),U,2)
 .S BAR("COL")="W !!?10,""** Unallocated for Collection Batch "",$P($G(^BARCOL(BAR(""DUZ""),BARTR(""B""),0)),U),"" **"",!!"
 .D PAZ^BARRUTL
 .D HDB^BARRADJ2
 .S BAR("UN")=""
 .F  S BAR("UN")=$O(BAR("UN-ALLOCATED",BAR("UN"))) Q:'BAR("UN")  D
 ..W !?15,"ITEM",?30,$J(BAR("UN"),3),?40,$J($FN($P(BAR("UN-ALLOCATED",BAR("UN")),U),",",2),10)
 ..S BAR("UNT")=$G(BAR("UNT"))+$P(BAR("UN-ALLOCATED",BAR("UN")),U)
 .W !?40,"----------"
 .W !?40,$J($FN(BAR("UNT"),",",2),10)
 I $D(BAR("ST")) D
 .;IHS/SD/AR 1.8*19
 .K BAR("ST")
 .W !!!!?16,"*****  R E P O R T  C O M P L E T E  *****"
 .D PAZ^BARRUTL
 Q
