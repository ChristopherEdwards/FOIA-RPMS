APSP6MSG ;IHS/DSD/ENM - OUTPATIENT NEW MODS MSG ; [ 05/30/2001  11:03 AM ]
 ;;6.0;IHS PHARMACY MODIFICATIONS;**3**;01/02/01
MSG ;SETUP AND SEND EMAIL MSG
 W !,"Now I will send a mail message to all holders of the pharmacy 'PSORPH' KEY.",!
 D XMSET
 D TEXT
 D MSG1
 D ZAAP
 Q
XMSET ;SET MAIL VARIABLES
 K XMY S XMSUB="Outpatient Pharmacy Point of Sale Patch",XMDUZ="OUTPATIENT PHARMACY DEVELOPER"
 D RPH
 Q
MSG1 D ^XMD K APSPMSG
 Q
TEXT S APSPMSG(1,0)="To:   Outpatient Pharmacy (OP) Supervisors"
 S APSPMSG(2,0)=" "
 S APSPMSG(3,0)="      OUTPATIENT PHARMACY POINT OF SALE ENHANCEMENT PATCH "
 S APSPMSG(3.1,0)=" "
 S APSPMSG(3.2,0)=" "
 S APSPMSG(4,0)="The purpose of this message is to notify you that Outpatient Patch #3 has "
 S APSPMSG(5,0)="been released and installed in your computer.  Patch #3 includes the new "
 S APSPMSG(6,0)="Pharmacy Point of Sale enhancements and other modifications. This message was"
 S APSPMSG(7,0)="sent to Pharmacy Supervisors only (holding the PSORPH Security Key)."
 S APSPMSG(7.1,0)="Please forward this message to your staff."
 S APSPMSG(8,0)="------------------------------------------------------------------------------ "
 S APSPMSG(9,0)="About The Pharmacy Point of Sale Process......... "
 S APSPMSG(10,0)=" "
 S APSPMSG(11,0)="Enhancements have been added to the RPMS Outpatient Pharmacy Module that will"
 S APSPMSG(12,0)="pass Rx information, for billable patients, to POS software designed by"
 S APSPMSG(13,0)="a company called Full Circle."
 S APSPMSG(14,0)="The Full Circle Point of Sale (FCPOS) software formats the data and sends it to"
 S APSPMSG(15,0)="a clearing house company (usually Envoy) who routes the POS data to individual"
 S APSPMSG(16,0)="insurance companies for billing. Payment information is forwarded back"
 S APSPMSG(16.1,0)="to the Point of Sale software and depending on whether or not payment is"
 S APSPMSG(16.2,0)="promised, an entry is made into the IHS 3rd Party Billing and Accounts"
 S APSPMSG(17,0)="Receivable payment for posting."
 S APSPMSG(18,0)="------------------------------------------------------------------------------"
 S APSPMSG(19,0)="NOTICE!  NOTICE!  NOTICE!  NOTICE!  NOTICE!  NOTICE!  NOTICE!  NOTICE!"
 S APSPMSG(20,0)="                         ALL PHARMACY USERS !!"
 S APSPMSG(21,0)=" "
 S APSPMSG(22,0)="WHEN CONFIGURED, THE OUTPATIENT PHARMACY POINT OF SALES PROCESS IS TRIGGERED"
 S APSPMSG(23,0)="IMMEDIATELY AFTER EACH RX LABEL PRINTS!   RX LABELS MUST PRINT IN ORDER TO"
 S APSPMSG(24,0)="START THE POINT OF SALES PROCESS FOR EACH PRESCRIPTION !!!!"
 S APSPMSG(25,0)="----------------------------------------------------------------------------"
 S APSPMSG(26,0)=" "
 S APSPMSG(27,0)="Several new fields and parameters have been added to the outpatient system"
 S APSPMSG(28,0)="with most of the changes appearing in the 'New Rx' and 'Refill Rx Options. "
 S APSPMSG(29,0)="A description of these new fields and parameters are listed below for you"
 S APSPMSG(30,0)="to review."
 S APSPMSG(31,0)=" "
 S APSPMSG(32,0)="NEW FIELDS (New Rx,Renewal Rx & Refill Rx) "
 S APSPMSG(33,0)="------------------------------------------ "
 S APSPMSG(33.1,0)=" "
 S APSPMSG(34,0)="AWP UNIT OF DRUG - Shows AWP Unit Price of the drug gotten either from the "
 S APSPMSG(35,0)="appropriate field in the Drug File or put in on the fly thru the AWP Option"
 S APSPMSG(35.1,0)="when filling a RX. "
 S APSPMSG(35.2,0)=" "
 S APSPMSG(36,0)="NDC - Shows the default NDC from the Drug File and allows you to enter "
 S APSPMSG(37,0)="the current NDC if necessary triggering an update of the AWP UNIT OF DRUG."
 S APSPMSG(37.1,0)=" "
 S APSPMSG(38,0)="BILL STATUS - This new field is controlled by a new parameter described"
 S APSPMSG(39,0)="below. It will display a default of '1' for AUTO BILL or '0' for MANUAL BILL."
 S APSPMSG(40,0)="If the Bill Status is '1' auto bill causes the FCPOS software to bill"
 S APSPMSG(41,0)="in the background.  If the Bill Status is '0' manual bill causes the POS"
 S APSPMSG(42,0)="software to log the Rx in the FCPOS software but bill it only if the user goes"
 S APSPMSG(43,0)="to the FCPOS software and runs the Manual Bill Option."
 S APSPMSG(43.1,0)=" "
 S APSPMSG(44,0)="PAY STATUS - This field is stuffed from the FCPOS software initially when the"
 S APSPMSG(45,0)="Rx data is first passed to the FCPOS software stating what the POS software"
 S APSPMSG(46,0)="is doing with this RX. This field is in the Prescription File and is"
 S APSPMSG(46.1,0)="not normally seen in the filling of prescriptions."
 S APSPMSG(46.2,0)=" "
 S APSPMSG(47,0)="PAY STATUS (COMPUTED) - This is a computed field that will tell the POS status"
 S APSPMSG(48,0)="of this Rx currently with info from the FCPOS software. This field is"
 S APSPMSG(48.1,0)="in the Prescription File and isn't normally seen in the filling of Rx's."
 S APSPMSG(48.2,0)=" "
 S APSPMSG(49,0)="INSURER INFO - This field is parameter controlled. If it is set to yes,"
 S APSPMSG(50,0)="then the field 'Want to Add/Edit Insurer Information' will appear when"
 S APSPMSG(51,0)="filling a prescription. This field allows adding of additional insurer"
 S APSPMSG(51.1,0)="related information that may be needed to process successfully, a claim"
 S APSPMSG(51.2,0)="for billing purposes of a prescription."
 S APSPMSG(51.3,0)=" "
 S APSPMSG(52,0)="Note:  The above fields all have identical fields in the 'New', 'Renewal'"
 S APSPMSG(53,0)="and 'Refill' Rx Options."
 S APSPMSG(54,0)="----------------------------------------------------------------------------- "
 S APSPMSG(54.1,0)="NOTICE!  NOTICE!  NOTICE!  NOTICE!  NOTICE!  NOTICE!  NOTICE!  NOTICE!"
 S APSPMSG(54.2,0)=" "
 S APSPMSG(55,0)="NEW PARAMETERS - For the Point of Sale package to proerly interact"
 S APSPMSG(55.1,0)="                with the RPMS Pharmacy package, it is extremely"
 S APSPMSG(55.2,0)="                important that you review and set each of the"
 S APSPMSG(55.3,0)="                new IHS Pharmacy Site Parameters accordingly."
 S APSPMSG(55.4,0)=""
 S APSPMSG(55.5,0)="------------------------------------------------------"
 S APSPMSG(56,0)=" "
 S APSPMSG(57,0)="SHOW PATIENT STATUS - This parameter determines if the Rx being filled"
 S APSPMSG(58,0)="will display the 'PATIENT STATUS' (ie. Outpatient or Inpatient)."
 S APSPMSG(59,0)="A default 'Patient Status' will be shown if this parameter is not set."
 S APSPMSG(59.1,0)="Note: the patient status field can be jumped to even if the site"
 S APSPMSG(59.2,0)="parameter is turned 'off'."
 S APSPMSG(59.3,0)=" "
 S APSPMSG(60,0)="SHOW NDC AND AWP - This parameter determines if the Rx being filled will"
 S APSPMSG(61,0)="asks for the National Drug Code (NDC) and the Average Wholesale Price (AWP)"
 S APSPMSG(62,0)="fields. If this field is not set, the information will show a default of"
 S APSPMSG(63,0)="what is currently set for the drug in the Drug File."
 S APSPMSG(63.1,0)="Note: the NDC and AWP fields can be jumped to even if the site parameter"
 S APSPMSG(63.2,0)="is turned 'off'."
 S APSPMSG(63.3,0)=" "
 S APSPMSG(64,0)="SHOW RX BILL & INSURER FIELDS - This parameter determines if the RX"
 S APSPMSG(65,0)="being filled asks for the BILL STATUS field and the INSURER INFO field."
 S APSPMSG(66,0)="If this field is not set, the BILL STATUS will be stuffed with the RX BILL"
 S APSPMSG(67,0)="DEFAULT STATUS and the INSURER INFO field will not have anything in it."
 S APSPMSG(67.1,0)="Note: These fields can be jumped to even if the site parameter is turned off."
 S APSPMSG(67.2,0)=" "
 S APSPMSG(68,0)="RX BILL DEFAULT STATUS - This parameter is used to stuff the BILL STATUS field"
 S APSPMSG(69,0)="in the prescription. The RX BILL STATUS can be changed by the user"
 S APSPMSG(70,0)="at the time the prescription is filled."
 S APSPMSG(70.1,0)=""
 S APSPMSG(71,0)="SIGNATURE LABEL - This parameter is used to determine if a signature label"
 S APSPMSG(72,0)="should print with a fill/refill of a prescription, and if needed, for"
 S APSPMSG(73,0)="which type of insurers it is needed for.  (i.e. Medicaid, Medicare,"
 S APSPMSG(73.1,0)="Private, All Insurers..."
 S APSPMSG(73.2,0)=" "
 S APSPMSG(74,0)="PASS DATA TO POS - This parameter can be used to control the passing of data"
 S APSPMSG(75,0)="from pharmacy to the Full Circle Point of Sale Package. When set to 'NO' -"
 S APSPMSG(76,0)="pharmacy data will NOT pass to the Point of Sale Package. When set to"
 S APSPMSG(76.1,0)="'YES' - pharmacy data will pass to Point of Sale in the manner established"
 S APSPMSG(76.2,0)="in the 'Bill Status' parameter.  (***IMPORTANT NOTE: If Pharmacy Patch"
 S APSPMSG(76.3,0)="3 is installed with this parameter set to 'YES' and the Point of Sale"
 S APSPMSG(76.4,0)="software is installed on the same system without being configured,"
 S APSPMSG(76.5,0)="ERRORS will occur. To avoid such errors, set this parameter to 'NO' until the"
 S APSPMSG(76.6,0)="Point of Sale software has been configured and is ready to receive pharmacy"
 S APSPMSG(76.7,0)="data.)"
 S APSPMSG(76.8,0)=""
 S APSPMSG(77,0)="OTHER ENHANCEMENTS INCLUDED IN THIS PATCH"
 S APSPMSG(78,0)="-----------------------------------------"
 S APSPMSG(79,0)=""
 S APSPMSG(80,0)="- The Outpatient Pharmacy module will automatically reverse and resubmit a POS"
 S APSPMSG(81,0)="claim if the Bill Status parameter equals '1' for AUTO BILL and Rx is edited"
 S APSPMSG(82,0)="deleted or returned to stock."
 S APSPMSG(83,0)=" "
 S APSPMSG(84,0)="- Patient Medication Information (PMI) modifications have been added to the"
 S APSPMSG(85,0)="'Print Line' for new, refills and partial Rx's. The PMI database will soon be"
 S APSPMSG(86,0)="available for distribution."
 S APSPMSG(87,0)=""
 S APSPMSG(88,0)="- Patient allergy information can now be entered while in the 'New Rx' Option."
 S APSPMSG(89,0)="Example: NEW RX FOR TEST,GUY ?: (Y/N/P/R/A/G): Y// A for ALLERGIES/REACTIONS"
 S APSPMSG(89.1,0)=" "
 D ^APSP6M1 ;GET MORE TEXT
 S XMTEXT="APSPMSG(",%H=$H D YX^%DTC
 Q
RPH ;GET HOLDERS OF 'PSORPH' (PHARMACIST)
 ;S XMY("MOORE,EDGAR")="" Q  ;TEMPORARY, REMOVE AFTER TESTING
 S J=0
 F J=0:0 S J=$O(^XUSEC("PSORPH",J)) Q:'J  S APSPNAME=$P($G(^VA(200,J,0)),"^"),XMY(APSPNAME)=""
 ;F J=0:0 S J=$O(^XUSEC("PSOGLORES",J)) Q:'J  S APSPNAME=$P($G(^VA(200,J,0)),"^"),XMY(APSPNAME)="" ;IHS/OKCAO/POC 6/22/98 CHANGE SECURITY KEY
 Q
ZAAP ;KILL ALL VARIABLES ON EXIT
 K APSLNAME,APSP,APSPDG,APSPZ,XMDUZ,J,X,XMSUB,XMTEXT
 Q
