ADEDDTH1 ; IHS/HQT/MJL - IHS-RPMS/MLQ CONTINUATION OF ADEDDTH ;  [ 03/24/1999   9:04 AM ]
 ;;6.0;ADE;;APRIL 1999
 W !!,"LOOKING FOR MATCHING PROVIDER NAME FOR "_ADEPROV(1)
 S DIC=ADEPRVGN,DIC(0)="EMZ",X=ADEPROV(1) D ^DIC
 I Y'<1 S %=1 W !!,"MATCH FOUND, ARE YOU CHANGING "_X_"'S RECORD" D YN^DICN S:%=2 Y=-1
 I Y<1 W !,"NO MATCH FOUND" D NEWONE I 1
 E  S DA=+Y,DIE=DIC
 S DR="1///"_ADEPROV(2)_";2///"_ADEPROV(3)_";3///"_ADEPROV(4) D ^DIE
 Q
NEWONE ;
 W !,"NEW RECORD BEING ADDED . . ."
 S ADEA="0",ADEGN=DIC_"ADEA)",ADELAST=0,ADENE=1
 F ADEIDX=0:0 S ADEA=$O(@ADEGN) Q:ADEA=""  I "1234567890"[ADEA S ADELAST=ADEA,ADENE=ADENE+1
 S DA=ADELAST+1,DIE=DIC,DR=".01///"_X D ^DIE
 S ADEGN=DIC_"0)",$P(@ADEGN,"^",3)=DA,$P(@ADEGN,"^",4)=ADENE
 K ADEA,ADEGN,ADEIDX,ADENE,ADELAST
 Q
