ADEKRP2 ; IHS/HQT/MJL - PRINT COMPILED REPORTS ;  [ 03/24/1999   9:04 AM ]
 ;;6.0;ADE;**20**;APRIL 1999
ASKDEV(ADERTN,ADEDESC) ;EP - DEVICE SELECTION
 ;ADERTN=PROCESSING ROUTINE ENTRY POINT
 ;ADEDESC=DESCRIPTION
 ;Returns ADEIOP and ADEIOPAR
 K %ZIS,ADEIOP,IOP,ZTSK,ADEIOPAR
 W !!,"Enter 'Q' at the DEVICE prompt to queue this report to run in the background."
 S %ZIS="NQ"
 ;S %ZIS="MQ" ;IHS/DIT/ENM 10/29/09
 D ^%ZIS
 Q:POP
 S ADEIOP=ION_";"_IOM_";"_IOSL
 S ADEIOPAR=IOPAR
 Q:'$D(IO("Q"))
 D QUE
 ;IHS/DIT/ENM 10/29/09 START OF MODS
 ;FHL 9/9/98 I '$D(ZTSK) K IOP,ADEIOP G ASKDEV
 ;I '$D(ZTQUEUED) K IOP,ADEIOP G ASKDEV
 W:$D(ZTSK) !,"Report is Queued!"
 Q
 ;D HOME^%ZIS
 ;W !,"REPORT IS QUEUED!"
 ;Q
 ;IHS/DIT/ENM END OF MODS
 ;
QUE ;
 N ADEJ
 S ZTRTN=ADERTN
 S ZTDESC=ADEDESC
 F ADEJ="ADEROPT","ADEIOP","ADEIOPAR","ADEYQ","ADEU" S ZTSAVE(ADEJ)=""
 S ZTIO=""
 I $D(IO("HFSIO")) D
 . S ZTIO=ADEIOP
 D ^%ZTLOAD
 Q
 ;
END ;EP - END PROCESSING
 I $D(ADEU) L -^TMP("ADEP",ADEU)
 K ADEU
 Q
