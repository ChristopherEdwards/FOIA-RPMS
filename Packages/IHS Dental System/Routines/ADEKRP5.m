ADEKRP5 ; IHS/HQT/MJL - PRINT COMPILED REPORTS ;  [ 03/24/1999   9:04 AM ]
 ;;6.0;ADE;**15**;JAN 01, 2004
 ;
CF(ADEPER,ADEYQ) ;EP
 ;BASIC MEASURES REPORTS
 N ADE,ADEM,ADEPC
 ;
 I ADEPER="ANNUAL" D
 . S ADEPER="^TMP(""ADEP"",ADEU,""CF"",ADEYQ)"
 . S ADEPC=2
 E  D
 . S ADEPER="^TMP(""ADEP"",ADEU,""CFQ"",ADEYQ)"
 . S ADEPC=1
 ;
 D CONST
 ;
 ;Report Global is:
 ;ADEREP("ADEP",ADEU,"CF",ADEYQ,"1-PTS")="Ind^Non-Indian^Total" (ANNUAL)
 ;ADEREP("ADEP",ADEU,"CFQ",ADEYQ,"1-PTS")="Ind^Non-Indian^Total" (QR)
 ; ...,".5-3YU")="Indian^Non-Indian^Total"
 ; ...,".55-3YU")="Indian^Non-Indian^Total"
 ; ...,"1.7-NEW USERS")="Indian^Non-Indian^Total"
 ; ...,"1.75-NEW USERS")="Indian^Non-Indian^Total"
 ; ...,"2-VIS")="Indian^Non-Indian^Total"
 ; ...,"5.2-EXAM")
 ; ...,"5.5-PTC")
 ; ...,"3-SVC")
 ; ...,"4-MIN")
 ; ...,"5-BA")="Total # of 9130 codes"
 ; ...,"6-DDAY")="Total Dentist Days"
 ;----- BEGIN IHS
 ; ...,"7-RVU")=Relative Value Unit"
 ;
 ;Get FACILITY USER count
 ;Only for ANNUAL rept
 I ADEPC=2 D
 . S $P(@ADEPER@(".5-3YU"),U,4)="FACILITY USERS PAST "_$S(ADEPC=2:"36",1:"12")_" MONTHS"
 . S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("3YU IND"),"0:125")
 . S $P(@ADEPER@(".5-3YU"),U,1)=$P(ADEM,U,ADEPC+1)
 . S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("3YU NON-IND"),"0:125")
 . S $P(@ADEPER@(".5-3YU"),U,2)=$P(ADEM,U,ADEPC+1)
 . S $P(@ADEPER@(".5-3YU"),U,3)=$P(@ADEPER@(".5-3YU"),U,1)+$P(@ADEPER@(".5-3YU"),U,2)
 ;
 S $P(@ADEPER@(".55-3YU"),U,4)="FACILITY USERS "_$S(ADEPC=2:"PAST 12 MONTHS",1:"THIS QUARTER")
 S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("3YU IND"),"0:125")
 S $P(@ADEPER@(".55-3YU"),U,1)=$P(ADEM,U,ADEPC)
 S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("3YU NON-IND"),"0:125")
 S $P(@ADEPER@(".55-3YU"),U,2)=$P(ADEM,U,ADEPC)
 S $P(@ADEPER@(".55-3YU"),U,3)=$P(@ADEPER@(".55-3YU"),U,1)+$P(@ADEPER@(".55-3YU"),U,2)
 ;
 ;Get DENTAL PATIENT count
 ;ANNUAL Period only
 I ADEPC=2 D
 . S $P(@ADEPER@("1-PTS"),U,4)="DENTAL USERS PAST "_$S(ADEPC=2:"36",1:"12")_" MONTHS"
 . S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("PTS IND"),"0:125")
 . S $P(@ADEPER@("1-PTS"),U,1)=$P(ADEM,U,ADEPC+1)
 . S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("PTS NON-IND"),"0:125")
 . S $P(@ADEPER@("1-PTS"),U,2)=$P(ADEM,U,ADEPC+1)
 . S $P(@ADEPER@("1-PTS"),U,3)=$P(@ADEPER@("1-PTS"),U,1)+$P(@ADEPER@("1-PTS"),U,2)
 ;
 S $P(@ADEPER@("1.5-PTS"),U,4)="DENTAL USERS "_$S(ADEPC=2:"PAST 12 MONTHS",1:"THIS QUARTER")
 S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("PTS IND"),"0:125")
 S $P(@ADEPER@("1.5-PTS"),U,1)=$P(ADEM,U,ADEPC)
 S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("PTS NON-IND"),"0:125")
 S $P(@ADEPER@("1.5-PTS"),U,2)=$P(ADEM,U,ADEPC)
 S $P(@ADEPER@("1.5-PTS"),U,3)=$P(@ADEPER@("1.5-PTS"),U,1)+$P(@ADEPER@("1.5-PTS"),U,2)
 ;NEW DENTAL USERS
 ;ANNUAL Period only
 I ADEPC=2 D
 . S $P(@ADEPER@("1.7-NEW USERS"),U,4)="NEW USERS PAST "_$S(ADEPC=2:"36",1:"12")_" MONTHS"
 . S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("3YR NEW IND"),"0:125")
 . S $P(@ADEPER@("1.7-NEW USERS"),U,1)=$P(ADEM,U,ADEPC+1)
 . S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("3YR NEW NON-IND"),"0:125")
 . S $P(@ADEPER@("1.7-NEW USERS"),U,2)=$P(ADEM,U,ADEPC+1)
 . S $P(@ADEPER@("1.7-NEW USERS"),U,3)=$P(@ADEPER@("1.7-NEW USERS"),U,1)+$P(@ADEPER@("1.7-NEW USERS"),U,2)
 ;
 S $P(@ADEPER@("1.75-NEW USERS"),U,4)="NEW USERS "_$S(ADEPC=2:"PAST 12 MONTHS",1:"THIS QUARTER")
 S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("3YR NEW IND"),"0:125")
 S $P(@ADEPER@("1.75-NEW USERS"),U,1)=$P(ADEM,U,ADEPC)
 S ADEM=$$GETCNT^ADEKRP(ADEYQ,ADE("3YR NEW NON-IND"),"0:125")
 S $P(@ADEPER@("1.75-NEW USERS"),U,2)=$P(ADEM,U,ADEPC)
 S $P(@ADEPER@("1.75-NEW USERS"),U,3)=$P(@ADEPER@("1.75-NEW USERS"),U,1)+$P(@ADEPER@("1.75-NEW USERS"),U,2)
 ;
 ;
 D EXT^ADEKRP51
 Q
 ;
CONST ;EP
 ;Constants
 S ADE("3YU IND")=".1."
 S ADE("3YU NON-IND")=".2."
 S ADE("PTS ALL")=".6."
 S ADE("PTS IND")=".4."
 S ADE("PTS NON-IND")=".5."
 S ADE("VIS IND")=".17."
 S ADE("VIS NON-IND")=".18."
 S ADE("PTC IND")=".15."
 S ADE("PTC NON-IND")=".16."
 S ADE("SVC IND")=".20."
 S ADE("SVC NON-IND")=".21."
 S ADE("MIN IND")=".22."
 S ADE("MIN NON-IND")=".23."
 S ADE("BA")=".19."
 S ADE("DDAY")=".24."
 S ADE("EXAM IND")=".25."
 S ADE("EXAM NON-IND")=".26."
 S ADE("FY NEW IND")=".27."
 S ADE("FY NEW NON-IND")=".28."
 S ADE("3YR NEW IND")=".29."
 S ADE("3YR NEW NON-IND")=".30."
 S ADE("EMERG VIS IND")=".31."
 S ADE("EMERG VIS NON-IND")=".32."
 ;----- BEGIN IHS MODIFICATIONS ADE*6.0*15
 S ADE("RVU IND")=".33."
 S ADE("RVU NON-IND")=".34."
 ;----- END IHS MODIFICATIONS
 Q
