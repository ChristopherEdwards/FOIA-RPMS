BGP1CP3 ; IHS/CMI/LAB - IHS gpra print 02 Jul 2010 9:07 AM ;
 ;;11.1;IHS CLINICAL REPORTING SYSTEM;;JUN 27, 2011;Build 33
 ;
 ;
 ;
AMI4 ;EP
 I $Y>(BGPIOSL-3) D HDR^BGP1CP Q:BGPQUIT  D L1H^BGP1CP
 D WDT^BGP1CPU(BGPVINP)
 Q:BGPQUIT
 I $$TRANS^BGP1CU(BGPVINP) D WTT^BGP1CPU(BGPVINP)
 Q:BGPQUIT
 I $$TRANS^BGP1CU(BGPVINP) D TRANSN Q:BGPQUIT
 D WPPDPOV^BGP1CPU(BGPVSIT)
 Q:BGPQUIT
 D OTHDPOVS^BGP1CPU(BGPVSIT)
 Q:BGPQUIT
 K BGPDATA
 S X=$$COMFORT^BGP1CU(DFN,$P($P(^AUPNVSIT(BGPVSIT,0),U),"."),$P($P(^AUPNVINP(BGPVINP,0),U),"."))
 D WCOMFORT^BGP1CPU(X)
 Q:BGPQUIT
 K BGPDATA
 S BGPC=0
 D SMOKER^BGP1CU2(DFN,$$FMADD^XLFDT($P($P(^AUPNVSIT(BGPVSIT,0),U),"."),-365),$$DSCH^BGP1CU(BGPVINP),.BGPDATA)
 D WSMOKER^BGP1CPU
 Q:BGPQUIT
 K BGPDATA
 D CESS^BGP1CU2(DFN,$P($P(^AUPNVSIT(BGPVSIT,0),U),"."),$$DSCH^BGP1CU(BGPVINP),.BGPDATA)
 D WCESS^BGP1CPU
 Q:BGPQUIT
 K BGPDATA
 D CESSMEDS^BGP1CU2(DFN,$$FMADD^XLFDT($P($P(^AUPNVSIT(BGPVSIT,0),U),"."),-365),$$FMADD^XLFDT($$DSCH^BGP1CU(BGPVINP),30),.BGPDATA)
 D WCESSMED^BGP1CPU
 K BGPDATA
 Q:BGPQUIT
 D ALLALG1^BGP1CU1(DFN,DT,$$DSCH^BGP1CU(BGPVINP),.BGPDATA)
 D WALLALG^BGP1CPU
 Q:BGPQUIT
 K BGPDATA
 D ALLALGA1^BGP1CU1(DFN,DT,.BGPDATA)
 D WALLALGT^BGP1CPU
 K BGPDATA
 D IVUD^BGP1CU1(DFN,$P($P(BGPVSIT0,U),"."),$$DSCH^BGP1CU(BGPVINP),,.BGPDATA)
 D WIVUD^BGP1CPU
 Q
 ;
AMI4W ;EP
 I $Y>(BGPIOSL-3) D HDR^BGP1CP Q:BGPQUIT  D L1H^BGP1CP
 D WDOD^BGP1CPU(DFN)
 D WDT^BGP1CPU(BGPVINP)
 Q:BGPQUIT
 I $$TRANS^BGP1CU(BGPVINP) D WTT^BGP1CPU(BGPVINP)
 Q:BGPQUIT
 I $$TRANS^BGP1CU(BGPVINP) D TRANSN Q:BGPQUIT
 D WPPDPOV^BGP1CPU(BGPVSIT)
 Q:BGPQUIT
 D OTHDPOVS^BGP1CPU(BGPVSIT)
 Q:BGPQUIT
 K BGPDATA
 S X=$$COMFORT^BGP1CU(DFN,$P($P(^AUPNVSIT(BGPVSIT,0),U),"."),$P($P(^AUPNVINP(BGPVINP,0),U),"."))
 D WCOMFORT^BGP1CPU(X)
 Q:BGPQUIT
 K BGPDATA
 S BGPC=0
 D SMOKER^BGP1CU2(DFN,$$FMADD^XLFDT($P($P(^AUPNVSIT(BGPVSIT,0),U),"."),-365),$$DSCH^BGP1CU(BGPVINP),.BGPDATA)
 D WSMOKER^BGP1CPU
 Q:BGPQUIT
 K BGPDATA
 D CESS^BGP1CU2(DFN,$P($P(^AUPNVSIT(BGPVSIT,0),U),"."),$$DSCH^BGP1CU(BGPVINP),.BGPDATA)
 D WCESS^BGP1CPU
 Q:BGPQUIT
 K BGPDATA
 D CESSMEDS^BGP1CU2(DFN,$P($P(^AUPNVSIT(BGPVSIT,0),U),"."),$$DSCH^BGP1CU(BGPVINP),.BGPDATA)
 D WCESSMED^BGP1CPU
 K BGPDATA
 Q:BGPQUIT
 D ALLALG1^BGP1CU1(DFN,DT,$$DSCH^BGP1CU(BGPVINP),.BGPDATA)
 D WALLALG^BGP1CPU
 Q:BGPQUIT
 K BGPDATA
 D ALLALGA1^BGP1CU1(DFN,DT,.BGPDATA)
 D WALLALGT^BGP1CPU
 K BGPDATA
 D IVUD^BGP1CU1(DFN,$P($P(BGPVSIT0,U),"."),$$DSCH^BGP1CU(BGPVINP),,.BGPDATA)
 D WIVUD^BGP1CPU
 Q
 ;
AMI8AW ;EP
 S BGPASTER=0
 I $Y>(BGPIOSL-3) D HDR^BGP1CP Q:BGPQUIT  D L1H^BGP1CP
 I $$TRANSIN^BGP1CU(BGPVINP) D TRANSIN Q:BGPQUIT
 D WDT^BGP1CPU(BGPVINP)
 Q:BGPQUIT
 I $$TRANS^BGP1CU(BGPVINP) D WTT^BGP1CPU(BGPVINP)
 Q:BGPQUIT
 I $$TRANS^BGP1CU(BGPVINP) D TRANSN Q:BGPQUIT
 D WPPDPOV^BGP1CPU(BGPVSIT)
 Q:BGPQUIT
 D OTHDPOVS^BGP1CPU(BGPVSIT)
 Q:BGPQUIT
 S X=$$COMFORT^BGP1CU(DFN,$P($P(^AUPNVSIT(BGPVSIT,0),U),"."),$P($P(^AUPNVINP(BGPVINP,0),U),"."))
 D WCOMFORT^BGP1CPU(X)
 Q:BGPQUIT
 ;FIB MEDS
 S BGPFIB=""
 K BGPDATA
 D TARX^BGP1CU2(DFN,$$FMADD^XLFDT($P($P(^AUPNVSIT(BGPVSIT,0),U),"."),-365),$$FMADD^XLFDT($$DSCH^BGP1CU(BGPVINP),30),0,$$DSCH^BGP1CU(BGPVINP),.BGPDATA)
 K BGPUD
 D IVUD^BGP1CU1(DFN,$P($P(BGPVSIT0,U),"."),$$DSCH^BGP1CU(BGPVINP),$O(^ATXAX("B","BGP CMS THROMBOLYTIC MEDS",0)),.BGPUD,"",$O(^ATXAX("B","BGP THROMBOLYTIC AGENTS CLASS",0)))
 S BGPTAPRO=$$LASTPRCI^BGP1UTL1(DFN,"99.10",$P($P(BGPVSIT0,U),"."),$$DSCH^BGP1CU(BGPVINP)) I BGPTAPRO S BGPTAPRO=$$DATE^BGP1UTL($P(BGPTAPRO,U,3))_"  ["_$P(BGPTAPRO,U,2)_"]  "_$$VAL^XBDIQ1(9000010.08,$P(BGPTAPRO,U,5),.04)
 D WFIB^BGP1CPU2
 Q:BGPQUIT
 K BGPST1
 S BGPST1=$$LASTDX^BGP1UTL1(DFN,"BGP ST ELEVATION DX",$$FMADD^XLFDT($P($P(BGPVSIT0,U),"."),-1),$$DSCH^BGP1CU(BGPVINP))
 I BGPST1 S BGPST1=$$DATE^BGP1UTL($P(BGPST1,U,3))_"  ["_$P(BGPST1,U,2)_"]  "_$$VAL^XBDIQ1(9000010.07,$P(BGPST1,U,5),.04)
 D WST^BGP1CPU2
 ;LBBB ON ECG
 K BGPLBPC,BGPLBDX
 S BGPLBDX=$$LBBBDX^BGP1CU2(DFN,$$FMADD^XLFDT($P($P(BGPVSIT0,U),"."),-1),$$DSCH^BGP1CU(BGPVINP)) I BGPLBDX S BGPLBDX=$$DATE^BGP1UTL($P(BGPLBDX,U,3))_"  ["_$P(BGPLBDX,U,2)_"]  "_$$VAL^XBDIQ1(9000010.07,$P(BGPLBDX,U,5),.04)
 D LBBBPROC^BGP1CU2(DFN,$$FMADD^XLFDT($P($P(BGPVSIT0,U),"."),-1),$$DSCH^BGP1CU(BGPVINP),.BGPLBPC)
 D WLBBB^BGP1CPU2
 Q:BGPQUIT
 S BGPPCI=$$LASTPRCI^BGP1UTL1(DFN,"00.66",$P($P(BGPVSIT0,U),"."),$$DSCH^BGP1CU(BGPVINP)) I BGPPCI S BGPPCI=$$DATE^BGP1UTL($P(BGPPCI,U,3))_"  ["_$P(BGPPCI,U,2)_"]  "_$$VAL^XBDIQ1(9000010.08,$P(BGPPCI,U,5),.04)
 D WPCI^BGP1CPU2
 Q:BGPQUIT
 D ALLALG1^BGP1CU1(DFN,DT,$$DSCH^BGP1CU(BGPVINP),.BGPDATA)
 D WALLALG^BGP1CPU
 Q:BGPQUIT
 K BGPDATA
 D ALLALGA1^BGP1CU1(DFN,DT,.BGPDATA)
 D WALLALGT^BGP1CPU
 K BGPDATA
 D IVUD^BGP1CU1(DFN,$P($P(BGPVSIT0,U),"."),$$DSCH^BGP1CU(BGPVINP),,.BGPDATA)
 D WIVUD^BGP1CPU
 Q
 ;
TRANSIN ;EP
 I $Y>(BGPIOSL-4) D HDR^BGP1CP Q:BGPQUIT  D L1H^BGP1CP
 W !!?3,"NOTE:  Since Admission Type was ","""","Transferred,",""""," review patient's chart"
 W !,"to determine if patient should be excluded if transfer was from another"
 W !,"acute care hospital, including ER from another hospital."
 Q
 ;
TRANSN ;
 I $Y>(BGPIOSL-4) D HDR^BGP1CP Q:BGPQUIT  D L1H^BGP1CP
 W !!?3,"NOTE:  Since Discharge Type was ","""","Transferred,",""""," review patient's chart"
 W !,"to determine if patient should be excluded if transferred to another"
 W !,"acute care hospital or federal hospital."
 Q
 ;
