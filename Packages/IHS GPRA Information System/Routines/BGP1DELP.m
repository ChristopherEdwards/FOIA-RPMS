BGP1DELP ; IHS/CMI/LAB - IHS HEDIS print ;
 ;;11.1;IHS CLINICAL REPORTING SYSTEM;;JUN 27, 2011;Build 33
 ;
 ;
PRINT ;
 K ^TMP($J)
 S BGPIOSL=$S($G(BGPGUI):55,1:IOSL)
 I BGPROT="D" G DEL
 S BGPPTYPE="P"
 D ^BGP1ELH
 S BGPGPG=0
 S BGPQUIT=""
 D PRINT1
 K ^TMP($J)
 I BGPROT="P" K ^XTMP("BGP1D",BGPJ,BGPH),^TMP($J) Q
 ;
DEL ;create delimited output file
 D ^%ZISC ;close printer device
 K ^TMP($J)
 S BGPPTYPE="D"
 D ^BGP1ELL ;create ^tmp of delimited report
 K ^XTMP("BGP1D",BGPJ,BGPH)
 K ^TMP($J)
 Q
WP ;
 K ^UTILITY($J,"W")
 S BGPZ=0,BGPLCNT=0
 S DIWL=1,DIWR=80,DIWF="" F  S BGPZ=$O(^BGPELIB(BGPIC,BGPNODE,BGPY,1,BGPZ)) Q:BGPZ'=+BGPZ  D
 .S BGPLCNT=BGPLCNT+1
 .S X=^BGPELIB(BGPIC,BGPNODE,BGPY,1,BGPZ,0) S:BGPLCNT=1 X=" - "_X D ^DIWP
 .Q
WPS ;
 S Z=0 F  S Z=$O(^UTILITY($J,"W",DIWL,Z)) Q:Z'=+Z  D
 .I $Y>(BGPIOSL-3) D HEADER^BGP1DPH Q:BGPQUIT
 .;D W^BGP1DP(^UTILITY($J,"W",DIWL,Z,0),0,1,BGPPTYPE)
 .W !,^UTILITY($J,"W",DIWL,Z,0)
 K DIWL,DIWR,DIWF,Z
 K ^UTILITY($J,"W"),X
 Q
 ;
PRINT1 ;EP
 S BGPIC=0 F  S BGPIC=$O(BGPIND(BGPIC)) Q:BGPIC=""!(BGPQUIT)  D
 .D HEADER^BGP1DPH ;header for all measures
 .I $Y>(BGPIOSL-3) D HEADER^BGP1DPH Q:BGPQUIT
 .W !,$P(^BGPELIB(BGPIC,0),U,3),!
 .I $Y>(BGPIOSL-3) D HEADER^BGP1DPH Q:BGPQUIT
 .W !,"Denominator(s):"
 .S BGPNODE=61
 .S BGPX=0 F  S BGPX=$O(^BGPELIB(BGPIC,61,"B",BGPX)) Q:BGPX'=+BGPX!(BGPQUIT)  D
 ..S BGPY=0 F  S BGPY=$O(^BGPELIB(BGPIC,61,"B",BGPX,BGPY)) Q:BGPY'=+BGPY!(BGPQUIT)  D
 ...;S BGPZ=0 F  S BGPZ=$O(^BGPELIB(BGPIC,61,BGPY,1,BGPZ)) Q:BGPZ'=+BGPZ!(BGPQUIT)  D
 ...;I $Y>(BGPIOSL-3) D HEADER^BGP1DPH Q:BGPQUIT
 ...D WP ;W !,^BGPELIB(BGPIC,61,BGPY,1,BGPZ,0)
 ...Q
 ...;W !
 ...Q
 ..Q
 .I $Y>(BGPIOSL-3) D HEADER^BGP1DPH Q:BGPQUIT
 .W !!,"Numerator(s):"
 .S BGPNODE=62
 .S BGPX=0 F  S BGPX=$O(^BGPELIB(BGPIC,62,"B",BGPX)) Q:BGPX'=+BGPX!(BGPQUIT)  D
 ..S BGPY=0 F  S BGPY=$O(^BGPELIB(BGPIC,62,"B",BGPX,BGPY)) Q:BGPY'=+BGPY!(BGPQUIT)  D
 ...;S BGPZ=0 F  S BGPZ=$O(^BGPELIB(BGPIC,62,BGPY,1,BGPZ)) Q:BGPZ'=+BGPZ!(BGPQUIT)  D
 ...;.I $Y>(BGPIOSL-3) D HEADER^BGP1DPH Q:BGPQUIT
 ...;.W !,^BGPELIB(BGPIC,62,BGPY,1,BGPZ,0)
 ...D WP  ;.Q
 ...Q
 ..Q
 .I $O(^BGPELIB(BGPIC,11,0)) W !!,"Logic" S BGPX=0 F  S BGPX=$O(^BGPELIB(BGPIC,11,BGPX)) Q:BGPX'=+BGPX  D
 ..I $Y>(BGPIOSL-3) D HEADER^BGP1DPH Q:BGPQUIT
 ..W !,^BGPELIB(BGPIC,11,BGPX,0)
 .I $O(^BGPELIB(BGPIC,51,0)) W !!,"Performance Measure Description" S BGPX=0 F  S BGPX=$O(^BGPELIB(BGPIC,51,BGPX)) Q:BGPX'=+BGPX  D
 ..I $Y>(BGPIOSL-3) D HEADER^BGP1DPH Q:BGPQUIT
 ..W !,^BGPELIB(BGPIC,51,BGPX,0)
 .I $O(^BGPELIB(BGPIC,52,0)) W !!,"Past Performance and/or Target" S BGPX=0 F  S BGPX=$O(^BGPELIB(BGPIC,52,BGPX)) Q:BGPX'=+BGPX  D
 ..I $Y>(BGPIOSL-3) D HEADER^BGP1DPH Q:BGPQUIT
 ..W !,^BGPELIB(BGPIC,52,BGPX,0)
 .X ^BGPELIB(BGPIC,3)
 ;
 D ^BGP1ELS
 D EXIT
 Q
EXIT ;
 I $E(IOST)="C",IO=IO(0),'$D(ZTQUEUED) W ! S DIR(0)="EO",DIR("A")="End of report.  Press ENTER" D ^DIR K DIR S:$D(DUOUT) DIRUT=1
 Q
C(X,X2,X3) ;
 D COMMA^%DTC
 Q X
