BGP1DP1F ; IHS/CMI/LAB - print ind 1 21 Mar 2010 12:55 PM 01 Jul 2010 11:40 AM ;
 ;;11.1;IHS CLINICAL REPORTING SYSTEM;;JUN 27, 2011;Build 33
ONN4 ;EP
 I $G(BGPAREAA),$G(BGPEXCEL) D
 .Q:$P($G(^BGPINDBC(BGPPC,21)),U,9)=""
 .;set each numerator and percent,then set BGPONN4
 .NEW X S X=0 F  S X=$O(BGPSUL(X)) Q:X'=+X  D
 ..S $P(BGPEXCT(X,1),U,1)=$P($G(^BGPGPDCB(X,N)),U,P),$P(BGPEXCT(X,1),U,3)=$S($P(BGPEXCT(X,1),U,2):(($P(BGPEXCT(X,1),U,1)/$P(BGPEXCT(X,1),U,2))*100),1:"")
 ..S $P(BGPEXCT(X,2),U,1)=$P($G(^BGPGPDPB(X,N)),U,P),$P(BGPEXCT(X,2),U,3)=$S($P(BGPEXCT(X,2),U,2):(($P(BGPEXCT(X,2),U,1)/$P(BGPEXCT(X,2),U,2))*100),1:"")
 ..S $P(BGPEXCT(X,3),U,1)=$P($G(^BGPGPDBB(X,N)),U,P),$P(BGPEXCT(X,3),U,3)=$S($P(BGPEXCT(X,3),U,2):(($P(BGPEXCT(X,3),U,1)/$P(BGPEXCT(X,3),U,2))*100),1:"")
 .S X=0 F  S X=$O(BGPEXCT(X)) Q:X'=+X  D
 ..S A=$P(BGPEXCT(X,1),U,1),B=$P(BGPEXCT(X,1),U,2),C=$P(BGPEXCT(X,1),U,3)
 ..S D=$P(BGPEXCT(X,2),U,1),E=$P(BGPEXCT(X,2),U,2),F=$P(BGPEXCT(X,2),U,3)
 ..S G=$P(BGPEXCT(X,3),U,1),H=$P(BGPEXCT(X,3),U,2),I=$P(BGPEXCT(X,3),U,3)
 ..I $P($P(^BGPINDBC(BGPPC,0),U,4),".")="023" S Y=$P(^BGPINDBC(BGPPC,21),U,9),$P(BGPONN4(X),U,Y)=$S(B:B,1:0),$P(BGPONN4(X),U,(Y+3))=$S(E:E,1:0),$P(BGPONN4(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P($P(^BGPINDBC(BGPPC,0),U,4),".",1,2)="014.A" S Y=$P(^BGPINDBC(BGPPC,21),U,9),$P(BGPONN4(X),U,Y)=$S(B:B,1:0),$P(BGPONN4(X),U,(Y+3))=$S(E:E,1:0),$P(BGPONN4(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P(^BGPINDBC(BGPPC,0),U,4)="016.A.1" S Y=$P(^BGPINDBC(BGPPC,21),U,9),$P(BGPONN4(X),U,Y)=$S(B:B,1:0),$P(BGPONN4(X),U,(Y+3))=$S(E:E,1:0),$P(BGPONN4(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P($G(^BGPINDBC(BGPPC,19)),U,13) S Y=$P(^BGPINDBC(BGPPC,21),U,1),$P(BGPONN4(X),U,Y)=$S(B:B,1:0),$P(BGPONN4(X),U,(Y+3))=$S(E:E,1:0),$P(BGPONN4(X),U,(Y+6))=$S(H:H,1:0) Q
 ..S Y=$P(^BGPINDBC(BGPPC,21),U,9)
 ..S $P(BGPONN4(X),U,$P(^BGPINDBC(BGPPC,21),U,9))=$S(A:A,1:0),$P(BGPONN4(X),U,(Y+1))=$S(B:B,1:0),$P(BGPONN4(X),U,(Y+2))=$$SL(C)
 ..S $P(BGPONN4(X),U,(Y+3))=$S(D:D,1:0),$P(BGPONN4(X),U,(Y+4))=$S(E:E,1:0),$P(BGPONN4(X),U,(Y+5))=$$SL(F),$P(BGPONN4(X),U,(Y+6))=$S(G:G,1:0),$P(BGPONN4(X),U,(Y+7))=$S(H:H,1:0),$P(BGPONN4(X),U,(Y+8))=$$SL(I)
 Q  ;NO ONM5 FOR V11.0
ONN5 ;
 I $G(BGPAREAA),$G(BGPEXCEL) D
 .Q:$P($G(^BGPINDBC(BGPPC,21)),U,10)=""
 .;set each numerator and percent,then set BGPONN5
 .NEW X S X=0 F  S X=$O(BGPSUL(X)) Q:X'=+X  D
 ..S $P(BGPEXCT(X,1),U,1)=$P($G(^BGPGPDCB(X,N)),U,P),$P(BGPEXCT(X,1),U,3)=$S($P(BGPEXCT(X,1),U,2):(($P(BGPEXCT(X,1),U,1)/$P(BGPEXCT(X,1),U,2))*100),1:"")
 ..S $P(BGPEXCT(X,2),U,1)=$P($G(^BGPGPDPB(X,N)),U,P),$P(BGPEXCT(X,2),U,3)=$S($P(BGPEXCT(X,2),U,2):(($P(BGPEXCT(X,2),U,1)/$P(BGPEXCT(X,2),U,2))*100),1:"")
 ..S $P(BGPEXCT(X,3),U,1)=$P($G(^BGPGPDBB(X,N)),U,P),$P(BGPEXCT(X,3),U,3)=$S($P(BGPEXCT(X,3),U,2):(($P(BGPEXCT(X,3),U,1)/$P(BGPEXCT(X,3),U,2))*100),1:"")
 .S X=0 F  S X=$O(BGPEXCT(X)) Q:X'=+X  D
 ..S A=$P(BGPEXCT(X,1),U,1),B=$P(BGPEXCT(X,1),U,2),C=$P(BGPEXCT(X,1),U,3)
 ..S D=$P(BGPEXCT(X,2),U,1),E=$P(BGPEXCT(X,2),U,2),F=$P(BGPEXCT(X,2),U,3)
 ..S G=$P(BGPEXCT(X,3),U,1),H=$P(BGPEXCT(X,3),U,2),I=$P(BGPEXCT(X,3),U,3)
 ..I $P($P(^BGPINDBC(BGPPC,0),U,4),".")="023" S Y=$P(^BGPINDBC(BGPPC,21),U,10),$P(BGPONN5(X),U,Y)=$S(B:B,1:0),$P(BGPONN5(X),U,(Y+3))=$S(E:E,1:0),$P(BGPONN5(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P($P(^BGPINDBC(BGPPC,0),U,4),".",1,2)="014.A" S Y=$P(^BGPINDBC(BGPPC,21),U,10),$P(BGPONN5(X),U,Y)=$S(B:B,1:0),$P(BGPONN5(X),U,(Y+3))=$S(E:E,1:0),$P(BGPONN5(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P(^BGPINDBC(BGPPC,0),U,4)="016.A.1" S Y=$P(^BGPINDBC(BGPPC,21),U,10),$P(BGPONN5(X),U,Y)=$S(B:B,1:0),$P(BGPONN5(X),U,(Y+3))=$S(E:E,1:0),$P(BGPONN5(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P(^BGPINDBC(BGPPC,0),U,4)="STI.AA.1A" S Y=$P(^BGPINDBC(BGPPC,21),U,10),$P(BGPONN5(X),U,Y)=$S(B:B,1:0),$P(BGPONN5(X),U,(Y+3))=$S(E:E,1:0),$P(BGPONN5(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P(^BGPINDBC(BGPPC,0),U,4)="STI.AB.4A" S Y=$P(^BGPINDBC(BGPPC,21),U,10),$P(BGPONN5(X),U,Y)=$S(B:B,1:0),$P(BGPONN5(X),U,(Y+3))=$S(E:E,1:0),$P(BGPONN5(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P($G(^BGPINDBC(BGPPC,19)),U,13) S Y=$P(^BGPINDBC(BGPPC,21),U,1),$P(BGPONN5(X),U,Y)=$S(B:B,1:0),$P(BGPONN5(X),U,(Y+3))=$S(E:E,1:0),$P(BGPONN5(X),U,(Y+6))=$S(H:H,1:0) Q
 ..S Y=$P(^BGPINDBC(BGPPC,21),U,10)
 ..S $P(BGPONN5(X),U,$P(^BGPINDBC(BGPPC,21),U,10))=$S(A:A,1:0),$P(BGPONN5(X),U,(Y+1))=$S(B:B,1:0),$P(BGPONN5(X),U,(Y+2))=$$SL(C)
 ..S $P(BGPONN5(X),U,(Y+3))=$S(D:D,1:0),$P(BGPONN5(X),U,(Y+4))=$S(E:E,1:0),$P(BGPONN5(X),U,(Y+5))=$$SL(F),$P(BGPONN5(X),U,(Y+6))=$S(G:G,1:0),$P(BGPONN5(X),U,(Y+7))=$S(H:H,1:0),$P(BGPONN5(X),U,(Y+8))=$$SL(I)
 Q
SL(V) ;
 I V="" S V=0
 Q $$STRIP^XLFSTR($J(V,5,1)," ")
