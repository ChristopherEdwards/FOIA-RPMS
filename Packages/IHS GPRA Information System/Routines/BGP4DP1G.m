BGP4DP1G ; IHS/CMI/LAB - print ind 1  ;
 ;;14.1;IHS CLINICAL REPORTING;;MAY 29, 2014;Build 114
SL(V) ;
 I V="" S V=0
 Q $$STRIP^XLFSTR($J(V,5,1)," ")
 ;
DEVEL4 ;EP
 I $G(BGPAREAA),$G(BGPEXCEL) D
 .Q:$P($G(^BGPINDJC(BGPPC,21)),U,11)=""
 .;set each numerator and percent,then set BGPEIDV4
 .NEW X S X=0 F  S X=$O(BGPSUL(X)) Q:X'=+X  D
 ..S $P(BGPEXCT(X,1),U,1)=$P($G(^BGPGPDCJ(X,N)),U,P),$P(BGPEXCT(X,1),U,3)=$S($P(BGPEXCT(X,1),U,2):(($P(BGPEXCT(X,1),U,1)/$P(BGPEXCT(X,1),U,2))*100),1:"")
 ..S $P(BGPEXCT(X,2),U,1)=$P($G(^BGPGPDPJ(X,N)),U,P),$P(BGPEXCT(X,2),U,3)=$S($P(BGPEXCT(X,2),U,2):(($P(BGPEXCT(X,2),U,1)/$P(BGPEXCT(X,2),U,2))*100),1:"")
 ..S $P(BGPEXCT(X,3),U,1)=$P($G(^BGPGPDBJ(X,N)),U,P),$P(BGPEXCT(X,3),U,3)=$S($P(BGPEXCT(X,3),U,2):(($P(BGPEXCT(X,3),U,1)/$P(BGPEXCT(X,3),U,2))*100),1:"")
 .S X=0 F  S X=$O(BGPEXCT(X)) Q:X'=+X  D
 ..S A=$P(BGPEXCT(X,1),U,1),B=$P(BGPEXCT(X,1),U,2),C=$P(BGPEXCT(X,1),U,3)
 ..S D=$P(BGPEXCT(X,2),U,1),E=$P(BGPEXCT(X,2),U,2),F=$P(BGPEXCT(X,2),U,3)
 ..S G=$P(BGPEXCT(X,3),U,1),H=$P(BGPEXCT(X,3),U,2),I=$P(BGPEXCT(X,3),U,3)
 ..I $P($P(^BGPINDJC(BGPPC,0),U,4),".")="023" S Y=$P(^BGPINDJC(BGPPC,21),U,11),$P(BGPEIDV4(X),U,Y)=$S(B:B,1:0),$P(BGPEIDV4(X),U,(Y+3))=$S(E:E,1:0),$P(BGPEIDV4(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P($P(^BGPINDJC(BGPPC,0),U,4),".",1,2)="014.A" S Y=$P(^BGPINDJC(BGPPC,21),U,11),$P(BGPEIDV4(X),U,Y)=$S(B:B,1:0),$P(BGPEIDV4(X),U,(Y+3))=$S(E:E,1:0),$P(BGPEIDV4(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P(^BGPINDJC(BGPPC,0),U,4)="016.A.1" S Y=$P(^BGPINDJC(BGPPC,21),U,11),$P(BGPEIDV4(X),U,Y)=$S(B:B,1:0),$P(BGPEIDV4(X),U,(Y+3))=$S(E:E,1:0),$P(BGPEIDV4(X),U,(Y+6))=$S(H:H,1:0) Q
 ..I $P($G(^BGPINDJC(BGPPC,19)),U,13) S Y=$P(^BGPINDJC(BGPPC,21),U,11),$P(BGPEIDV4(X),U,Y)=$S(B:B,1:0),$P(BGPEIDV4(X),U,(Y+3))=$S(E:E,1:0),$P(BGPEIDV4(X),U,(Y+6))=$S(H:H,1:0) Q
 ..S Y=$P(^BGPINDJC(BGPPC,21),U,11)
 ..S $P(BGPEIDV4(X),U,$P(^BGPINDJC(BGPPC,21),U,11))=$S(A:A,1:0),$P(BGPEIDV4(X),U,(Y+1))=$S(B:B,1:0),$P(BGPEIDV4(X),U,(Y+2))=$$SL(C)
 ..S $P(BGPEIDV4(X),U,(Y+3))=$S(D:D,1:0),$P(BGPEIDV4(X),U,(Y+4))=$S(E:E,1:0),$P(BGPEIDV4(X),U,(Y+5))=$$SL(F),$P(BGPEIDV4(X),U,(Y+6))=$S(G:G,1:0),$P(BGPEIDV4(X),U,(Y+7))=$S(H:H,1:0),$P(BGPEIDV4(X),U,(Y+8))=$$SL(I)
 Q
