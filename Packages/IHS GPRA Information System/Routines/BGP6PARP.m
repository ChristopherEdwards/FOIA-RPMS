BGP6PARP ; IHS/CMI/LAB - IHS gpra print ;
 ;;16.1;IHS CLINICAL REPORTING;;MAR 22, 2016;Build 170
 ;
 ;
PRINT ;EP
 I $G(BGPDASH) D AREA^BGP6DBPR Q
 K ^TMP($J)
 S BGPIOSL=$S($G(BGPGUI):55,1:IOSL)
 S BGPGPG=0
 S BGPQUIT=""
 S BGPIFTR=""
 S ^TMP($J,"BGPDEL",0)=0
 S BGPPTYPE="P"
 D SETEXCEL^BGP6DP
 I BGPROT="D" G DEL
 D AREACP^BGP6DH
 S BGPQUIT="",BGPGPG=0,BGPRPT=0
 D PRINT1^BGP6DP
 Q:BGPQUIT
 S BGPIFTR=1
 Q:BGPROT="P"
DEL ;create delimited output file
 S BGPQUIT="",BGPGPG=0,BGPRPT=0,BGPIFTR=""
 D ^%ZISC ;close printer device
 K ^TMP($J)
 ;D ^BGP6PDL ;create ^tmp of delimited report
 S ^TMP($J,"BGPDEL",0)=0
 S BGPPTYPE="D",BGPQUIT=0
 D AREACP^BGP6DH
 S BGPQUIT="",BGPGPG=0,BGPRPT=0
 D PRINT1^BGP6DP
 I '$G(BGPNODEL) D SAVEDEL^BGP6PDL   ;D ^BGP6PDL ;create ^tmp of delimited report
 S BGPIFTR=1
 K ^TMP($J)
 Q
 ;
