BGP8DH1 ; IHS/CMI/LAB - cover page for gpra 28 Apr 2008 11:30 AM ; 02 Jul 2008  8:28 AM
 ;;8.0;IHS CLINICAL REPORTING;**2**;MAR 12, 2008
 ;
 ;
PEHDR ;EP
 W !
 Q:$G(BGPSEAT)
 S BGPNODEP=34
 S BGPX=$O(^BGPCTRL("B",2008,0))
 S BGPY=0 F  S BGPY=$O(^BGPCTRL(BGPX,BGPNODEP,BGPY)) Q:BGPY'=+BGPY!(BGPQHDR)  D
 .I $Y>(BGPIOSL-2) D HDR^BGP8DH Q:BGPQHDR
 .W !,^BGPCTRL(BGPX,BGPNODEP,BGPY,0)
 .Q
 W !
 Q
AHDR ;EP
 ;
 I 'BGPHPG G AHDR1
 I $E(IOST)="C",IO=IO(0) W ! S DIR(0)="EO" D ^DIR K DIR I Y=0!(Y="^")!($D(DTOUT)) S BGPQHDR=1 Q
AHDR1 ;
 S BGPHPG=BGPHPG+1 W:$D(IOF) @IOF
 W !,$$CTR^BGP8DH("Cover Page",80)
 I BGPRTYPE=1,'$G(BGP8GPU) W !!,$$CTR^BGP8DH("*** IHS 2008 National GPRA Report ***",80)
 I BGPRTYPE=6 W !!,$$CTR^BGP8DH("*** IHS 2008 Patient Education Report ***",80)
 I BGPRTYPE=1,$G(BGP8GPU) W !!,$$CTR^BGP8DH("*** IHS 2008 GPRA Performance Report ***",80)
 I BGPRTYPE=7 W !!,$$CTR^BGP8DH("*** IHS 2008 Other National Measures Report ***",80)
 W !,$$CTR^BGP8DH("AREA AGGREGATE",80)
 W !,$$CTR^BGP8DH($$RPTVER^BGP8BAN,80),!
 S X="Date Report Run:  "_$$FMTE^XLFDT(DT) W $$CTR^BGP8DH(X,80),!
 S X="Site where Run:  "_$$VAL^XBDIQ1(9999999.06,DUZ(2),.04) W $$CTR^BGP8DH(X,80),!
 W $$CTR^BGP8DH("Report Generated by: "_$$USR^BGP8DH,80),!
 S X="Report Period:  "_$$FMTE^XLFDT(BGPBD)_" to "_$$FMTE^XLFDT(BGPED) W $$CTR^BGP8DH(X,80),!
 S X="Previous Year Period:  "_$$FMTE^XLFDT(BGPPBD)_" to "_$$FMTE^XLFDT(BGPPED) W $$CTR^BGP8DH(X,80),!
 S X="Baseline Period:  "_$$FMTE^XLFDT(BGPBBD)_" to "_$$FMTE^XLFDT(BGPBED) W $$CTR^BGP8DH(X,80),!
 Q
COMHDR ;EP
 W !
 Q:$G(BGPSEAT)
 S BGPNODEP=$S($G(BGPCHSO):24,1:17)
 S BGPX=$O(^BGPCTRL("B",2008,0))
 S BGPY=0 F  S BGPY=$O(^BGPCTRL(BGPX,BGPNODEP,BGPY)) Q:BGPY'=+BGPY!(BGPQHDR)  D
 .I $Y>(BGPIOSL-2) D HDR^BGP8DH Q:BGPQHDR
 .W !,^BGPCTRL(BGPX,BGPNODEP,BGPY,0)
 .Q
 I $G(BGP8GPU) W !!,"See last pages of this report for Performance Summaries."
 W !
 Q
PPHDR ;EP
 W !
 S BGPX=$O(^BGPCTRL("B",2008,0))
 S BGPY=0 F  S BGPY=$O(^BGPCTRL(BGPX,18,BGPY)) Q:BGPY'=+BGPY!(BGPQHDR)  D
 .I $Y>(BGPIOSL-2) D HDR^BGP8DH Q:BGPQHDR
 .W !,^BGPCTRL(BGPX,18,BGPY,0)
 .Q
 W !
 Q
ALLHDR ;EP
 W !
 Q:$G(BGPSEAT)
 S BGPNODEP=$S(BGPCHSO:25,1:19)
 S BGPX=$O(^BGPCTRL("B",2008,0))
 S BGPY=0 F  S BGPY=$O(^BGPCTRL(BGPX,BGPNODEP,BGPY)) Q:BGPY'=+BGPY!(BGPQHDR)  D
 .I $Y>(BGPIOSL-2) D HDR^BGP8DH Q:BGPQHDR
 .W !,^BGPCTRL(BGPX,BGPNODEP,BGPY,0)
 .Q
 W !
 Q
