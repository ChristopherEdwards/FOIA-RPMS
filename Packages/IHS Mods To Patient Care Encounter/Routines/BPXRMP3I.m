BPXRMP3I ;IHS/CIA/MGH - Patch 3 inits. ;22-Nov-2005 13:33;MGH
 ;;1.5;CLINICAL REMINDERS;**1003**;Jun 19, 2000
 ;Routine to install GPRA reminders
 ;
ENV ;EP environment check
 N PATCH
 S (XPDDIQ("XPZ1"),XPDDIQ("XPZ2"))=0
 ;
 S PATCH="PXRM*1.5*1002"
 I '$$PATCH(PATCH) D  Q
 . W !,"You must first install "_PATCH_"." S XPDQUIT=2
 S PATCH="AUPN*99.1*15"
 I '$$PATCH(PATCH) D  Q
 .W !,"You must first install "_PATCH_"." S XPDQUIT=2
 S PATCH="AUM*5.1*9"
 I '$$PATCH(PATCH) D  Q
 .W !,"You must first inatall "_PATCH_"." S XPDQUIT=2
 Q
 ;
PATCH(X) ;return 1 if patch X was installed, X=aaaa*nn.nn*nnnn
 ;copy of code from XPDUTL but modified to handle 4 digit IHS patch numb
 Q:X'?1.4UN1"*"1.2N1"."1.2N.1(1"V",1"T").2N1"*"1.4N 0
 NEW NUM,I,J
 S I=$O(^DIC(9.4,"C",$P(X,"*"),0)) Q:'I 0
 S J=$O(^DIC(9.4,I,22,"B",$P(X,"*",2),0)),X=$P(X,"*",3) Q:'J 0
 ;check if patch is just a number
 Q:$O(^DIC(9.4,I,22,J,"PAH","B",X,0)) 1
 S NUM=$O(^DIC(9.4,I,22,J,"PAH","B",X_" SEQ"))
 Q (X=+NUM)
 ;
 ;===============================================================
DELEI ;If the Exchange File entry already exists delete it.
 ;
 N IND,LIST,PXRMVAL,NUM
 ;
 S PXRMVAL(1)="IHS-ALCOHOL SCREEN"
 D BDEL
 S PXRMVAL(1)="IHS-ASTHMA PLAN"
 D BDEL
 S PXRMVAL(1)="IHS-ASTHMA PRIM PROV"
 D BDEL
 S PXRMVAL(1)="IHS-ASTHMA SEVERITY"
 D BDEL
 S PXRMVAL(1)="IHS-ASTHMA STEROIDS"
 D BDEL
 S PXRMVAL(1)="IHS-BLOOD PRESSURE"
 D BDEL
 S PXRMVAL(1)="IHS-COLON CANCER"
 D BDEL
 S PXRMVAL(1)="IHS-DEPRESSION SCREEN"
 D BDEL
 S PXRMVAL(1)="IHS-DIAB ACE/ARB"
 D BDEL
 S PXRMVAL(1)="IHS-DIAB ASPIRIN"
 D BDEL
 S PXRMVAL(1)="IHS-DIAB DENTAL EXAM"
 D BDEL
 S PXRMVAL(1)="IHS-DIAB EYE EXAM"
 D BDEL
 S PXRMVAL(1)="IHS-DIAB FOOT EXAM"
 D BDEL
 S PXRMVAL(1)="IHS-DIAB HGBA1C"
 D BDEL
 S PXRMVAL(1)="IHS-DIAB MICROALBUMIN"
 D BDEL
 S PXRMVAL(1)="IHS-DOMESTIC VIOLENCE"
 D BDEL
 S PXRMVAL(1)="IHS-HCT/HGB"
 D BDEL
 S PXRMVAL(1)="IHS-HEAD CIRCUMFERENCE"
 D BDEL
 S PXRMVAL(1)="IHS-HEARING TEST"
 D BDEL
 S PXRMVAL(1)="IHS-HEIGHT"
 D BDEL
 S PXRMVAL(1)="IHS-HIGH RISK FLU"
 D BDEL
 S PXRMVAL(1)="IHS-HIGH RISK PNEUO"
 D BDEL
 S PXRMVAL(1)="IHS-LIPID FEMALE"
 D BDEL
 S PXRMVAL(1)="IHS-LIPID MALE"
 D BDEL
 S PXRMVAL(1)="IHS-PAP SMEAR"
 D BDEL
 S PXRMVAL(1)="IHS-MAMMOGRAM"
 D BDEL
 S PXRMVAL(1)="IHS-PAP SMEAR"
 D BDEL
 S PXRMVAL(1)="IHS-PPD"
 D BDEL
 S PXRMVAL(1)="IHS-SENIOR HEIGHT"
 D BDEL
 S PXRMVAL(1)="IHS-TOBACCO SCREEN"
 D BDEL
 S PXRMVAL(1)="IHS-VISION EXAM"
 D BDEL
 S PXRMVAL(1)="IHS-WEIGHT"
 D BDEL
 S PXRMVAL(1)="IHS-INFLUENZA IMMUNIZATION"
 D BDEL
 S PXRMVAL(1)="IHS-PNEUMOVAX IMMUNIZATION"
 D BDEL
 Q
BDEL D FIND^DIC(811.8,"","","U",.PXRMVAL,"","","","","LIST")
 S NUM=$P(LIST("DILIST",0),U,1)
 I NUM'=0 D
 .F IND=1:1:NUM D
 .. N DA,DIK
 .. S DIK="^PXD(811.8,"
 .. S DA=LIST("DILIST",2,IND)
 .. D ^DIK
 Q
 ;
 ;===============================================================
PRE ;EP Pre-inits
 D DELEI
 Q
 ;
 ;===============================================================
POST ;EP Post-inits
 D SMEXINS
 Q
 ;
 ;===============================================================
SMEXINS ;Silent mode install.
 N IEN,PXRMVAL
 S PXRMVAL(1)="IHS-ALCOHOL SCREEN"
 S PXRMVAL(2)="11/22/2005@12:39:33"
 D BBLD
 S PXRMVAL(1)="IHS-ASTHMA PLAN"
 S PXRMVAL(2)="11/22/2005@12:39:48"
 D BBLD
 S PXRMVAL(1)="IHS-ASTHMA PRIM PROV"
 S PXRMVAL(2)="11/22/2005@12:40:01"
 D BBLD
 S PXRMVAL(1)="IHS-ASTHMA SEVERITY"
 S PXRMVAL(2)="11/22/2005@12:40:15"
 D BBLD
 S PXRMVAL(1)="IHS-ASTHMA STEROIDS"
 S PXRMVAL(2)="11/22/2005@12:40:32"
 D BBLD
 S PXRMVAL(1)="IHS-BLOOD PRESSURE"
 S PXRMVAL(2)="11/22/2005@13:29:30"
 D BBLD
 S PXRMVAL(1)="IHS-COLON CANCER"
 S PXRMVAL(2)="11/22/2005@12:41:01"
 D BBLD
 S PXRMVAL(1)="IHS-DEPRESSION SCREEN"
 S PXRMVAL(2)="11/22/2005@12:41:14"
 D BBLD
 S PXRMVAL(1)="IHS-DIAB ACE/ARB"
 S PXRMVAL(2)="11/22/2005@12:41:27"
 D BBLD
 S PXRMVAL(1)="IHS-DIAB ASPIRIN"
 S PXRMVAL(2)="11/22/2005@12:41:39"
 D BBLD
 S PXRMVAL(1)="IHS-DIAB DENTAL EXAM"
 S PXRMVAL(2)="11/22/2005@12:41:53"
 D BBLD
 S PXRMVAL(1)="IHS-DIAB EYE EXAM"
 S PXRMVAL(2)="11/22/2005@12:42:08"
 D BBLD
 S PXRMVAL(1)="IHS-DIAB FOOT EXAM"
 S PXRMVAL(2)="11/22/2005@12:42:24"
 D BBLD
 S PXRMVAL(1)="IHS-DIAB HGBA1C"
 S PXRMVAL(2)="11/22/2005@12:42:40"
 D BBLD
 S PXRMVAL(1)="IHS-DIAB MICROALBUMIN"
 S PXRMVAL(2)="11/22/2005@12:42:55"
 D BBLD
 S PXRMVAL(1)="IHS-DOMESTIC VIOLENCE"
 S PXRMVAL(2)="11/22/2005@12:43:09"
 D BBLD
 S PXRMVAL(1)="IHS-HCT/HGB"
 S PXRMVAL(2)="11/22/2005@12:43:29"
 D BBLD
 S PXRMVAL(1)="IHS-HEAD CIRCUMFERENCE"
 S PXRMVAL(2)="11/22/2005@13:29:43"
 D BBLD
 S PXRMVAL(1)="IHS-HEARING TEST"
 S PXRMVAL(2)="11/22/2005@13:29:55"
 D BBLD
 S PXRMVAL(1)="IHS-HEIGHT"
 S PXRMVAL(2)="11/22/2005@13:30:09"
 D BBLD
 S PXRMVAL(1)="IHS-HIGH RISK FLU"
 S PXRMVAL(2)="11/22/2005@12:44:32"
 D BBLD
 S PXRMVAL(1)="IHS-HIGH RISK PNEUMO"
 S PXRMVAL(2)="11/22/2005@12:44:45"
 D BBLD
 S PXRMVAL(1)="IHS-INFLUENZA IMMUNIZATION"
 S PXRMVAL(2)="11/22/2005@12:44:58"
 D BBLD
 S PXRMVAL(1)="IHS-LIPID FEMALE"
 S PXRMVAL(2)="11/22/2005@12:45:17"
 D BBLD
 S PXRMVAL(1)="IHS-LIPID MALE"
 S PXRMVAL(2)="11/22/2005@12:45:34"
 D BBLD
 S PXRMVAL(1)="IHS-MAMMOGRAM"
 S PXRMVAL(2)="11/22/2005@12:45:46"
 D BBLD
 S PXRMVAL(1)="IHS-PAP SMEAR"
 S PXRMVAL(2)="11/22/2005@12:46:06"
 D BBLD
 S PXRMVAL(1)="IHS-PNEUMOVAX IMMUNIZATION"
 S PXRMVAL(2)="11/22/2005@12:46:25"
 D BBLD
 S PXRMVAL(1)="IHS-PPD"
 S PXRMVAL(2)="11/22/2005@12:46:47"
 D BBLD
 S PXRMVAL(1)="IHS-SENIOR HEIGHT"
 S PXRMVAL(2)="11/22/2005@12:47:00"
 D BBLD
 S PXRMVAL(1)="IHS-TOBACCO SCREEN"
 S PXRMVAL(2)="11/22/2005@12:47:15"
 D BBLD
 S PXRMVAL(1)="IHS-VISION EXAM"
 S PXRMVAL(2)="11/22/2005@13:30:22"
 D BBLD
 S PXRMVAL(1)="IHS-WEIGHT"
 S PXRMVAL(2)="11/22/2005@13:30:34"
 D BBLD
 Q
BBLD ;Do the store
 S IEN=+$$FIND1^DIC(811.8,"","KU",.PXRMVAL)
 I IEN'=0 D
 . N TEXT
 . S TEXT="Installing reminder "_PXRMVAL(1)
 . D BMES^XPDUTL(TEXT)
 . D INSTALL^PXRMEXSI(IEN)
 Q
