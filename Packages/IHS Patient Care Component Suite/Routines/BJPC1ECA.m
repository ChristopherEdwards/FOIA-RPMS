BJPC1ECA ; IHS/CMI/LAB - PCC Suite v1.0 patch 1 environment check
 ;;1.0;IHS PCC SUITE;**1**;MAR 14, 2008
 ;
 ;
TAXREAD ;EP
 S BJPCPNSP=""
 S BJPCTEXT="TAX" F BJPCX=1:1 S BJPCDATA=$P($T(@BJPCTEXT+BJPCX),";;",2) Q:BJPCDATA=""  D
 .S BJPCDA=$O(^ATXAX("B",$P(BJPCDATA,"|"),0))
 .Q:BJPCDA=""
 .S $P(^ATXAX(BJPCDA,0),U,4)="n" W !,$P(BJPCDATA,"|")  ;SET NO DELETE
 .S $P(^ATXAX(BJPCDA,0),U,22)=$P(BJPCDATA,"|",2) ;set read only
 .;set packages in multiple
 .K DIC,DA,DR
 .S BJPCP=$P(BJPCDATA,"|",3)
 .F BJPCN=1:1 S BJPCPP=$P(BJPCP,"*",BJPCN) Q:BJPCPP=""  D
 ..S BJPCPI=$O(^DIC(9.4,"C",BJPCPP,0))
 ..Q:BJPCPI=""  ;NO PACKAGE
 ..S X="`"_BJPCPI,DIC="^ATXAX("_BJPCDA_",41,",DIC(0)="L",DIC("P")=$P(^DD(9002226,4101,0),U,2),DA(1)=BJPCDA
 ..D ^DIC
 ..I Y=-1 W !,"updating package multiple for ",BJPCPP," entry ",$P(^ATXAX(BJPCDA,0),U)," failed"
 ..K DIC,DA,Y,X
 .Q
 ;
SETTAXL ;
 ;Q:'$D(^DD(9002228,4101,0))  ;taxonomy patch not yet installed
 S BJPCTEXT="LABTAX" F BJPCX=1:1 S BJPCDATA=$P($T(@BJPCTEXT+BJPCX),";;",2) Q:BJPCDATA=""  D
 .S BJPCDA=$O(^ATXLAB("B",$P(BJPCDATA,"|"),0))
 .Q:BJPCDA=""
 .S $P(^ATXLAB(BJPCDA,0),U,4)="n" W !,$P(BJPCDATA,"|")  ;SET NO DELETE
 .S $P(^ATXLAB(BJPCDA,0),U,22)=$P(BJPCDATA,"|",2) ;set read only
 .S $P(^ATXLAB(BJPCDA,0),U,11)=$P(BJPCDATA,"|",4) ;set panel yes/no
 .;set packages in multiple
 .K DIC,DA,DR
 .S BJPCP=$P(BJPCDATA,"|",3)
 .F BJPCN=1:1 S BJPCPP=$P(BJPCP,"*",BJPCN) Q:BJPCPP=""  D
 ..S BJPCPI=$O(^DIC(9.4,"C",BJPCPP,0))
 ..Q:BJPCPI=""  ;NO PACKAGE
 ..S X="`"_BJPCPI,DIC="^ATXLAB("_BJPCDA_",41,",DIC(0)="L",DIC("P")=$P(^DD(9002228,4101,0),U,2),DA(1)=BJPCDA
 ..D ^DIC
 ..I Y=-1 W !,"updating package multiple for ",BJPCPP," entry ",$P(^ATXLAB(BJPCDA,0),U)," failed"
 ..K DIC,DA,Y,X
 .Q
 Q
 ;
TAX ;
 ;;DM AUDIT INCRETIN MIMETIC|0|APCL*BDM
 ;;DM AUDIT DPP4 INHIBITOR DRUGS|0|APCL*BDM
 ;;DM AUDIT P/C RATIO LOINC|1|APCL*BDM
 ;;DM AUDIT P/C RATIO TAX|0|APCL*BDM
 ;;DM AUDIT A/C RATIO TAX|0|APCL*BDM
 ;;APCL DIABETES REG COMPLICATION|0|APCL*BDM
 ;;APCL DIABETES REG NEW CASE|0|APCL*BDM
 ;;DM AUDIT 75GM 2HR LOINC|1|APCL*APCH*BDM
 ;;DM AUDIT A/C RATIO LOINC|1|APCL*BDM
 ;;DM AUDIT ACARBOSE DRUGS|0|APCL*BDM
 ;;DM AUDIT ACE INHIBITORS|0|APCL*BDM
 ;;DM AUDIT ANTI-PLATELET DRUGS|0|APCL*BDM
 ;;DM AUDIT ASPIRIN DRUGS|0|APCL*BDM
 ;;DM AUDIT CESSATION HLTH FACTOR|0|APCL*BDM
 ;;DM AUDIT DENTAL EXAM ADA CODES|0|APCL*BDM
 ;;DM AUDIT DEPRESSIVE DISORDERS|1|APCL*BDM
 ;;DM AUDIT DIABETES EDUC TOPICS|0|APCL*BDM
 ;;DM AUDIT DIET EDUC TOPICS|0|APCL*BDM
 ;;DM AUDIT EKG CPTS|1|APCL*BDM
 ;;DM AUDIT ESTIMATED GFR LOINC|1|APCL*APCH
 ;;DM AUDIT EXCERCISE EDUC TOPICS|0|APCL*BDM
 ;;DM AUDIT EXERCISE EDUC TOPICS|0|APCL*BDM
 ;;DM AUDIT EYE EXAM DXS|1|APCL*BDM
 ;;DM AUDIT FASTING GLUC LOINC|1|APCL*APCH*BDM
 ;;DM AUDIT FLU CPTS|1|APCL*BDM
 ;;DM AUDIT INSULIN DRUGS|0|APCL*BDM
 ;;DM AUDIT LIPID LOWERING DRUGS|0|APCL*BDM
 ;;DM AUDIT MAMMOGRAM CPTS|1|APCL*BDM
 ;;DM AUDIT METFORMIN DRUGS|0|APCL*BDM
 ;;DM AUDIT ORAL HYPOGLYCEMICS|0|APCL*BDM
 ;;DM AUDIT OTHER EDUC TOPICS|0|APCL*BDM
 ;;DM AUDIT PAP CPTS|1|APCL*BDM
 ;;DM AUDIT PERIDONTAL ADA CODES|0|APCL*BDM
 ;;DM AUDIT PNEUMO CPTS|1|APCL*BDM
 ;;DM AUDIT PRE-DIABETES DXS|1|APCL*BDM*APCH
 ;;DM AUDIT PROBLEM DIABETES DX|1|APCL*BDM
 ;;DM AUDIT PROBLEM HTN DIAGNOSES|1|APCL*BDM
 ;;DM AUDIT PROBLEM SMOKING DXS|1|APCL*BDM
 ;;DM AUDIT PROBLEM TB DXS|1|APCL*BDM
 ;;DM AUDIT SDM PROVIDERS|0|APCL*BDM
 ;;DM AUDIT SELF MONITOR DRUGS|0|APCL*BDM
 ;;DM AUDIT SMOKING CESS EDUC|0|APCL*BDM
 ;;DM AUDIT SMOKING RELATED DXS|1|APCL*BDM
 ;;DM AUDIT STATIN DRUGS|0|APCL*BDM
 ;;DM AUDIT SULFONYLUREA DRUGS|0|APCL*BDM
 ;;DM AUDIT TB HEALTH FACTORS|0|APCL*BDM
 ;;DM AUDIT TD CPTS|1|APCL*BDM
 ;;DM AUDIT TOBACCO HLTH FACTORS|0|APCL*BDM
 ;;DM AUDIT GLITAZONE DRUGS|0|APCL*BDM
 ;;DM AUDIT TYPE I DXS|1|APCL*BDM
 ;;DM AUDIT TYPE II DXS|1|APCL*BDM
 ;;DM AUDIT MICROALBUMIN LOINC CODES|1|APCL*BDM
 ;;DM AUDIT URINALYSIS LOINC|1|APCL*BDM
 ;;DM AUDIT URINE PROTEIN LOINC|1|APCL*BDM
 ;;APCL CAR CNM|0|APCL
 ;;APCL CAR DENTISTS|0|APCL
 ;;APCL CAR FNP|0|APCL
 ;;APCL CAR LCSW|0|APCL
 ;;APCL CAR LVN|0|APCL
 ;;APCL CAR OTHER PROVIDERS|0|APCL
 ;;APCL CAR OTHER2|0|APCL
 ;;APCL CAR PA|0|APCL
 ;;APCL CAR PHYSICIANS|0|APCL
 ;;APCL CAR PSYCHIATRIST|0|APCL
 ;;APCL CAR PSYCHOLOGIST|0|APCL
 ;;APCL CAR PT ED|0|APCL
 ;;APCL CAR RDA|0|APCL
 ;;APCL CAR RN|0|APCL
 ;;
LABTAX ;;
 ;;APCH HCT/HGB TESTS|0|APCH|1
 ;;BGP QUANT URINE PROTEIN|0|APCL*BDM*BGP|1
 ;;DM AUDIT 2 HR GTT TAX|0|APCL*BDM|1
 ;;DM AUDIT LIPID PROFILE TAX|0|APCL*BDM|1
 ;;DM AUDIT PAP SMEAR TAX|0|APCL*BDM|1
 ;;DM AUDIT URINALYSIS TAX|0|APCL*BDM|1
 ;;
