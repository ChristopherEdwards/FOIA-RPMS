BCHEXERR ; IHS/TUCSON/LAB - LOG ERROR IN EXPORT ;  [ 10/28/96  2:05 PM ]
 ;;1.0;IHS RPMS CHR SYSTEM;;OCT 28, 1996
 ;
START ;
 S BCHE("ERR DFN")=$O(^BCHERR("B",BCHE,"")) I BCHE("ERR DFN")="" S BCHE("MSG")=BCHE_"-ERROR INFORMATION NOT IN ERROR FILE" G ERR
 S BCHE("MSG")=BCHE_"-"_$P(^BCHERR(BCHE("ERR DFN"),0),U,2) S:$L(BCHE("MSG"))=5 BCHE("MSG")=BCHE("MSG")_"- ERROR INFORMATION NOT IN ERROR FILE" S BCHE("MSG")=$E(BCHE("MSG"),1,45)
ERR ;
 K DIE,DR S DA=BCH("RUN LOG"),DR="5101///""`"_BCHR_"""",DR(2,90002.915101)=".02///"_BCHE("MSG"),DIE="^BCHXLOG("
 D CALLDIE^BCHUTIL
 I $D(Y) S BCH("QFLG")=25 W:'$D(ZTQUEUED) !!,"Error encountered in ^BCHERR.  Notify programmer!",! I $D(ZTQUEUED) D ERRBULL^BCHEXDI3
 Q
