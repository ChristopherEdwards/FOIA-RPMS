BHLZV1 ; cmi/sitka/maw - BHL GIS ZV1 Supplement ; 
 ;;3.01;BHL IHS Interfaces with GIS;;JUL 01, 2001
 ;
 ;
 ;this routine will supplement the GIS ZV1 segment
 ;
VHSP ;-- generate ZV1 fields from the V Hospitalization file       
 S BHLDA=$O(^AUPNVINP("AD",BHL("VIEN"),0))
 Q:'BHLDA
 S BHLASVCI=$$VALI^XBDIQ1(9000010.02,BHLDA,.04)
 S BHLASVCE=$$VAL^XBDIQ1(9000010.02,BHLDA,.04)
 S BHLASVCC=$S(BHLASVCI'="":$$VAL^XBDIQ1(45.7,BHLASVCI,9999999.01),1:"")
 S INA("ZV110")=BHLASVCC_CS_BHLASVCE_CS_BHL("IHST")
 S BHLDSVCI=$$VALI^XBDIQ1(9000010.02,BHLDA,.05)
 S BHLDSVCE=$$VAL^XBDIQ1(9000010.02,BHLDA,.05)
 S BHLDSVCC=$S(BHLDSVCI'="":$$VAL^XBDIQ1(45.7,BHDASVCI,9999999.01),1:"")
 S INA("ZV111")=BHLDSVCC_CS_BHLDSVCE_CS_BHL("IHST")
 S INA("ZV112")=$$VAL^XBDIQ1(9000010.02,BHLDA,.08)
 S INA("ZV113")=$$VALI^XBDIQ1(9000010.02,BHLDA,.11)
 S INA("ZV114")=$$VALI^XBDIQ1(9000010.02,BHLDA,.13)
 ;
VCHS ;-- generate ZV1 fields from the V CHS file
 S BHLDA=$O(^AUPNVCHS("AD",BHL("VIEN"),0))
 Q:'BHLDA
 S BHLCAN=$$VAL^XBDIQ1(9000010.03,BHLDA,.04)
 S BHLCAF=$$VAL^XBDIQ1(9000010.03,BHLDA,.01)
 S INA("ZV115")=BHLCAN_CS_BHLCAF
 S BHLPSI=$$VALI^XBDIQ1(9000010.03,BHLDA,.05)
 S BHLPSE=$$VAL^XBDIQ1(9000010.03,BHLDA,.05)
 S INA("ZV116")=BHLPSI_CS_BHLPSE_CS_BHL("IHST")
 S INA("ZV117")=$$VAL^XBDIQ1(9000010.03,BHLDA,.06)
 S BHLSTI=$$VALI^XBDIQ1(9000010.03,BHLDA,.11)
 S BHLSTE=$$VAL^XBDIQ1(9000010.03,BHLDA,.11)
 S INA("ZV118")=BHLSTI_CS_BHLSTE_CS_BHL("IHST")
 S INA("ZV119")=$$VAL^XBDIQ1(9000010.03,BHLDA,.12)
 S INA("ZV120")=$$VAL^XBDIQ1(9000010.03,BHLDA,.13)
 S INA("ZV121")=$$VAL^XBDIQ1(9000010.03,BHLDA,.14)
 ;  
VACT ;-- generate the ZV1 fields from the V Activity File
 S BHLDA=$O(^AUPNVACT("AD",BHL("VIEN"),0))
 Q:'BHLDA
 S INA("ZV122")=$$VAL^XBDIQ1(9000010.19,BHLDA,.01)
 S INA("ZV123")=$$VAL^XBDIQ1(9000010.19,BHLDA,.04)
 ;
EOJ ;-- lets kill the variables
 K BHLDA,BHLCAN,BHLCAF,BHLPSI,BHLPSE,BHLSTI,BHLSTE,BHLASVCI,BHLASVCE
 K BHLASVCC,BHLDSVCI,BHLDSVCE,BHLDSVCC
 Q
 ;
