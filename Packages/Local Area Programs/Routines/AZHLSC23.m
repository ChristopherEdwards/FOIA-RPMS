AZHLSC23 ; IHS/ADC/GTH:KEU:JN - SAC CHAPTER 2: M LANGUAGE PROGRAMMING STANDARDS & CONVENTIONS ;  [ 08/05/1999  7:21 AM ] [4/28/00 1:11pm]
 ;;5.0;AZHLSC;;JUL 10, 1996
 ;CHANGED DIF="Z(" TO GLOBAL AND OTHER REFERENCES TO THE 
 ;ARRAY TO THE GLOBAL REFERENCE TO ACCOMMODATE LARGE RTNS SIZES
 ;IHS/ABQ/KEU  4/7/95
 ;W !!!,$P($P($T(+1),";",2),"-",2)
 NEW A,A3,A4,A5,ARG,B,CH,COM,DIF,G,I,J,LIN,NORTNS,NUL,R,Q,XCNP,Z
 D END
 S Q="""",A4="=""O ",A5="=""C ",NORTNS=$O(^UTILITY($J,""))=""
 S AZHL=""
 F  S AZHL=$O(^UTILITY($J,AZHL)) Q:AZHL=""  W:AZHLTERM "." K Z S X=AZHL,DIF="^TMP($J,""Z"",",XCNP=0 X "X ^%ZOSF(""LOAD""),AZHLGFCX" I  S XCNP=XCNP-1 D
 .;F Z=3:1:XCNP S Z(Z)=^TMP($J,"Z",Z,0) K ^TMP($J,"Z",Z,0) D
 .F Z=3:1:XCNP S Z(Z)=^TMP($J,"Z",Z,0) D
 ..I Z(Z)["S DUZ" D EN^AZHLSC47 Q:AZHLSC4I=1  S ^TMP($J,"2314",AZHL,Z)=Z(Z)
 ..;I Z(Z)["S U=" D U^AZHLSC48 I AZHLSC4I'=1 S ^TMP($J,"23151",AZHL,Z)=Z(Z)
 ..D EN^AZHLSC47 Q:AZHLSC4I=1  F J(1)=" K U"," N U","S U=" I Z(Z)[J(1) S AZHLSC49=J(1),AZHLSCPR=0 D UU51 
 ..D EN^AZHLSC47 Q:AZHLSC4I=1  F J(1)=" K DT"," N DT","S DT=" I Z(Z)[J(1) S AZHLSC49=J(1),AZHLSCPR=0 D DT52
 ..D EN^AZHLSC47 Q:AZHLSC4I=1  F J(1)="S DTIME="," DTIME=",",DTIME=" I Z(Z)[J(1) S AZHLSC49=J(1),AZHLSCPR=0 D DTI53
 ..Q
 .Q
514 D TTL^AZHLSC("2.3.1.4  SET DUZ(0).")
 I NORTNS D NRTN^AZHLSC G 515
 I $L($O(^TMP($J,"2314",""))) W !?10,"SUSPECT unconditional SET of DUZ or DUZ array)." S %="" F  S %=$O(^TMP($J,"2314",%)) Q:%=""  S A=0 F  S A=$O(^TMP($J,"2314",%,A)) Q:'A  W !?10,"+",A,"^",%," :  ",^(A)
515 D TTL^AZHLSC("2.3.1.5.1  SET, KILL or NEW  of Variable U.")
 I NORTNS D NRTN^AZHLSC G 151 
 I $L($O(^TMP($J,"23151",""))) W !?10,"SUSPECT unconditional SET of Variable U ." S %="" F  S %=$O(^TMP($J,"23151",%)) Q:%=""  S A=0 F  S A=$O(^TMP($J,"23151",%,A)) Q:'A  W !?10,"+",A,"^",%," :  ",^(A)
151 D TTL^AZHLSC("2.3.1.5.2  SET, KILL or NEW of Variable DT")
 I NORTNS D NRTN^AZHLSC G 153 
 I $L($O(^TMP($J,"23152",""))) W !?10,"SUSPECT unconditional SET, KILL or NEW of Variable DT ." S %="" F  S %=$O(^TMP($J,"23152",%)) Q:%=""  S A=0 F  S A=$O(^TMP($J,"23152",%,A)) Q:'A  W !?10,"+",A,"^",%," :  ",^(A)
 ; 
153 D TTL^AZHLSC("2.3.1.5.3  SET DTIME.")
 I NORTNS D NRTN^AZHLSC G 524
 I $L($O(^TMP($J,"23153",""))) W !?10,"SUSPECT unconditional SET of DTIME." S %="" F  S %=$O(^TMP($J,"23153",%)) Q:%=""  S A=0 F  S A=$O(^TMP($J,"23153",%,A)) Q:'A  W !?10,"+",A,"^",%," :  ",^(A)
524 D 524^AZHLSC51
5251 D ^AZHLSC52    
526 D ^AZHLSC53
529 D ^AZHLSC51
 Q
AZHLSC52 ; SET RECORD TO PRINT
 S AZHLSCTI=$F(Z(Z),J(1)) I $E(Z(Z),AZHLSCTI,AZHLSCTI+2)="IME" S (AZHLSC4I,AZHLSCPR)=1
 I AZHLSCPR=1 Q
 S AZHLSCPR=1 S ^TMP($J,"23152",AZHL,Z)=Z(Z) Q
AZHLSC53 ; SET RECORD TO PRINT AZHLSC4I AZHLSCPR = 1 DO NOT PRINT
 I AZHLSCPR=1 Q
 S AZHLSCPR=1 S ^TMP($J,"23153",AZHL,Z)=Z(Z) Q
U51 ; SET RECORD TO PRINT AZHLSC4I AZHLSCPR = 1 DO NOT PRINT
 I AZHLSCPR=1 Q
 S AZHLSCPR=1 S ^TMP($J,"23151",AZHL,Z)=Z(Z) Q
UU51 ;THIS SUB ROUTINE WILL LOOK AT AZHLSC4I ONE TIME
 D U^AZHLSC48 I AZHLSC4I=1 G UUEND 
 D U51
 S AZHL0=AZHL D EN^AZHLSC47 I AZHLSC4I=1 G UUEND
 D U51
 D EN^AZHLSC46 I AZHLSC4I=1 G UUEND
 D U51 Q
UUEND Q
DT52 ;THIS SUB ROUTINE WILL LOOK AT AZHLSC4I ONE TIME
 D DTXLFDT^AZHLSC48 I AZHLSC4I=1 G DTEND 
 D AZHLSC52 I AZHLSC4I=1 G DTEND
 S AZHL0=AZHL D EN^AZHLSC47 I AZHLSC4I=1 G DTEND
 D AZHLSC52
 D EN^AZHLSC46 I AZHLSC4I=1 G DTEND
 D AZHLSC52 Q
DTEND Q
DTI53 ;THIS SUB ROUTINE WILL LOOK AT AZHLSC4I ONE TIME
 D DTIMEXU^AZHLSC48 I AZHLSC4I=1 G DTIEND 
 D AZHLSC53 G DTIEND
 S AZHL0=AZHL D EN^AZHLSC47 I AZHLSC4I=1 G DTIEND
 D AZHLSC53
 D EN^AZHLSC46 I AZHLSC4I=1 G DTEND
 D AZHLSC53 Q
DTIEND Q
END K ^TMP($J,"2314"),^("Z"),Z
 Q
