AFSHSELX ;IHS/OIRM/DSD/JDM-SET SELECTED BATCH FOR EXPORT (SPLITOUT); [ 10/27/2004   4:20 PM ]
 ;;3.0T1;AO FINANCIAL DATA MGMT SYSTEM;**13**;FEB 02, 1999
 ;;MODIFIED FOR CACHE' COMPLIANCE ;ACR*2.1*9
GETTYCLR ;
 D ^XBCLS
 W !,?20,"SELECTION OF BATCH(ES) FOR EXPORT",!!
 W !,?5,"You must now select the batches you wish to be included in the splitout."
 W !!
 I $D(AFSHSKPA) K AFSHSKPA S AFSHTYCL=AFSHBCLR G SETDIE
 K DIR S DIR(0)="S^1:PCC-BLUE;2:PCC-RED;3:BCBS-BLUE;4:BCBS-RED;5:ARMS-BLUE;6:ARMS-RED"
 S DIR("A")="ENTER TYPE-COLOR OF BATCH "
 D ^DIR
 I $D(DTOUT)!($D(DUOUT))!($D(DIRUT))!($D(DIROUT)) S AFSHSABT=1 G ENDIT
 S AFSHTYCL=X
 S A=0 D CLRSEL
SETDIE ;
 S DIE="^AFSHRCDS(",DA=AFSHTYCL,DR="[AFSH.SELECT EXPORT]"
RSET ;
 D ^DIE
 I $D(Y) W !,"COULD NOT COMPLETE THE REQUEST.  NOTIFY SUPERVISOR."
 W !
 K DIR S DIR(0)="Y",DIR("A")="ANOTHER BATCH? ",DIR("B")="Y" D ^DIR
 I $D(DTOUT)!($D(DIRUT))!($D(DUOUT)) G ENDIT
 I X="Y"!(X="y") W ! G RSET
 I $D(DTOUT)!($D(DIRUT))!($D(DUOUT)) G ENDIT
 I X="Y"!(X="y") W ! G RSET
ENDIT ;
 I '$D(Y) W !,"PROCESS COMPLETED."
 W !!,"***NOTE*** ALL BATCHES SELECTED FOR EXPORT MUST HAVE A TRAILER!!!",!
 ;R !,"PRESS <RETURN>",AFSHRTNX:300        ; ACR*2.1*13.02 IM13574
 D PAUSE^ACRFWARN                          ; ACR*2.1*13.02 IM13574
 K DIE,DA,DR,DIR,DTOUT,DUOUT,DIRUT,DIROUT,AFSHTYCL,AFSHRTNX,%,D,D0,D1,D2,DI,DQ,DIC
 D PREXPORT^AFSHVKIL
 Q
CLRSEL ;
 I '$O(^AFSHRCDS(A)) Q
 S A=$O(^AFSHRCDS(A))
 S B=0 D B1
 G CLRSEL
 Q
B1 ;
 I '$O(^AFSHRCDS(A,"D",B)) Q
 S B=$O(^AFSHRCDS(A,"D",B))
 S C=0 D C1
 G B1
C1 ;
 I '$O(^AFSHRCDS(A,"D",B,"I",C)) Q
 S C=$O(^AFSHRCDS(A,"D",B,"I",C))
 S $P(^AFSHRCDS(A,"D",B,"I",C,0),U,8)=""
 G C1
