AFSLPILU ;IHS/OIRM/DSD/JDM - PAYEE ID LOOKUP;  [ 09/27/2005  12:53 PM ]
 ;;3.0t1;1166 APPROVALS FOR PAYMENT;**19**;AUG 31, 2005
 ;Lookup for payee identification
 K AFSLPFND,AFSLPNOD
 S AFSLPNOD=0,AFSLPNXT=0
FIND ;
 I AFSLPID="" S Y=-1 G FINI
 I '$O(^VA(200,AFSLPNOD)) S Y=-1 G FINI
 S AFSLPNXT=$O(^VA(200,AFSLPNOD))
 I $D(^VA(200,AFSLPNXT,1)) S AFSLPFND=$P(^VA(200,AFSLPNXT,1),U,9)
 I AFSLPFND=AFSLPID G DOIT
 S AFSLPNOD=AFSLPNXT G FIND
DOIT ;
 ;S AFSLPNOD=AFSLPNXT,AFSLPADD=^VA(200,AFSLPNOD,.11),AFSLPNAM=$P(^VA(200,AFSLPNOD,0),U,1)
 S AFSLPNOD=AFSLPNXT
 I '$D(^VA(200,AFSLPNOD,.11)) S AFSLPADD="^^^^^",Y=-1 G FINI
 S AFSLPADD=^VA(200,AFSLPNOD,.11)
 ;S AFSLPNAM=$P(^VA(200,AFSLPNOD,0),U,1)  ;ACR*2.1*19.02 IM16848
 S AFSLPNAM=$$NAME2^ACRFUTL1(AFSLPNOD)  ;ACR*2.1*19.02 IM16848
FINI ;
 K AFSLPNXT
 QUIT
