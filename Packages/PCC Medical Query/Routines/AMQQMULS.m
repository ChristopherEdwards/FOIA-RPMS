AMQQMULS ; IHS/CMI/THL - SUBQUERIES ;
 ;;2.0;IHS PCC SUITE;;MAY 14, 2009
 ;-----
RUN I '$D(^UTILITY("AMQQ",$J,AMQQAG,AMQQUATN)) S:$D(AMQV("SQ",0,"NULL"))!($D(AMQV("SQ",+$G(AMQQUSQN),"NULL"))) ^UTILITY("AMQQ",$J,AMQQAG,AMQQUATN,1)="-" Q
 I $D(AMQV("SQ",0,1)) X AMQV("SQ",0,1) I $D(AMQV("SQ",0,"NULL")),'$D(^UTILITY("AMQQ",$J,AMQQAG,AMQQUATN)) S ^(AMQQUATN,1)="-" Q
 I '$G(AMQQUSQN) Q
 I $D(^UTILITY("AMQQ",$J,AMQQAG,AMQQUATN)),$D(AMQV("SQ",AMQQUSQN,1)) X AMQV("SQ",AMQQUSQN,1)
 I $D(AMQV("SQ",AMQQUSQN,"NULL")),$D(^UTILITY("AMQQ",$J,AMQQAG,AMQQUATN)) K ^(AMQQUATN) Q
NULL I $D(AMQV("SQ",AMQQUSQN,"NULL")) S ^UTILITY("AMQQ",$J,AMQQAG,AMQQUATN,1)="-"
 Q
 ;
REL ; ENTRY POINT FROM AMQQMUL ROUTINES
 S AMQQBASE=+^AUPNVSIT(AMQQSQVS,0)
 I 'AMQQBASE S AMQQST=9999999,AMQQFIN=9999999 Q
 S X1=AMQQBASE
 S X2=AMQQST
 D C^%DTC
 S AMQQST=X
 S X1=AMQQBASE
 S X2=AMQQFIN
 D C^%DTC
 S AMQQFIN=X
EXIT K X,AMQQBASE,%H,X1,X2
 Q
 ;
