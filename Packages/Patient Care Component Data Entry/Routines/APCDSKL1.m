APCDSKL1 ; IHS/CMI/LAB - DISPLAY SKIN TESTS ;
 ;;2.0;IHS PCC SUITE;;MAY 14, 2009
 ;
A0 S APCDSKLN="" F APCDSKLJ=1:1 S APCDSKLN=$O(^AUPNVSK("AC",APCDPAT,APCDSKLN)) Q:APCDSKLN=""  I $D(^AUPNVSK(APCDSKLN,0)) S APCDSKLX=^(0) D SB1
XA0 S APCDSKLD="",APCDSKLC=0
A1 S APCDSKLD=$O(APCDSKLA(APCDSKLD)) G C1:APCDSKLD="" D DAT
A2 S APCDSKLN=""
A3 S APCDSKLN=$O(APCDSKLA(APCDSKLD,APCDSKLN)) I APCDSKLN="" K APCDSKLA(APCDSKLD) G A1
 S APCDSKLI=$P(APCDSKLA(APCDSKLD,APCDSKLN),"^"),APCDSKLS=$P(APCDSKLA(APCDSKLD,APCDSKLN),"^",2),APCDSKLT=$P(APCDSKLA(APCDSKLD,APCDSKLN),"^",3),APCDSKLR=$P(APCDSKLA(APCDSKLD,APCDSKLN),"^",4)
A4 I APCDSKLI,$D(^AUTTSK(APCDSKLI,0)) S %I=$P(^(0),"^") S APCDSKLI=%I_" "_APCDSKLI
 W !,$J(APCDSKLC,2)
 W ?3,$J(APCDSKLW,12),?18,$J(APCDSKLI,12),?35,APCDSKLT,?52,APCDSKLS I APCDSKLR D DAR W ?61,APCDSKLW S APCDSKLW=""
 G A3
C1 W:$Y<22 ! W !,"Press 'ENTER' To Continue: " D SBRS
C2 I '$D(DFOUT) D KIL Q
END ;
KIL K APCDSKLA,APCDSKLT,APCDSKLW,APCDSKLX,APCDSKLD,APCDSKLN,APCDSKLR,APCDSKLI,Y,APCDSKLM Q
SB1 S APCDSKLD=0,APCDSKLI=$P(APCDSKLX,"^"),APCDSKLV=$P(APCDSKLX,"^",3),APCDSKLS=$P(APCDSKLX,"^",4),APCDSKLL=$P(APCDSKLX,"^",5),APCDSKLR=$P(APCDSKLX,"^",6)
 I APCDSKLV,$D(^AUPNVSIT(APCDSKLV,0)) S APCDSKLD=+$P(^(0),".")
 S APCDSKLA(APCDSKLD,APCDSKLN)=APCDSKLI_"^"_APCDSKLS_"^"_APCDSKLL_"^"_APCDSKLR Q
DAR ;
 S APCDSKLY=$E(APCDSKLR,1,3)+1700,APCDSKLM=$P("   ^Jan^Feb^Mar^Apr^May^Jun^Jul^Aug^Sep^Oct^Nov^Dec","^",$E(APCDSKLR,4,5)+1),APCDSKLW=+$E(APCDSKLR,6,7) S:'APCDSKLW APCDSKLW=""
 S:APCDSKLW APCDSKLW=$S(APCDSKLW<10:" ",1:"")_APCDSKLW S:APCDSKLM]"" APCDSKLW=APCDSKLM_$S(APCDSKLW]"":" ",1:"")_APCDSKLW_" " S APCDSKLW=APCDSKLW_APCDSKLY Q
REA ;
DAT I 'APCDSKLD S APCDSKLW="Not Listed" Q
 S APCDSKLY=$E(APCDSKLD,1,3)+1700,APCDSKLM=$P("   ^Jan^Feb^Mar^Apr^May^Jun^Jul^Aug^Sep^Oct^Nov^Dec","^",$E(APCDSKLD,4,5)+1),APCDSKLW=+$E(APCDSKLD,6,7) S:'APCDSKLW APCDSKLW=""
 S:APCDSKLW APCDSKLW=$S(APCDSKLW<10:" ",1:"")_APCDSKLW S:APCDSKLM]"" APCDSKLW=APCDSKLM_$S(APCDSKLW]"":" ",1:"")_APCDSKLW_" " S APCDSKLW=APCDSKLW_APCDSKLY
 Q
SBRS K DFOUT,DTOUT,DUOUT,DQOUT
 R Y:$S($D(DTIME):DTIME,1:120) I '$T W $C(7) R Y:5 G SBRS:Y="." I '$T S (DTOUT,DFOUT)="" Q
 I $D(USFO),USFO=Y W:$D(IOF) @IOF S (DFOUT,Y)="" Q
 S:Y="^" (DUOUT,Y)="" S:Y?1"?".E!(Y["^") (DQOUT,Y)=""
 Q
