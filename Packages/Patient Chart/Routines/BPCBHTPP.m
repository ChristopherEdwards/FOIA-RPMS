BPCBHTPP ; IHS/OIT/MJL - behavioral health display for GUI ;
 ;;1.5;BPC;;MAY 26, 2005
 ;
 ;
 ;
TEST ;
 D TPP(.RETVAL,234,"B")
 Q
TPP(BGUARRAY,BPCIEN,BPCPREV) ;EP CALL FROM REMOTE PROC: BPCBH SUICIDE FORM DSP
 ;
 S JOB=$J,BPCGUI=1,XWBWRAP=1
 S ZTIO="",ZTQUEUED=1
 S BGUARRAY="^XTMP(""BPCTP"","_$J_")"
 S AMHTP=BPCIEN,AMHBROW=1
 S AMHPREV=BPCPREV
 K ^XTMP("BPCTP",JOB)
 S ^XTMP("BPCTPRUN",JOB)=""
 D ^XBKSET
 S ZTRTN="TSK^BPCBHTPP",ZTIO="",ZTDESC="BPC TP DISPLAY",ZTSAVE("AMH*")="",ZTSAVE("JOB")="",ZTDTH=$H D ^%ZTLOAD
 F I=1:1:60 Q:$G(^XTMP("BPCTPRUN",$J))="DONE"  H 1
 D KILL
 Q
 ;
TSK ;
 D ^XBKSET
 S ^XTMP("BPCTPRUN",JOB)="START"
 D GUIR^XBLM("PRINT^AMHLETPP","^XTMP(""BPCTP"",JOB)")
 S ^XTMP("BPCTP",JOB,.5)=$O(^XTMP("BPCTP",JOB,""),-1)+1
 S ^XTMP("BPCTPRUN",JOB)="DONE"
 Q
 ;
KILL ;
 K BPCCTR,BPCGUI,AMHTP,DIC,JOB,X,Y,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,AMHPREV
 Q
