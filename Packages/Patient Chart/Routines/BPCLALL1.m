BPCLALL1 ; IHS/OIT/MJL - CONT BPCLALL LOAD INIT DATA PAT CHART ;
 ;;1.5;BPC;;MAY 26, 2005
 ;         
MEAS ;EP CALL FROM BPCPC
 S BPCCN1=0,BPCY="" F  S BPCY=$O(^AUPNVMSR("AD",BPCVSIT,BPCY)) Q:BPCY=""  D
 . S BPCCN1=BPCCN1+1
 . S BPCMDTA=$G(^AUPNVMSR(BPCY,0)),BPCVDTA=$G(^AUPNVSIT(BPCVSIT,0)),BPCVDATE=$P(BPCVDTA,U,1)
 . S BPCTYP=$P(BPCMDTA,U,1),BPCMDESC=$P($G(^AUTTMSR(BPCTYP,0)),U,2)
 . S BPCVAL=$P(BPCMDTA,U,4)
 . S ^BGUTMP(BPCSUB,BPCX,"MEAS",BPCMDESC,BPCCN1)=BPCVDATE_U_"MEAS"_U_BPCMDESC_U_BPCVAL_U_BPCY  ;FHL 8/4/98 ADDED MEASUREMENT IEN (BPCY) TO STRING
 Q
SITEP ;EP CALL FROM BPVLALL
 I '$D(^BLRSITE("B",DUZ(2))) S ^BGURES(BPCSUB,BPCCTR)="SITEP^",BPCCTR=BPCCTR+1 Q
 S BPCIEN=$O(^BLRSITE("B",DUZ(2),"")),BPCIEN="`"_BPCIEN,BPCFILE=9009029
 S BPCFLDS="1101;1102;1103;1104;1105"
 D FIND^DIC(BPCFILE,"",BPCFLDS,"",BPCIEN)
 S BPCDTA="SITEP"
 S BPCX="" F  S BPCX=$O(^TMP("DILIST",$J,"ID",BPCX)) Q:BPCX=""  D
 .S BPCF="" F  S BPCF=$O(^TMP("DILIST",$J,"ID",BPCX,BPCF)) Q:BPCF=""  D
 ..S BPCDTA=BPCDTA_U_^TMP("DILIST",$J,"ID",BPCX,BPCF)
 S ^BGURES(BPCSUB,BPCCTR)=BPCDTA,BPCCTR=BPCCTR+1
 Q
NOK ;EP CALL FROM BPCLALL
 ;S BPCDTA=$G(^DPT(BPCIEN,".21")) I BPCDTA'="" S RESULT(BPCCTR)="NOK"_U_BPCDTA,BPCCTR=BPCCTR+1 Q
 S BPCDTA=$G(^DPT(BPCIEN,".21")) I BPCDTA'="" S ^BGURES(BPCSUB,BPCCTR)="NOK"_U_BPCDTA,BPCCTR=BPCCTR+1 Q
 S BPCDTA=$G(^DPT(BPCIEN,".24")) I BPCDTA'="" D NOK1 Q
 ;S RESULT(BPCCTR)="NOK"_U_"NO NEXT OF KIN SPECIFIED",BPCCTR=BPCCTR+1
 S ^BGURES(BPCSUB,BPCCTR)="NOK"_U_"NO NEXT OF KIN SPECIFIED",BPCCTR=BPCCTR+1
 Q
NOK1 ;
 S BPCFATH=$P(BPCDTA,U,1),BPCMOTH1=$P(BPCDTA,U,2),BPCMOTH2=$P(BPCDTA,U,3)
 ;I BPCFATH'="" S RESULT(BPCCTR)="NOK"_U_BPCFATH_U_"FATHER",BPCCTR=BPCCTR+1 Q
 I BPCFATH'="" S ^BGURES(BPCSUB,BPCCTR)="NOK"_U_BPCFATH_U_"FATHER",BPCCTR=BPCCTR+1 Q
 ;I BPCMOTH1'="" S RESULT(BPCCTR)="NOK"_U_BPCMOTH1_U_"MOTHER",BPCCTR=BPCCTR+1 Q
 I BPCMOTH1'="" S ^BGURES(BPCSUB,BPCCTR)="NOK"_U_BPCMOTH1_U_"MOTHER",BPCCTR=BPCCTR+1 Q
 ;I BPCMOTH2'="" S RESULT(BPCCTR)="NOK"_U_BPCMOTH2_U_"MOTHER (MAIDEN NAME)",BPCCTR=BPCCTR+1 Q
 I BPCMOTH2'="" S ^BGURES(BPCSUB,BPCCTR)="NOK"_U_BPCMOTH2_U_"MOTHER (MAIDEN NAME)",BPCCTR=BPCCTR+1 Q
 ;S RESULT(BPCCTR)="NOK"_U_"NO NEXT OF KIN SPECIFIED",BPCCTR=BPCCTR+1
 S ^BGURES(BPCSUB,BPCCTR)="NOK"_U_"NO NEXT OF KIN SPECIFIED",BPCCTR=BPCCTR+1
 Q
