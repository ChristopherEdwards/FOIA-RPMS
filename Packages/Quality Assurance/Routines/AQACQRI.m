AQACQRI ;IHS/ASU/RPL;QUARTERLY REPORT PRINTOUTS FOR IHS INPATIENT REGISTER; [ 06/20/88  11:48 AM ] ; 11/8/89  8:34 AM
 ;;IHS QA/UR Version 2.04;11/7/89
 W !!,"Quarterly Report Printouts for IHS Inpatient Register",!!
RSTART R "Start with report number (2-17)? ",AQACNBR:$S($D(DTIME)#2:DTIME,1:3600) G QUIT:'$T!(AQACNBR="^")
 I AQACNBR'?1.2N!(AQACNBR<2)!(AQACNBR>17)!(AQACNBR="?") W !!,"Enter the number of the report to start printing with, from 2 through 17.",!,"All reports will print in order, starting with the one you choose.",!,"Enter ""^"" to quit.",!! G RSTART
 W !! S AQASNO="ENT"_AQACNBR
 D START G:'$D(AQACIOP) QUIT G:$D(IO("Q")) QUE G PRNOW
PRQUE ;Enter from TaskManager
 S AQAZTSK=ZTSK G:$D(AQACIOP) PRNOW
 F AQAG="AQACIOP","AQASD","AQASD1","AQAFD","AQAFD1","AQASNO","DUZ(2)","DUZ(0)" S @AQAG=^%ZTSK(ZTSK,0,AQAG)
PRNOW D @AQASNO G QUIT
START1 W !!,"Quarterly Report Printouts for IHS Inpatient Register",!!
START ;
AQASD S %DT("A")="Enter QUARTERLY REPORT STARTING DATE: ",%DT="AEPX" D ^%DT Q:Y<0  S AQASD=Y X ^DD("DD") S AQASD1=Y
AQAFD S %DT("A")="Enter QUARTERLY REPORT ENDING DATE: ",%DT="AEPX" D ^%DT Q:Y<0  S AQAFD=Y X ^DD("DD") S AQAFD1=Y
DEV W ! S %IS("B")="",%IS="Q" D ^%ZIS Q:'$D(IO)!(POP=1)
 S AQACIOP=IO
 W:'$D(IO("Q")) !!,"I'M WORKIN, BOSS!",!! Q
QUE K IO("Q") S ZTRTN="PRQUE^AQACQRI",ZTDESC="IHS QUARTERLY REPORTS" F AQAG="AQASNO","AQASD","AQASD1","AQAFD","AQAFD1","AQACIOP","DUZ(2)","DUZ(0)" S ZTSAVE(AQAG)=""
 D ^%ZTLOAD W:$D(ZTSK) !,"REQUEST QUEUED!",! G QUIT
PRT S IOP=AQACIOP_";"_80,PG=1,DOUT=$I D EN1^DIP
 S IOP=AQACIOP D ^%ZIS I $E(IOST)="P" U AQACIOP W @IOF X ^%ZIS("C")
 Q
ENT2 D R2^AQACQRI1
ENT3 D R3^AQACQRI1
ENT4 D R4^AQACQRI1
ENT5 D R5^AQACQRI1
ENT6 D R6^AQACQRI1
ENT7 D R7^AQACQRI1
ENT8 D R8^AQACQRI1
ENT9 D R9^AQACQRI1
ENT10 D R10^AQACQRI1
ENT11 D R11^AQACQRI2
ENT12 D R12^AQACQRI2
ENT13 D R13^AQACQRI2
ENT14 D R14^AQACQRI2
ENT15 D R15^AQACQRI2
ENT16 D R16^AQACQRI2
ENT17 D R17^AQACQRI2
 Q
 ;
EN2 ;
 S AQASNO="R2^AQACQRI1" G SINGLE
EN3 ;
 S AQASNO="R3^AQACQRI1" G SINGLE
EN4 ;
 S AQASNO="R4^AQACQRI1" G SINGLE
EN5 ;
 S AQASNO="R5^AQACQRI1" G SINGLE
EN6 ;
 S AQASNO="R6^AQACQRI1" G SINGLE
EN7 ;
 S AQASNO="R7^AQACQRI1" G SINGLE
EN8 ;
 S AQASNO="R8^AQACQRI1" G SINGLE
EN9 ;
 S AQASNO="R9^AQACQRI1" G SINGLE
EN10 ;
 S AQASNO="R10^AQACQRI1" G SINGLE
EN11 ;
 S AQASNO="R11^AQACQRI2" G SINGLE
EN12 ;
 S AQASNO="R12^AQACQRI2" G SINGLE
EN13 ;
 S AQASNO="R13^AQACQRI2" G SINGLE
EN14 ;
 S AQASNO="R14^AQACQRI2" G SINGLE
EN15 ;
 S AQASNO="R15^AQACQRI2" G SINGLE
EN16 ;
 S AQASNO="R16^AQACQRI2" G SINGLE
EN17 ;
 S AQASNO="R17^AQACQRI2" G SINGLE
SINGLE D START1 G:$D(IO("Q")) QUE G:$D(AQACIOP) PRNOW G QUIT
QUIT K %DT,DTOUT,AQACNBR,AQASNO,AQACIOP,AQASD,AQASD1,AQAFD,AQAFD1,AQAG,ZTSK I $D(AQAZTSK),$D(^%ZTSK(AQAZTSK)) K ^%ZTSK(AQAZTSK),AQAZTSK
 Q
