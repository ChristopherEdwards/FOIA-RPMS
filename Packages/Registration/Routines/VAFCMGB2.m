VAFCMGB2 ;ALB/JRP-DEMOGRAPHIC MERGE SCREENS ;28-OCT-96
 ;;5.3;Registration;**149,384**;Aug 13, 1993
 ;
 ;NOTE: This routine contains line tags used to build the display
 ;      screen for a List Manager interface.  Refer to routine
 ;      VAFCMGB for a description of input/output variables.
 ;
GROUP3 ;Line tag to build logical group number three
 ;
 ;Group three contains the following fields:
 ;  .02, .05, .08, .211, .219, .2403, .31115
 ;
 ;Column width is limited to 28 characters
 ;
 ;Declare variables
 N IENS,TARGET,MESSAGE,LINE,DATA,LOCAL,REMOTE,DIFF
 S TARGET="^TMP(""VAFC-MERGE-TO"","_$J_",""DATA"")"
 S MESSAGE="^TMP(""VAFC-MERGE-TO"","_$J_",""MESSAGE"")"
 ;Initialize global locations
 K @TARGET,@MESSAGE
 ;Set group index
 S @VALMAR@("GRP",3)=VALMCNT
 ;Get local data for patient
 D GETDATA^VAFCMGU0(VAFCDFN,3,TARGET,MESSAGE)
 ;Build display
 S IENS=VAFCDFN_","
 ;Sex
 S LOCAL=$$LOCAL^VAFCMGB0(2,.02,IENS,TARGET)
 S REMOTE=$$REMOTE^VAFCMGB0(2,.02)
 S DIFF=$$DIFFCHK^VAFCMGB0(2,.02,IENS,TARGET)
 S LINE=$S(DIFF:"**",1:"  ")_"12"
 S:DIFF&($P($G(@VAFCARR@(2,.02)),U,2)) LINE="->"_"12"
 S DATA="Sex: "_LOCAL
 S LINE=$$INSERT^VAFCMGU0(DATA,LINE,15)
 S @VALMAR@(VALMCNT,0)=$$INSERT^VAFCMGU0(REMOTE,LINE,50)
 S @VALMAR@("IDX",VALMCNT,12)=""
 I (DIFF) D
 .S @VALMAR@("E2F",12,1)="2^.02"
 .S @VALMAR@("E2G",12)=3
 I ('DIFF) D
 .K @VALMAR@("E2F",12)
 .K @VALMAR@("E2G",12)
 W:(+$G(VAFCDOTS)) "."
 S VALMCNT=VALMCNT+1
 ;Marital status
 S LOCAL=$$LOCAL^VAFCMGB0(2,.05,IENS,TARGET)
 S LOCAL=$E(LOCAL,1,28)
 S REMOTE=$$REMOTE^VAFCMGB0(2,.05)
 S REMOTE=$E(REMOTE,1,28)
 S DIFF=$$DIFFCHK^VAFCMGB0(2,.05,IENS,TARGET)
 S LINE=$S(DIFF:"**",1:"  ")_"13"
 S:DIFF&($P($G(@VAFCARR@(2,.05)),U,2)) LINE="->"_"13"
 S DATA="Marital: "_LOCAL
 S LINE=$$INSERT^VAFCMGU0(DATA,LINE,11)
 S @VALMAR@(VALMCNT,0)=$$INSERT^VAFCMGU0(REMOTE,LINE,50)
 S @VALMAR@("IDX",VALMCNT,13)=""
 I (DIFF) D
 .S @VALMAR@("E2F",13,1)="2^.05"
 .S @VALMAR@("E2G",13)=3
 I ('DIFF) D
 .K @VALMAR@("E2F",13)
 .K @VALMAR@("E2G",13)
 W:(+$G(VAFCDOTS)) "."
 S VALMCNT=VALMCNT+1
 ;Religion
 S LOCAL=$$LOCAL^VAFCMGB0(2,.08,IENS,TARGET)
 S LOCAL=$E(LOCAL,1,28)
 S REMOTE=$$REMOTE^VAFCMGB0(2,.08)
 S REMOTE=$E(REMOTE,1,28)
 S DIFF=$$DIFFCHK^VAFCMGB0(2,.08,IENS,TARGET)
 S LINE=$S(DIFF:"**",1:"  ")_"14"
 S:DIFF&($P($G(@VAFCARR@(2,.08)),U,2)) LINE="->"_"14"
 S DATA="Religion: "_LOCAL
 S LINE=$$INSERT^VAFCMGU0(DATA,LINE,10)
 S @VALMAR@(VALMCNT,0)=$$INSERT^VAFCMGU0(REMOTE,LINE,50)
 S @VALMAR@("IDX",VALMCNT,14)=""
 I (DIFF) D
 .S @VALMAR@("E2F",14,1)="2^.08"
 .S @VALMAR@("E2G",14)=3
 I ('DIFF) D
 .K @VALMAR@("E2F",14)
 .K @VALMAR@("E2G",14)
 W:(+$G(VAFCDOTS)) "."
 S VALMCNT=VALMCNT+1
 ;Mother's maiden name
 S LOCAL=$$LOCAL^VAFCMGB0(2,.2403,IENS,TARGET)
 S LOCAL=$E(LOCAL,1,28)
 S REMOTE=$$REMOTE^VAFCMGB0(2,.2403)
 S REMOTE=$E(REMOTE,1,28)
 S DIFF=$$DIFFCHK^VAFCMGB0(2,.2403,IENS,TARGET)
 S LINE=$S(DIFF:"**",1:"  ")_"15"
 S:DIFF&($P($G(@VAFCARR@(2,.2403)),U,2)) LINE="->"_"15"
 S DATA="Mom's Maiden: "_LOCAL
 S LINE=$$INSERT^VAFCMGU0(DATA,LINE,6)
 S @VALMAR@(VALMCNT,0)=$$INSERT^VAFCMGU0(REMOTE,LINE,50)
 S @VALMAR@("IDX",VALMCNT,15)=""
 I (DIFF) D
 .S @VALMAR@("E2F",15,1)="2^.2403"
 .S @VALMAR@("E2G",15)=3
 I ('DIFF) D
 .K @VALMAR@("E2F",15)
 .K @VALMAR@("E2G",15)
 W:(+$G(VAFCDOTS)) "."
 S VALMCNT=VALMCNT+1
 ;Employment status
 S LOCAL=$$LOCAL^VAFCMGB0(2,.31115,IENS,TARGET)
 S LOCAL=$E(LOCAL,1,28)
 S REMOTE=$$REMOTE^VAFCMGB0(2,.31115)
 S REMOTE=$E(REMOTE,1,28)
 S DIFF=$$DIFFCHK^VAFCMGB0(2,.31115,IENS,TARGET)
 S LINE=$S(DIFF:"**",1:"  ")_"16"
 S:DIFF&($P($G(@VAFCARR@(2,.31115)),U,2)) LINE="->"_"16"
 S DATA="Employ Stat: "_LOCAL
 S LINE=$$INSERT^VAFCMGU0(DATA,LINE,7)
 S @VALMAR@(VALMCNT,0)=$$INSERT^VAFCMGU0(REMOTE,LINE,50)
 S @VALMAR@("IDX",VALMCNT,16)=""
 I (DIFF) D
 .S @VALMAR@("E2F",16,1)="2^.31115"
 .S @VALMAR@("E2G",16)=3
 I ('DIFF) D
 .K @VALMAR@("E2F",16)
 .K @VALMAR@("E2G",16)
 W:(+$G(VAFCDOTS)) "."
 S VALMCNT=VALMCNT+1
 ;Next of kin's name
 S LOCAL=$$LOCAL^VAFCMGB0(2,.211,IENS,TARGET)
 S LOCAL=$E(LOCAL,1,28)
 S REMOTE=$$REMOTE^VAFCMGB0(2,.211)
 S REMOTE=$E(REMOTE,1,28)
 S DIFF=$$DIFFCHK^VAFCMGB0(2,.211,IENS,TARGET)
 S LINE=$S(DIFF:"**",1:"  ")_"17"
 S:DIFF&($P($G(@VAFCARR@(2,.211)),U,2)) LINE="->"_"17" ;**384
 S DATA="NOK Name: "_LOCAL
 S LINE=$$INSERT^VAFCMGU0(DATA,LINE,10)
 S @VALMAR@(VALMCNT,0)=$$INSERT^VAFCMGU0(REMOTE,LINE,50)
 S @VALMAR@("IDX",VALMCNT,17)=""
 I (DIFF) D
 .S @VALMAR@("E2F",17,1)="2^.211"
 .S @VALMAR@("E2G",17)=3
 I ('DIFF) D
 .K @VALMAR@("E2F",17)
 .K @VALMAR@("E2G",17)
 W:(+$G(VAFCDOTS)) "."
 S VALMCNT=VALMCNT+1
 ;Next of kin's phone number
 S LOCAL=$$LOCAL^VAFCMGB0(2,.219,IENS,TARGET)
 S LOCAL=$E(LOCAL,1,28)
 S REMOTE=$$REMOTE^VAFCMGB0(2,.219)
 S REMOTE=$E(REMOTE,1,28)
 S DIFF=$$DIFFCHK^VAFCMGB0(2,.219,IENS,TARGET)
 S LINE=$S(DIFF:"**",1:"  ")_"18"
 S:DIFF&($P($G(@VAFCARR@(2,.219)),U,2)) LINE="->"_"18" ;**384
 S DATA="NOK Phone #: "_LOCAL
 S LINE=$$INSERT^VAFCMGU0(DATA,LINE,7)
 S @VALMAR@(VALMCNT,0)=$$INSERT^VAFCMGU0(REMOTE,LINE,50)
 S @VALMAR@("IDX",VALMCNT,18)=""
 I (DIFF) D
 .S @VALMAR@("E2F",18,1)="2^.219"
 .S @VALMAR@("E2G",18)=3
 I ('DIFF) D
 .K @VALMAR@("E2F",18)
 .K @VALMAR@("E2G",18)
 W:(+$G(VAFCDOTS)) "."
 S VALMCNT=VALMCNT+1
 ;Done
 K @TARGET,@MESSAGE
 Q
