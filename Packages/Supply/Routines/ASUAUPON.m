ASUAUPON ;DSD/DFM - UTILITY ENTER PURCHASE ORDER NUMBER;  [ 04/15/98  2:54 PM ]
 ;;3.0;SAMS;**1**;AUG 20, 1993
RDPORD ;
 S DIR("A")="4. ENTER PURCHASE ORDER NUMBER"
 S DIR("?")="Enter 1 to 7 Characters - not all 0"
 S:'$D(ASUSW("OPTIONAL")) ASUSW("OPTIONAL")="F"
 S DIR(0)=ASUSW("OPTIONAL")_"^1:7^D POEDIT^ASUAUPON" D ^DIR
 I $D(DTOUT)!($D(DUOUT))!($D(DIROUT)) G EXIT
 S ASUTRNS(ASUTRNS,"PURCHASE ORDER #")=X
 S:ASUTRNS("TRANSACTION CODE")="5C" ASUSW("CHANGED")=1
EXIT ;RETURN TO CALLING ROUTINE
 K DIR,X,Y,ASUSW("OPTIONAL")
 Q
POEDIT ;EP ;EDIT PURCHASE ORDER NUMBER
 I $E(X)=0,+X=0 K X Q
 K:X'?.UNP X
 Q
RDPON ;EP ;READ PURCHASE ORDER NUMBER OPTIONAL
 I ASUTRNS("TRANSACTION CODE")="22"!(ASUTRNS("TRANSACTION CODE")="02") G RDPORD
 S ASUSW("OPTIONAL")="FO"
 G RDPORD
REQD ;EP ; READ PURCHASE ORDER NUMBER REQUIRED
 S ASUSW("OPTIONAL")="F"
 G RDPORD
