SROBTCH ;B'HAM ISC/MAM - BATCH PRINT OP REPORTS ; [ 02/06/97  1:53 PM ]
 ;;3.0; Surgery ;**7,63**;24 Jun 93
 S SRSOUT=0,X1=DT,X2=-1 D C^%DTC S SRSDATE=X-.0001
 F  S SRSDATE=$O(^SRF("AC",SRSDATE)) Q:'SRSDATE!(SRSDATE>DT)!($G(SRSOUT))  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSDATE,SRTN)) Q:'SRTN!($G(SRSOUT))  I $D(^SRF(SRTN,.2)),$P(^(.2),"^",12) D OP
END W:$E(IOST)="P" @IOF I $D(ZTQUEUED) Q:$G(ZTSTOP)  S ZTREQ="@" Q
 D ^%ZISC,^SRSKILL K SRSITE,SRTN,SRZTQ
 Q
OP ; set info to print op report
 S SRNIGHT=1,X=$S($D(^SRF(SRTN,8)):$P(^(8),"^"),1:"")
 S SRSITE=$S(X:$O(^SRO(133,"B",X,0)),1:$O(^SRO(133,0))) Q:'SRSITE  D SET^SROVAR
 N I,SRSDATE D ^SROPRPT1 Q:SRSOUT  S X=SRTN K SRTN S SRTN=X S:$D(ZTQUEUED) SRZTQ=ZTQUEUED D ^SRSKILL S:$D(SRZTQ) ZTQUEUED=SRZTQ
 S SRSOUT=0
 Q
