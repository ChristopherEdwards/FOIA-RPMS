ATSERCHD ;TUCSON/DG;CALL TO TASKMAN  [ 10/25/91  1:22 PM ]
 ;;2.5;SEARCH TEMPLATE COMPARISON;;OCT 25, 1991
 ;
 S (ATSQT,ATSGO)=0 F L=0:0 D ASK Q:ATSQT
 K IO("Q")
 D:ATSGO ZIS
 S ATSTASK=0
 I $D(IO("Q")),'POP S ATSTASK=1 D TSKMN
 D EOJ
 Q
 ;
ASK ;
 W !!,"Do you want to queue the comparison to another device" S %=2 D YN^DICN
 I %=2 S ATSQT=1 Q
 I %=0 D HELP Q
 I %=-1 S ATSQT=1,ATSFLAG=$S($D(^UTILITY("ATSEARCH",$J,"MERGED")):2,1:1) Q
 I %=1 S ATSQT=1,ATSGO=1 Q
 Q
 ;
ZIS ;
 W !! S %IS="PQ",IOP="Q" D ^%ZIS
 Q
 ;
TSKMN ;
 S ATSFLAG=1
 K ZTSAVE F %="ATSTASK","ATSEARCH(","ATSEINRL","ATSENB","ATSENLAG","ATSFLAG","ATSMTCH","ATSNOT","ATSPC","ATSX","ATSETMP","ATSRCSTR" S ZTSAVE(%)=""
 S ZTRTN="ZTM^ATSERCH4",ZTDESC="SEARCH COMPARISON",ZTIO=IO,ZTDTH="" D ^%ZTLOAD
 X ^%ZIS("C")
 Q
 ;
HELP ;
 S XQH="ATSEARCH-QUEUE",DIC(0)="X" D EN^XQH
 W:$D(IOF) @IOF
 Q
 ;
EOJ ;
 K ATSGO,ATSQT,IO("Q")
 Q
 ;
