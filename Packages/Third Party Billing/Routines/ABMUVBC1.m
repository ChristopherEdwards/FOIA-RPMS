ABMUVBC1 ; IHS/SD/SDR - 3PB/UFMS View Batch option   
 ;;2.6;IHS Third Party Billing;**1,4**;NOV 12, 2009
 ;
 ; IHS/SD/SDR - abm*2.6*1 - NO HEAT - Calculate total for session
 ; IHS/SD/SDR - abm*2.6*4 - HEAT12990 - initialized cntr to zero
TOTAL ;
 K ABME("TAMT")
 S ABME("TAMT")=0  ;abm*2.6*4 HEAT12990
 S ABMBA=0,ABMEXCNT=0,ABMEXAMT=0
 F  S ABMBA=$O(^ABMUTXMT(ABMP("XMIT"),ABMLOOP,ABMUS,2,ABMSDT,11,ABMBA)) Q:+ABMBA=0  D   Q:$D(DIRUT)!$D(DIROUT)!$D(DTOUT)!$D(DUOUT)
 .S ABMBAOUT=$P($G(^ABMUTXMT(ABMP("XMIT"),ABMLOOP,ABMUS,2,ABMSDT,11,ABMBA,0)),U)
 .K ABME(ABMBAOUT)
 .S ABMBIEN=0
 .F  S ABMBIEN=$O(^ABMUTXMT(ABMP("XMIT"),ABMLOOP,ABMUS,2,ABMSDT,11,ABMBA,2,ABMBIEN)) Q:+ABMBIEN=0  D  Q:$D(DIRUT)!$D(DIROUT)!$D(DTOUT)!$D(DUOUT)
 ..S ABMDUZ2=$P($G(^ABMUTXMT(ABMP("XMIT"),ABMLOOP,ABMUS,2,ABMSDT,11,ABMBA,2,ABMBIEN,0)),U,2)
 ..S ABMBDFN=$P($G(^ABMUTXMT(ABMP("XMIT"),ABMLOOP,ABMUS,2,ABMSDT,11,ABMBA,2,ABMBIEN,0)),U,3)
 ..S ABME(21)=$P($G(^ABMDBILL(ABMDUZ2,ABMBDFN,2)),U)
 ..S ABME("TAMT")=+$G(ABME("TAMT"))+(ABME(21))  ;count session amt
 Q
