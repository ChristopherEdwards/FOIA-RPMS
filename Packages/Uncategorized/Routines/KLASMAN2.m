KLASMAN2 ; GLRISC/PDW  SCREEN OPEN AND SAVE FOR CLASSMAN  ;DEC 18,1990@13:54:58
 ;;1.0
1 D:'$D(DT) DT^DICRW
 I '$D(SCREEN) S SCREEN=0
 G:$D(NAMDIC) FRAME
START ; select ZZCLASS name
 D:SCREEN CLOSE
 S DIC="^KLAS(1200.1,",DIC(0)="AEQLZN" D ^DIC W !
 S NAMDIC=DIC
 I X="^"!(Y<0) K DIC,NAMDIC W !,"NO SELECTION ... YOU ARE RETURNED TO YOUR APPLICATION",!,">>ON-LINE MODE<-------",! Q
 S DA(1)=+Y
FRAME ; --- select slide ----
 D:SCREEN CLOSE
 S DIC=NAMDIC_DA(1)_",1,",DIC(0)="AEQLZN"
 S NODE=DIC_"0)" S $P(@NODE,"^",2)="1200.11I" K NODE
 S DIC("A")="Select SLIDE: "
 D ^DIC
 K DIC("A")
 G:X="^" START G:Y<0 START
OPEN ; --- open slide ---
 S FRNAME=$P(Y,U,2),DIE=DIC,DA=+Y,DR="10///S" D ^DIE S DIC=DIE,Y=DA K DIE
 S SLDIC=DIC,GLOB=DIC_+Y_",""W"","
 S NODE=GLOB_"0)" S:'$D(@NODE) @NODE=""
 S SLCOUNT=$P(@(GLOB_"0)"),U,3),SCREEN=1,Z0=1,BCS=1
 S:SLCOUNT="" SLCOUNT=0
 W !,FRNAME," IS OPEN AT LINE ",SLCOUNT,!,"USE  |CTRL-A| | 1 |  AND |CTRL-A| | 0 | TO CONTROL SCREEN SAVING, SAVING IS ON",!,"------->>ON-LINE MODE<<",!
 Q
CLOSE ; --- CLOSE SLIDE
 S @(GLOB_"0)")=U_U_SLCOUNT_U_SLCOUNT_U_DT
 S $P(@(SLDIC_"0)"),U,2)="N"
 S SCREEN=0
 W !,FRNAME," IS CLOSED AT LINE ",SLCOUNT
 Q
STUFF ; STUFF ONE SLIDE INTO ANOTHER
 W !!,"SOURCE ?",! D S1 G:Y'>0 SEXIT S G1=GLOB W !!,"TARGET ?",! D S1 G:Y'>0 SEXIT S G2=GLOB
 S %X=G1,%Y=G2 D %XY^%RCR
SEXIT K G1,G2,NODE,FRNAME,GLOB,NAMEDIC Q
S1 S DIC="^KLAS(1200.1,",DIC(0)="AEQLZN" D ^DIC W !
 S NAMDIC=DIC
 I X="^"!(Y<0) K DIC,NAMDIC W !,"NO SELECTION ... YOU ARE RETURNED TO YOUR APPLICATION",! Q
 S DA(1)=+Y
FRAME1 ; --- select slide ----
 S DIC=NAMDIC_DA(1)_",1,",DIC(0)="AEQLZN"
 S NODE=DIC_"0)" S $P(@NODE,"^",2)="1200.11I" K NODE
 S DIC("A")="Select SLIDE: "
 D ^DIC
 K DIC("A")
 G:X="^" STUFF G:Y<0 STUFF
OPEN1 ; --- open slide ---
 S FRNAME=$P(Y,U,2),DIE=DIC,DA=+Y,DR="10///S" D ^DIE S DIC=DIE,Y=DA K DIE
 S GLOB=DIC_+Y_",""W""," Q
XRAY ;
 D QUES F I=START:1:END S X=^KLAS("TEST",I) W !,I,?5,$L(X),! F J=1:1:$L(X) S Z=$E(X,J) W $S($A(Z)>32:Z,1:"."_$A(Z)_".") ;
 Q
XX ;
 D QUES F I=START:1:END W ^KLAS("TEST",I) ;
 Q
QUES R !,"START ? ",START:30 R " END ? ",END:30 W ! Q
PRT Q
