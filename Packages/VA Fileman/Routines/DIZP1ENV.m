DIZP1ENV ;IHS/OIRM/DSD/AEF - PATCH DI*22.0*1001 ENVIRONMENT CHECK ROUTINE [ 04/02/2003   8:23 AM ]
 ;;22.0;VA FileMan;**1001**;APR 1, 2003
 ;
EN ;EP -- MAIN ENTRY POINT
 ;
 D ^XBKVAR
 D NOQUE
 D VERSION
 D NOASK
 D OK
 Q
NOQUE ;----- PREVENT QUEUEING OF INSTALL
 ;
 S XPDNOQUE=1
 Q
VERSION ;----- CHECK VERSION
 ;
 I "22.0"'=$$VERSION^XPDUTL("VA FILEMAN") D
 . S XPDQUIT=1
 . D BMES^XPDUTL("CURRENT VERSION IS NOT 22.0, CANNOT CONTINUE WITH INSTALL")
 Q
NOASK ;----- SUPPRESS ASK 'DISABLE OPTS','MOVE ROUTINES' PROMPTS
 ;
 S XPDDIQ("XPZ1")=0 ;'DISABLE OPTIONS' SET DEFAULT TO 'NO' & NOT ASK
 S XPDDIQ("XPZ2")=0 ;'MOVE ROUTINES' SET DEFAULT TO 'NO' & NOT ASK
 Q
OK ;----- OK TO INSTALL?
 ;
 I $G(XPDQUIT) D
 . D BMES^XPDUTL("INSTALL ABORTED!")
 I '$G(XPDQUIT) D
 . D BMES^XPDUTL("EVERYTHING LOOKS OK")
 Q
