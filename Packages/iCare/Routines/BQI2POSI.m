BQI2POSI ;VNGT/HS/ALA-Initial Site Setup for Virgin Install ; 21 Jul 2008  4:09 PM
 ;;2.1;ICARE MANAGEMENT SYSTEM;;Feb 07, 2011
 ;
INI ;EP - Initialize iCare
 ; Reset all date started/stopped values
 F FD=.02,.03,.04,.05,.06,.07,.15,.16,.17,.18,1.01,1.02,1.03,1.04,1.05,1.06,1.07,1.08 S BQIUPD(90508,BQIDA_",",FD)="@"
 F FD=3.01:.01:3.09,3.1,3.11:.01:3.2,3.21 S BQIUPD(90508,BQIDA_",",FD)="@"
 F FD=4.01:.01:4.09,4.1,4.11:.01:4.12 S BQIUPD(90508,BQIDA_",",FD)="@"
 D FILE^DIE("","BQIUPD","ERROR")
 K BQIUPD
 ; Set up the taxonomies
 D LTAX^BQI11PST
 ; Set up the 'ALL REMINDERS' list
 D REM^BQI11PST
 ;  Set up initial program to populate BQIPAT
 S ZTDESC="INITIALIZE ICARE DATA",ZTRTN="SDATA^BQI2POSI",ZTIO=""
 S JBNOW=$$NOW^XLFDT()
 S JBDATE=$S($E($P(JBNOW,".",2),1,2)<17:DT,1:$$FMADD^XLFDT(DT,+1))
 S ZTDTH=JBDATE_".17"
 D ^%ZTLOAD
 K ZTDESC,ZTRTN,ZTIO,JBNOW,JBDATE,ZTDTH,ZTSK,BQIGDA,N,ERROR
 K BQIINDG,^XTMP("BQICARE")
 ;
 ; Set GPRA to start at 2AM the next day
 S ZTDESC="INITIALIZE ICARE NATL MEAS",ZTRTN="GPR^BQITASK2",ZTIO=""
 S JBNOW=$$NOW^XLFDT()
 S JBDATE=$$FMADD^XLFDT(DT,+1)
 S ZTDTH=JBDATE_".02"
 D ^%ZTLOAD
 K ZTDESC,ZTRTN,ZTIO,JBNOW,JBDATE,ZTDTH,ZTSK,BQIGDA,N,ERROR
 Q
 ;
SDATA ;EP - Set data up
 ;
 ; Set Flags
 D FLG^BQINIGHT
 ; Set Community Alerts
 D CMA^BQINIGHT
 ; Set up Reminders
 D EN^BQITASK1
 Q
 ;
ONE ;EP - Update for version 1.1
 ; Reset all date started/stopped values
 F FD=.02,.03,.04,.05,.06,.07,.15,.16,.17,.18,1.01,1.02,1.03,1.04,1.05,1.06,1.07,1.08 S BQIUPD(90508,BQIDA_",",FD)="@"
 F FD=3.01:.01:3.09,3.1,3.11:.01:3.2,3.21 S BQIUPD(90508,BQIDA_",",FD)="@"
 F FD=4.01:.01:4.09,4.1,4.11:.01:4.12 S BQIUPD(90508,BQIDA_",",FD)="@"
 D FILE^DIE("","BQIUPD","ERROR")
 K BQIUPD
 ; Set up the taxonomies
 D LTAX^BQI11PST
 ; Set up the 'ALL REMINDERS' list
 D REM^BQI11PST
 ;  Set up initial program to populate BQIPAT
 S ZTDESC="INITIALIZE ICARE DATA",ZTRTN="SDATA^BQI2POSI",ZTIO=""
 S JBNOW=$$NOW^XLFDT()
 S JBDATE=$S($E($P(JBNOW,".",2),1,2)<17:DT,1:$$FMADD^XLFDT(DT,+1))
 S ZTDTH=JBDATE_".17"
 D ^%ZTLOAD
 K ZTDESC,ZTRTN,ZTIO,JBNOW,JBDATE,ZTDTH,ZTSK,BQIGDA,N,ERROR
 K BQIINDG,^XTMP("BQICARE")
 Q
