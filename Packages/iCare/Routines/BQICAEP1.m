BQICAEP1 ;VNGT/HS/ALA-Dept of EPI Comm Alert Logic ; 25 May 2011  2:28 PM
 ;;2.3;ICARE MANAGEMENT SYSTEM;;Apr 18, 2012;Build 59
 ;
 ;
CHL(BQDFN,RESULT) ;EP - Chlamydia
 NEW UID,TREF,TAX,X
 S UID=$S($G(ZTSK):"Z"_ZTSK,1:$J)
 S RESULT(1)=0,CT=1
 S TREF=$NA(^TMP("BQITAX",$J)) K @TREF
 F TAX="BQI C.TRACH SPECIFIC LOINC","BQI C.TRACH SPECIFIC TAX" D BLD^BQITUTL(TAX,.TREF)
 F TAX="BQI C.TRACH NON-SPECIFIC LOINC","BQI C.TRACH NON-SPECIFIC TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 I X D LB(X,CT) K @TREF Q
 K @TREF
 F TAX="BQI C.TRACH DNA QUANT LOINC","BQI C.TRACH DNA QUANT TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"",0,">","","",.TREF)
 I X D LB(X,CT)
 K @TREF
 Q
 ;F TAX="BQI C.TRACH SPECIFIC LOINC","BQI C.TRACH SPECIFIC TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI C.TRACH NON-SPECIFIC LOINC","BQI C.TRACH NON-SPECIFIC TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI C.TRACH DNA QUANT LOINC","BQI C.TRACH DNA QUANT TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;Q
 ;
HEPB(BQDFN,RESULT) ;EP - Hep B
 NEW UID,TREF,TAX,X
 S UID=$S($G(ZTSK):"Z"_ZTSK,1:$J)
 S RESULT(1)=0,CT=1
 S TREF=$NA(^TMP("BQITAX",$J)) K @TREF
 F TAX="BQI HEP B QUAL TEST LOINC","BQI HEP B QUAL TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 I X D LB(X,CT) K @TREF Q
 K @TREF
 F TAX="BQI HEP B QUANT TEST LOINC","BQI HEP B QUANT TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"",0,">","","",.TREF)
 I X D LB(X,CT) K @TREF Q
 K @TREF
 F TAX="BQI ALT/AST/GGT TEST LOINC","BQI HEP ALT/AST/GGT TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LBB^BQITRUTL(SBGDT,SENDT,0,BQDFN,"",200,">","","",.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"",200,">","","",.TREF)
 I X D LB(X,CT)
 K @TREF
 Q
 ;
HEPC(BQDFN,RESULT) ;EP - Hepatitis C
 NEW UID,TREF,TAX,X
 S UID=$S($G(ZTSK):"Z"_ZTSK,1:$J)
 S RESULT(1)=0,CT=1
 S TREF=$NA(^TMP("BQITAX",$J)) K @TREF
 F TAX="BQI HEP C QUAL TEST LOINC","BQI HEP C QUAL TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 I X D LB(X,CT) Q
 F TAX="BQI HEP C QUANT TEST LOINC","BQI HEP C QUANT TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"",0,">","","",.TREF)
 I X D LB(X,CT) Q
 F TAX="BQI HEP ALT/AST/GGT TEST LOINC","BQI HEP ALT/AST/GGT TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LBB^BQITRUTL(SBGDT,SENDT,0,BQDFN,"",200,">","","",.TREF)
 I X D LB(X,CT) Q
 K @TREF
 Q
 ;
HIV(BQIDFN,RESULT) ;EP - HIV
 NEW UID,TREF,TAX,X
 S UID=$S($G(ZTSK):"Z"_ZTSK,1:$J)
 S RESULT(1)=0,CT=1
 S TREF=$NA(^TMP("BQITAX",$J)) K @TREF
 F TAX="BQI HIV AB QUAL SCREEN LOINC","BQI HIV AB QUAL SCREEN TAX" D BLD^BQITUTL(TAX,.TREF)
 F TAX="BQI HIV QUAL CONFIRM LOINC","BQI HIV QUAL CONFIRM TAX" D BLD^BQITUTL(TAX,.TREF)
 F TAX="BQI HIV ID SPEC CONFIRM LOINC","BQI HIV ID SPEC CONFIRM TAX" D BLD^BQITUTL(TAX,.TREF)
 F TAX="BQI HIV QUAL NUC ACID LOINC","BQI HIV QUAL NUC ACID TAX]" D BLD^BQITUTL(TAX,.TREF)
 F TAX="BQI HIV QUAL ANTIGEN LOINC","BQI HIV QUAL ANTIGEN TAX" D BLD^BQITUTL(TAX,.TREF)
 F TAX="BQI HIV VIROLOGIC TEST LOINC","BQI HIV VIROLOGIC TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 I X D LB(X,CT) K @TREF Q
 K @TREF
 F TAX="BQI HIV AB QUANT SCREEN LOINC","BQI HIV AB QUANT SCREEN TAX" D BLD^BQITUTL(TAX,.TREF)
 F TAX="BQI HIV QUANT CONFIRM LOINC","BQI HIV QUANT CONFIRM TAX" D BLD^BQITUTL(TAX,.TREF)
 F TAX="BQI HIV QUANT NUC ACID LOINC","BQI HIV QUANT NUC ACID TAX]" D BLD^BQITUTL(TAX,.TREF)
 F TAX="BQI HIV QUANT ANTIGEN LOINC","BQI HIV QUANT ANTIGEN TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"",0,">","","",.TREF)
 I X D LB(X,CT) K @TREF Q
 K @TREF
 F TAX="BGP CD4 LOINC CODES","BGP CD4 TAX","BKMV CD4 ABS LOINC CODES","BKM CD4 ABS TESTS TAX","BGP HIV VIRAL LOAD LOINC CODES","BGP HIV VIRAL LOAD TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","","'=","","",.TREF)
 I X D LB(X,CT) K @TREF Q
 F TAX="BGP CD4 CPTS","BKMV CD4 ABS CPTS","BGP HIV VIRAL LOAD CPTS" D BLD^BQITUTL(TAX,.TREF)
 S X=$$TAX^BQITRUTL("T-60","",1,BQDFN,9000010.18,0,1,.TREF,"","")
 I X Q
 K @TREF
 Q
 ;F TAX="BQI HIV AB QUAL SCREEN LOINC","BQI HIV AB QUAL SCREEN TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI HIV AB QUANT SCREEN LOINC","BQI HIV AB QUANT SCREEN TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"",0,">","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI HIV QUAL CONFIRM LOINC","BQI HIV QUAL CONFIRM TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI HIV QUANT CONFIRM LOINC","BQI HIV QUANT CONFIRM TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"",0,">","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI HIV ID SPEC CONFIRM LOINC","BQI HIV ID SPEC CONFIRM TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI HIV QUAL NUC ACID LOINC","BQI HIV QUAL NUC ACID TAX]" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI HIV QUANT NUC ACID LOINC","BQI HIV QUANT NUC ACID TAX]" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"",0,">","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI HIV QUAL ANTIGEN LOINC","BQI HIV QUAL ANTIGEN TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI HIV QUANT ANTIGEN LOINC","BQI HIV QUANT ANTIGEN TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"",0,">","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BQI HIV VIROLOGIC TEST LOINC","BQI HIV VIROLOGIC TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","POS","=","","",.TREF)
 ;I X D LB(X,CT) Q
 ;K @TREF
 ;F TAX="BGP CD4 CPTS","BKMV CD4 ABS CPTS","BGP HIV VIRAL LOAD CPTS" D BLD^BQITUTL(TAX,.TREF)
 ;S X=$$TAX^BQITRUTL("T-60","",1,BQDFN,9000010.18,0,1,.TREF,"","")
 ;F TAX="BGP CD4 LOINC CODES","BGP CD4 TAX","BKMV CD4 ABS LOINC CODES","BKM CD4 ABS TESTS TAX","BGP HIV VIRAL LOAD LOINC CODES","BGP HIV VIRAL LOAD TAX"
 ;Q
 ;
HC ;EP
 F TAX="BQI HEP B RELATED TEST LOINC","BQI HEP B RELATED TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"",400,">","","",.TREF)
 F TAX="BQI HEP A TEST LOINC","BQI HEP A TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","NEG","=","","",.TREF)
 F TAX="BQI HEP B CORE TEST LOINC","BQI HEP B CORE TEST TAX" D BLD^BQITUTL(TAX,.TREF)
 S X=$$LAB^BQITRUTL("T-60",0,BQDFN,"","NEG","=","","",.TREF)
 Q
 ;
LB(LX,CT) ;EP
 NEW LDATE
 S RESULT(CT)=LX_U_9000010.09
 S LDATE=$P(RESULT(CT),U,2),$P(RESULT(CT),U,2)=$$DATE^BQIUL1(LDATE)
 Q
